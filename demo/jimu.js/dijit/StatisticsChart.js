// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:jimu/dijit/templates/StatisticsChart.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"results-header" data-dojo-attach-point\x3d"resultsHeader" style\x3d"margin-bottom:15px;"\x3e\r\n\t\t\x3cdiv class\x3d"chart-title jimu-float-leading" data-dojo-attach-point\x3d"chartTitle"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"paging-section jimu-float-leading"\x3e\r\n\t\t\t\x3cul data-dojo-attach-point\x3d"pagingUl" data-dojo-attach-event\x3d"onclick:_onPagingUlClicked"\x3e\x3c/ul\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoomin jimu-float-trailing" data-dojo-attach-point\x3d"zoominIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"settings jimu-float-trailing" data-dojo-attach-point\x3d"settingsIcon"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"chart-section"\x3e\r\n\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;table-layout:fixed;"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"arrow-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item left-arrow arrow" data-dojo-attach-point\x3d"leftArrow" data-dojo-attach-event\x3d"onclick:_onLeftArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"content-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item chart-container" data-dojo-attach-point\x3d"chartContainer" dir\x3d"ltr"\r\n\t\t\t\t\t\tstyle\x3d"direction:ltr;overflow:hidden;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"arrow-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item right-arrow arrow" data-dojo-attach-point\x3d"rightArrow" data-dojo-attach-event\x3d"onclick:_onRightArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dijit/popup dijit/_WidgetBase dijit/TooltipDialog dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/StatisticsChart.html esri/lang esri/graphic esri/graphicsUtils esri/symbols/jsonUtils esri/layers/FeatureLayer jimu/utils jimu/portalUrlUtils jimu/clientStatisticsUtils jimu/dijit/Chart jimu/dijit/_StatisticsChartSettings jimu/dijit/LoadingIndicator".split(" "),
function(r,z,A,B,f,h,g,t,p,w,C,D,E,F,G,H,I,J,v,x,q,y,u,K,L){return B([C,E,F,z],{baseClass:"jimu-dijit-statistics-chart",templateString:G,theme:"light",noMoreThanOneChartClassName:"no-more-than-one-chart",hasTitleClassName:"has-title",charts:null,paramsDijits:null,tooltipDialogs:null,currentChartIndex:-1,tempGraphics:null,maxPreviewFeaturesCount:20,tooltipColor:"green",floatNumberFieldDecimalPlace:null,popupFieldInfosObj:null,config:null,features:null,featureLayer:null,map:null,fontColor:"#333333",
isBigPreview:!1,showSettingIcon:!1,showZoomIcon:!1,zoomToFeaturesWhenClick:!1,initialChartIndex:0,postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];this.isBigPreview&&(this.showZoomIcon=!1)},postCreate:function(){this.inherited(arguments);this.showSettingIcon?this.own(r(document.body,"click",f.hitch(this,this._onDocumentBodyClick))):g.destroy(this.settingsIcon);this.showZoomIcon?this.own(r(this.zoominIcon,"click",f.hitch(this,
function(){this.emit("zoomin")}))):g.destroy(this.zoominIcon);this.isBigPreview&&(this.chartContainer.style.maxHeight="auto",g.addClass(this.domNode,"big-preview"));this.zoominIcon.title=this.nls.enlarge;this.settingsIcon.title=this.nls.setting;g.addClass(this.domNode,this.noMoreThanOneChartClassName)},destroy:function(){this.clear();this.inherited(arguments)},resize:function(a,b){if(0<a||"string"===typeof a&&0<a.length)this.domNode.style.width=a;if(0<b||"string"===typeof b&&0<b.length)this.domNode.style.height=
b;this._resize()},resizeByParent:function(){this.domNode.style.width="100%";this.domNode.style.height="100%";this._resize()},_resize:function(){this._calculateChartBox();0<=this.currentChartIndex&&this._showChart(this.currentChartIndex)},createServerStatisticsCharts:function(a,b,d){var c=a.fields,e={type:"Table",fields:[]},k=f.clone(d),l=d.mode;"category"===l?(k.valueFields=[],e.fields=h.map(d.valueFields,f.hitch(this,function(a){var b=d.operation;"average"===b&&(b="avg");var c=a+"_"+b;a=a+"_"+b;
k.valueFields.push(c);return{name:c,type:"esriFieldTypeDouble",alias:a}})),h.some(c,f.hitch(this,function(a){return a.name===d.categoryField?(e.fields.push(a),!0):!1}))):"count"===l?(k.mode="feature",k.labelField=d.categoryField,a=a.fields[0].name+"_count",k.valueFields=[a],h.some(c,f.hitch(this,function(a){return a.name===d.categoryField?(e.fields.push(a),!0):!1})),e.fields.push({name:a,type:"esriFieldTypeInteger",alias:this.nls.count})):"field"===l&&(k.valueFields=[],e.fields=h.map(d.valueFields,
f.hitch(this,function(a){var b=d.operation;"average"===b&&(b="avg");var c=a+"_"+b;a=a+"_"+b;k.valueFields.push(c);return{name:c,type:"esriFieldTypeDouble",alias:a}})));return this._getLoadedLayer(e).then(f.hitch(this,function(a){this._createChartsAsync({featureLayer:a,features:b,config:k})}))},createClientCharts:function(a,b,d){return this._getLoadedLayer(a).then(f.hitch(this,function(a){this._createChartsAsync({featureLayer:a,features:b,config:d})}))},_getLoadedLayer:function(a){var b=new A,d=null,
d="string"===typeof a?new x(a):"esri.layers.FeatureLayer"===a.declaredClass?a:new x({layerDefinition:f.clone(a),featureSet:null});d.loaded?b.resolve(d):this.own(r(d,"load",f.hitch(this,function(){b.resolve(d)})));return b},_createChartsAsync:function(a){setTimeout(f.hitch(this,function(){this._createCharts(a)}),0)},_createCharts:function(a){try{this.loading.hide();this.clear();a.features&&(a.features=h.filter(a.features,f.hitch(this,function(a){return!!a.attributes})));this.config=a.config;this.features=
a.features;this.featureLayer=a.featureLayer;this.config.highLightColor||(this.config.highLightColor="#00ffff");this._updatePopupFieldInfos();this._calculateDecimalPlaceForFloatField();this.chartTitle.innerHTML=q.stripHTML(this.config.name||"");this.chartTitle.title=this.chartTitle.innerHTML;this.chartTitle.title?g.addClass(this.domNode,this.hasTitleClassName):g.removeClass(this.domNode,this.hasTitleClassName);1>=a.config.types.length?g.addClass(this.domNode,this.noMoreThanOneChartClassName):g.removeClass(this.domNode,
this.noMoreThanOneChartClassName);var b=this._calculateChartBox(),d=b.w+"px",c=b.h+"px",e=h.map(a.config.types,f.hitch(this,function(a){var b=g.create("div",{"class":"chart-div",style:{width:d,height:c}},this.chartContainer),k=g.toDom("\x3cli class\x3d'paging-li'\x3e\x3ca class\x3d'paging-a'\x3e\x3c/a\x3e\x3c/li\x3e");g.place(k,this.pagingUl);k=a.type;a=a.display;a.backgroundColor||(a.backgroundColor="transparent");a.hasOwnProperty("showLegend")||(a.showLegend=!1);a.legendTextColor||(a.legendTextColor=
this.fontColor);"pie"===k?(a.hasOwnProperty("showDataLabel")||(a.showDataLabel=!0),a.dataLabelColor||(a.dataLabelColor=this.fontColor)):(a.hasOwnProperty("showHorizontalAxis")||(a.showHorizontalAxis=!0),a.horizontalAxisTextColor||(a.horizontalAxisTextColor=this.fontColor),a.hasOwnProperty("showVerticalAxis")||(a.showVerticalAxis=!0),a.verticalAxisTextColor||(a.verticalAxisTextColor=this.fontColor));return b})),b=null;"feature"===this.config.mode?b=this._createFeatureModeCharts(a,e):"category"===this.config.mode?
b=this._createCategoryModeCharts(a,e):"count"===this.config.mode?b=this._createCountModeCharts(a,e):"field"===this.config.mode&&(b=this._createFieldModeCharts(a,e));this.charts=b.charts;this.paramsDijits=b.paramsDijits;this.tooltipDialogs=h.map(this.paramsDijits,f.hitch(this,function(a){var b=g.create("div");a.placeAt(b);return new D({content:b})}));a=0;0<=this.initialChartIndex&&this.charts.length>=this.initialChartIndex+1&&(a=this.initialChartIndex);this._showChart(a)}catch(k){console.error(k)}},
_calculateChartBox:function(){var a=g.getContentBox(this.domNode),b=a.h;0<this.resultsHeader.clientHeight&&(b=g.getMarginBox(this.resultsHeader),b=a.h-b.h);a=60;b<a&&(a=b);g.setStyle(this.leftArrow,"height",a+"px");g.setStyle(this.rightArrow,"height",a+"px");g.setStyle(this.chartContainer,"height",b+"px");return g.getContentBox(this.chartContainer)},_updatePopupFieldInfos:function(){this.popupFieldInfosObj={};var a=null;if(this.config.url&&this.map&&this.map.itemInfo&&this.map.itemInfo.itemData){var b=
q.removeSuffixSlashes(this.config.url),b=y.removeProtocol(b),d=this.map.itemInfo.itemData.operationalLayers,c=b.split("/"),e=parseInt(c[c.length-1],10);d&&0<d.length&&h.some(d,f.hitch(this,function(c){var d=c.url;if(d&&(d=q.removeSuffixSlashes(d),d=y.removeProtocol(d),0<=b.indexOf(d)))if(b===d){if(c.popupInfo&&c.popupInfo.fieldInfos)return a=c.popupInfo.fieldInfos,!0}else if(b.length>d.length&&c.layers&&0<=e&&(c=c[e])&&c.popupInfo&&c.popupInfo.fieldInfos)return a=c.popupInfo.fieldInfos,!0;return!1}))}a&&
0<a.length&&h.forEach(a,f.hitch(this,function(a){this.popupFieldInfosObj[a.fieldName]=a}))},_calculateDecimalPlaceForFloatField:function(){this.floatNumberFieldDecimalPlace={};var a=[];this.config.labelField&&a.push(this.config.labelField);this.config.categoryField&&a.push(this.config.categoryField);this.config.valueFields&&(a=a.concat(this.config.valueFields));var b=h.filter(a,f.hitch(this,function(a){return this._isFloatNumberField(a)})),d={};h.forEach(b,f.hitch(this,function(a){d[a]=[]}));(a=this.features)&&
0<a.length&&h.forEach(a,f.hitch(this,function(a){var c=a.attributes;c&&h.forEach(b,f.hitch(this,function(a){var b=c[a];"number"===typeof b&&d[a].push(b)}))}));h.forEach(b,f.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var b=d[a];if(0<b.length)try{var c=this._getBestDecimalPlace(b);this.floatNumberFieldDecimalPlace[a]=c}catch(l){this.floatNumberFieldDecimalPlace[a]=0,console.error(l)}this.popupFieldInfosObj&&(b=this.popupFieldInfosObj[a])&&b.format&&0<=b.format.places&&(this.floatNumberFieldDecimalPlace[a]=
b.format.places)}))},_onDocumentBodyClick:function(a){if(0<=this.currentChartIndex&&this.tooltipDialogs){var b=this.tooltipDialogs[this.currentChartIndex];if(b){var d=!!b.isOpendNow;this._hideAllTooltipDialogs();var c=a.target||a.srcElement;c===this.leftArrow||c===this.rightArrow||g.hasClass(c,"paging-a")||g.hasClass(c,"paging-li")||(c===this.settingsIcon?d?this._hideTooltipDialog(b):this._showTooltipDialog(b):(a=c===b.domNode,c=g.isDescendant(c,b.domNode),a||c?d?this._showTooltipDialog(b):this._hideTooltipDialog(b):
this._hideTooltipDialog(b)))}else this._hideAllTooltipDialogs()}else this._hideAllTooltipDialogs()},clear:function(){this.featureLayer=this.features=this.config=null;this.chartTitle.innerHTML="";this.chartTitle.title="";this.currentChartIndex=-1;this.popupFieldInfosObj=this.floatNumberFieldDecimalPlace=null;t("li",this.pagingUl).removeClass("selected");this.charts||(this.charts=[]);this.paramsDijits||(this.paramsDijits=[]);this.tooltipDialogs||(this.tooltipDialogs=[]);for(var a=0;a<this.charts.length;a++)this.charts[a]&&
this.charts[a].destroy(),this.charts[a]=null,this.paramsDijits[a]&&this.paramsDijits[a].destroy(),this.paramsDijits[a]=null,this.tooltipDialogs[a]&&this.tooltipDialogs[a].destroy(),this.tooltipDialogs[a]=null;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];g.empty(this.pagingUl);g.empty(this.chartContainer);g.addClass(this.domNode,this.noMoreThanOneChartClassName)},_showChart:function(a){this.currentChartIndex=-1;var b=t(".chart-div",this.chartContainer);b.style({display:"none"});var d=
t("li",this.pagingUl);d.removeClass("selected");if(!(0>a)){if(b=b[a])this.currentChartIndex=a,g.setStyle(b,"display","block");(d=d[a])&&g.addClass(d,"selected");if(!this.isBigPreview&&(d=null,this.charts&&0<this.charts.length&&(d=this.charts[a]))){a=this._calculateChartBox();var c=g.getContentBox(b);if(a.w!==c.w||a.h!==c.h)this.loading.show(),c=a.w+"px",a=a.h+"px",g.setStyle(b,"width",c),g.setStyle(b,"height",a),d.resize(c,a),this.loading.hide()}}},_hideAllTooltipDialogs:function(){this.tooltipDialogs&&
0<this.tooltipDialogs.length&&h.forEach(this.tooltipDialogs,f.hitch(this,function(a){this._hideTooltipDialog(a)}))},_hideTooltipDialog:function(a){a&&(w.close(a),a.isOpendNow=!1)},_showTooltipDialog:function(a){a&&(w.open({popup:a,around:this.settingsIcon}),a.isOpendNow=!0)},_onPagingUlClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=a.target||a.srcElement;if("a"===a.tagName.toLowerCase()){var b=t("a",this.pagingUl);a=h.indexOf(b,a);0<=a&&this._showChart(a)}},_onLeftArrowClicked:function(a){a.stopPropagation();
this._hideAllTooltipDialogs();a=(this.currentChartIndex-1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_onRightArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex+1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_getHighLightMarkerSymbol:function(){var a=v.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:.75,type:"esriSLS",
style:"esriSLSSolid"}});a.setSize(30);a.outline.setColor(new p(this.config.highLightColor));return a},_getHighLightLineSymbol:function(){var a=v.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});a.setColor(new p(this.config.highLightColor));return a},_getHighLightFillSymbol:function(){var a=v.fromJson({color:[255,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"});a.outline.setColor(new p(this.config.highLightColor));
return a},_zoomToGraphics:function(a){if(this.map&&this.featureLayer&&this.featureLayer.visible&&a&&0<a.length){var b=null;try{var d=h.filter(a,function(a){return!!a.geometry});0<d.length&&(b=J.graphicsExtent(d))}catch(c){console.error(c)}if(b)this.map.setExtent(b.expand(1.4));else if(a=(a=a[0])&&a.geometry)b=f.hitch(this,function(a){var b=this.map.getNumLevels(),c=this.map.getLevel();this.map.setLevel(Math.max(c,Math.floor(2*b/3))).then(f.hitch(this,function(){this.map.centerAt(a)}))}),"point"===
a.type?b(a):"multipoint"===a.type&&1===a.points.length&&b(a.getPoint(0))}},_removeTempGraphics:function(){if(this.featureLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.featureLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=null},_mouseOverChartItem:function(a){this._removeTempGraphics();if(this.featureLayer&&this.featureLayer.getMap()&&this.featureLayer.visible){var b=q.getTypeByGeometryType(this.featureLayer.geometryType),
d=null;if("point"===b)d=this._getHighLightMarkerSymbol(),this.tempGraphics=[],h.forEach(a,f.hitch(this,function(a){a=new I(a.geometry,d);this.tempGraphics.push(a);this.featureLayer.add(a)}));else if("polyline"===b||"polygon"===b)d="polyline"===b?this._getHighLightLineSymbol():this._getHighLightFillSymbol(),h.forEach(a,f.hitch(this,function(a){a.setSymbol(d)})),this.features.length!==a.length&&"polygon"===b&&(h.forEach(a,f.hitch(this,function(a){this.featureLayer.remove(a)})),h.forEach(a,f.hitch(this,
function(a){this.featureLayer.add(a)})))}},_mouseOutChartItem:function(){this._removeTempGraphics();this.featureLayer&&h.forEach(this.featureLayer.graphics,f.hitch(this,function(a){a.setSymbol(null)}))},_isNumber:function(a){return"[object number]"===Object.prototype.toString.call(a).toLowerCase()},_tryLocaleNumber:function(a,b){var d=a;if(H.isDefined(a)&&isFinite(a))try{var c;if(b&&this._isNumberField(b)){var e=this.popupFieldInfosObj[b];c=e&&f.exists("format.places",e)?q.localizeNumberByFieldInfo(a,
e):q.localizeNumber(a)}else c=a;"string"===typeof c&&(d=c)}catch(k){console.error(k)}return d+""},_getBestDisplayValue:function(a,b){var d=this._tryLocaleNumber(b,a);if(this.featureLayer.typeIdField===a){var c=this.featureLayer.types;if(c&&0<c.length&&(c=h.filter(c,f.hitch(this,function(a){return a.id===b})),0<c.length))return d=c[0].name}(c=this._getFieldInfo(a))&&c.domain&&(c=c.domain.codedValues)&&0<c.length&&h.some(c,function(a){return a.code===b?(d=a.name,!0):!1});return d},_getFieldAliasArray:function(a){return h.map(a,
f.hitch(this,function(a){return this._getFieldAlias(a)}))},_getFieldAlias:function(a){var b=a;(a=this._getFieldInfo(a))&&(b=a.alias||b);return b},_getFieldInfo:function(a){if(this.featureLayer)for(var b=this.featureLayer.fields,d=0;d<b.length;d++)if(b[d].name===a)return b[d];return null},_isNumberField:function(a){var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return h.some(this.featureLayer.fields,f.hitch(this,function(d){return d.name===a&&
0<=b.indexOf(d.type)}))},_isFloatNumberField:function(a){var b=["esriFieldTypeSingle","esriFieldTypeDouble"];return h.some(this.featureLayer.fields,f.hitch(this,function(d){return d.name===a&&0<=b.indexOf(d.type)}))},_isDateField:function(a){return(a=this._getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},_getBestDecimalPlace:function(a){var b=0,d={};h.forEach(a,function(a){a=a.toString().split(".");var b=null;1===a.length?b=0:2===a.length&&(b=a[1].length);null!==b&&(d[b]=void 0===d[b]?1:d[b]+1)});
a=null;for(var c in d){c=parseInt(c,10);var e=d[c];a?e>a.value&&(a={key:c,value:e}):a={key:c,value:e}}a&&(b=parseInt(a.key,10));return b},_getFloatNumberFieldDecimalPlace:function(a){var b=0;this.floatNumberFieldDecimalPlace&&(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(b=a));return b},_getBestValueForFloatNumberField:function(a,b){var d=this._getFloatNumberFieldDecimalPlace(b),d=a.toFixed(d);return parseFloat(d)},_getColors:function(a,b){var d=[],c=f.clone(a);if(2===c.colors.length)d=
this._createGradientColors(c.colors[0],c.colors[c.colors.length-1],b);else{for(var e=Math.ceil(b/c.colors.length),k=0;k<e;k++)d=d.concat(c.colors);d=d.slice(0,b)}return d},_createGradientColors:function(a,b,d){var c=[];a=new p(a);var e=new p(b);b=(e.r-a.r)/d;for(var k=(e.g-a.g)/d,e=(e.b-a.b)/d,f=new p,h=0,g=0,n=0,m=0;m<d;m++)h=parseInt(a.r+b*m,10),g=parseInt(a.g+k*m,10),n=parseInt(a.b+e*m,10),f.setColor([h,g,n]),c.push(f.toHex());return c},_createParamsDijit:function(a,b){return new L({isInWidget:this.map?
!0:!1,type:a,config:b})},_createJimuChart:function(a,b,d,c,e){var k=e.type,l=this._createParamsDijit(k,e.display),h=l.getConfig();h&&f.mixin(e.display,h);var g=this._getBasicChartOptionsByStatisticsInfo(b,d,c,k);this._udpateJimuChartDisplayOptions(g,e);var n=new K({chartDom:a,config:g});n.placeAt(a);this._bindChartEvent(n,b,c);this.showSettingIcon&&this.own(r(l,"change",f.hitch(this,function(){l.showShelter();if(n){var a=l.getConfig();f.mixin(e.display,a);this._udpateJimuChartDisplayOptions(g,e);
n.setConfig(g)}l.hideShelter()})));return[n,l]},_udpateJimuChartDisplayOptions:function(a,b){var d=b.type,c=b.display,e={type:d,dataZoom:["inside","slider"],confine:!0,backgroundColor:c.backgroundColor,color:c.colors,legend:c.showLegend,theme:this.theme||"light",advanceOption:function(a){c.showLegend&&a.legend&&(a.legend.textStyle||(a.legend.textStyle={}),a.legend.textStyle.color=c.legendTextColor);"pie"===d?a.series&&0<a.series.length&&h.forEach(a.series,f.hitch(this,function(a){"pie"===a.type&&
(a.label||(a.label={}),a.label.normal||(a.label.normal={}),a.label.normal.show=c.showDataLabel,a.label.normal.textStyle||(a.label.normal.textStyle={}),a.label.normal.textStyle.color=c.dataLabelColor)})):(a.xAxis||(a.xAxis={}),a.xAxis.axisLabel||(a.xAxis.axisLabel={}),a.xAxis.axisLabel.textStyle||(a.xAxis.axisLabel.textStyle={}),a.xAxis.axisLabel.textStyle.color=c.horizontalAxisTextColor,a.yAxis||(a.yAxis={}),a.yAxis.axisLabel||(a.yAxis.axisLabel={}),a.yAxis.axisLabel.textStyle||(a.yAxis.axisLabel.textStyle=
{}),a.yAxis.axisLabel.textStyle.color=c.verticalAxisTextColor)}};"pie"===d&&(e.labelLine=!!c.showDataLabel);f.mixin(a,e);"pie"!==d&&(a.axisPointer=!1,a.scale=!1,a.hidexAxis=!c.showHorizontalAxis,a.hideyAxis=!c.showVerticalAxis);return a},_getBasicChartOptionsByStatisticsInfo:function(a,b,d,c){return"feature"===a||"category"===a?this._getCategoryModeChartOptionsByStatisticsInfo(b,d,c):"count"===a?this._getCountModeChartOptionsByStatisticsInfo(b,d,c):"field"===a?this._getFieldModeChartOptionByStatisticsInfo(b,
d,c):null},_bindChartEvent:function(a,b,d){if(this.map){var c=f.hitch(this,function(a){if("series"===a.componentType){var c=null;(c="field"===b?this.features:d[a.dataIndex].dataFeatures)&&("mouseover"===a.type?this._mouseOverChartItem(c):"mouseout"===a.type?this._mouseOutChartItem(c):"click"===a.type&&this.zoomToFeaturesWhenClick&&this._zoomToGraphics(c))}}),e=[{name:"mouseover",callback:c},{name:"mouseout",callback:c}];this.zoomToFeaturesWhenClick&&e.push({name:"click",callback:c});h.forEach(e,f.hitch(this,
function(b){a.chart.on(b.name,b.callback)}))}},_createFeatureModeCharts:function(a,b){var d=[],c=[],e=a.config,k={layerDefinition:this.featureLayer,features:a.features,labelField:e.labelField,valueFields:e.valueFields,sortOrder:e.sortOrder},g=u.getFeatureModeStatisticsInfo(k);h.forEach(e.types,f.hitch(this,function(a,e){try{var f=this._createJimuChart(b[e],"feature",k,g,a);d.push(f[0]);c.push(f[1])}catch(m){console.error(m)}}));return{charts:d,paramsDijits:c}},_createCategoryModeCharts:function(a,
b){var d=[],c=[],e=a.config,k={layerDefinition:this.featureLayer,features:a.features,categoryField:e.categoryField,valueFields:e.valueFields,operation:a.config.operation,sortOrder:e.sortOrder},g=u.getCategoryModeStatisticsInfo(k);h.forEach(e.types,f.hitch(this,function(a,e){try{var f=this._createJimuChart(b[e],"category",k,g,a);d.push(f[0]);c.push(f[1])}catch(m){console.error(m)}}));return{charts:d,paramsDijits:c}},_getCategoryModeChartOptionsByStatisticsInfo:function(a,b,d){var c={type:d,labels:[],
series:[]},e=this._getFieldAliasArray(a.valueFields),k=a.labelField||a.categoryField;c.series=h.map(e,f.hitch(this,function(a){return{name:a,type:d,data:[]}}));h.forEach(b,f.hitch(this,function(a){var b=this._getBestDisplayValue(k,a.category);c.labels.push(b);for(b=0;b<a.valueFields.length;b++)c.series[b].data.push(a.valueFields[b])}));return c},_createCountModeCharts:function(a,b){var d=[],c=[],e=a.config,k={layerDefinition:this.featureLayer,features:a.features,categoryField:e.categoryField,sortOrder:e.sortOrder},
g=u.getCountModeStatisticsInfo(k);h.forEach(e.types,f.hitch(this,function(a,e){try{var f=this._createJimuChart(b[e],"count",k,g,a);d.push(f[0]);c.push(f[1])}catch(m){console.error(m)}}));return{charts:d,paramsDijits:c}},_getCountModeChartOptionsByStatisticsInfo:function(a,b,d){var c={type:d,labels:[],series:[{name:this._legendNls||"Legend",type:d,data:[]}]},e=a.categoryField;h.forEach(b,f.hitch(this,function(a){var b=a.count;a=this._getBestDisplayValue(e,a.fieldValue);c.labels.push(a);c.series[0].data.push(b)}));
return c},_createFieldModeCharts:function(a,b){var d=[],c=[],e=a.config,g={layerDefinition:this.featureLayer,features:a.features,valueFields:e.valueFields,operation:e.operation},l=u.getFieldModeStatisticsInfo(g);h.forEach(e.types,f.hitch(this,function(a,e){try{var f=this._createJimuChart(b[e],"field",g,l,a);d.push(f[0]);c.push(f[1])}catch(m){console.error(m)}}));return{charts:d,paramsDijits:c}},_getFieldModeChartOptionByStatisticsInfo:function(a,b,d){var c={type:d,labels:[],series:[{name:this._legendNls||
"Legend",type:d,data:[]}]};a=a.valueFields;var e=this._getFieldAliasArray(a);h.forEach(a,f.hitch(this,function(a,d){var f=b[a];c.labels.push(e[d]);c.series[0].data.push(f)}));return c}})});