// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/StatisticsChart":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dijit/popup dijit/_WidgetBase dijit/TooltipDialog dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/StatisticsChart.html esri/lang esri/graphic esri/graphicsUtils esri/symbols/jsonUtils esri/layers/FeatureLayer jimu/utils jimu/portalUrlUtils jimu/clientStatisticsUtils jimu/dijit/Chart jimu/dijit/_StatisticsChartSettings jimu/dijit/LoadingIndicator".split(" "),
function(q,g,n,b,c,k,e,t,p,h,m,a,d,f,r,A,B,C,w,x,u,y,z,F,G){return b([m,d,f,g],{baseClass:"jimu-dijit-statistics-chart",templateString:r,theme:"light",noMoreThanOneChartClassName:"no-more-than-one-chart",hasTitleClassName:"has-title",charts:null,paramsDijits:null,tooltipDialogs:null,currentChartIndex:-1,tempGraphics:null,maxPreviewFeaturesCount:20,tooltipColor:"green",floatNumberFieldDecimalPlace:null,popupFieldInfosObj:null,config:null,features:null,featureLayer:null,map:null,fontColor:"#333333",
isBigPreview:!1,showSettingIcon:!1,showZoomIcon:!1,zoomToFeaturesWhenClick:!1,initialChartIndex:0,postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];this.isBigPreview&&(this.showZoomIcon=!1)},postCreate:function(){this.inherited(arguments);this.showSettingIcon?this.own(q(document.body,"click",c.hitch(this,this._onDocumentBodyClick))):e.destroy(this.settingsIcon);this.showZoomIcon?this.own(q(this.zoominIcon,"click",c.hitch(this,
function(){this.emit("zoomin")}))):e.destroy(this.zoominIcon);this.isBigPreview&&(this.chartContainer.style.maxHeight="auto",e.addClass(this.domNode,"big-preview"));this.zoominIcon.title=this.nls.enlarge;this.settingsIcon.title=this.nls.setting;e.addClass(this.domNode,this.noMoreThanOneChartClassName)},destroy:function(){this.clear();this.inherited(arguments)},resize:function(a,d){if(0<a||"string"===typeof a&&0<a.length)this.domNode.style.width=a;if(0<d||"string"===typeof d&&0<d.length)this.domNode.style.height=
d;this._resize()},resizeByParent:function(){this.domNode.style.width="100%";this.domNode.style.height="100%";this._resize()},_resize:function(){this._calculateChartBox();0<=this.currentChartIndex&&this._showChart(this.currentChartIndex)},createServerStatisticsCharts:function(a,d,b){var l=a.fields,f={type:"Table",fields:[]},e=c.clone(b),D=b.mode;"category"===D?(e.valueFields=[],f.fields=k.map(b.valueFields,c.hitch(this,function(a){var l=b.operation;"average"===l&&(l="avg");var d=a+"_"+l;a=a+"_"+l;
e.valueFields.push(d);return{name:d,type:"esriFieldTypeDouble",alias:a}})),k.some(l,c.hitch(this,function(a){return a.name===b.categoryField?(f.fields.push(a),!0):!1}))):"count"===D?(e.mode="feature",e.labelField=b.categoryField,a=a.fields[0].name+"_count",e.valueFields=[a],k.some(l,c.hitch(this,function(a){return a.name===b.categoryField?(f.fields.push(a),!0):!1})),f.fields.push({name:a,type:"esriFieldTypeInteger",alias:this.nls.count})):"field"===D&&(e.valueFields=[],f.fields=k.map(b.valueFields,
c.hitch(this,function(a){var l=b.operation;"average"===l&&(l="avg");var d=a+"_"+l;a=a+"_"+l;e.valueFields.push(d);return{name:d,type:"esriFieldTypeDouble",alias:a}})));return this._getLoadedLayer(f).then(c.hitch(this,function(a){this._createChartsAsync({featureLayer:a,features:d,config:e})}))},createClientCharts:function(a,d,b){return this._getLoadedLayer(a).then(c.hitch(this,function(a){this._createChartsAsync({featureLayer:a,features:d,config:b})}))},_getLoadedLayer:function(a){var d=new n,l=null,
l="string"===typeof a?new x(a):"esri.layers.FeatureLayer"===a.declaredClass?a:new x({layerDefinition:c.clone(a),featureSet:null});l.loaded?d.resolve(l):this.own(q(l,"load",c.hitch(this,function(){d.resolve(l)})));return d},_createChartsAsync:function(a){setTimeout(c.hitch(this,function(){this._createCharts(a)}),0)},_createCharts:function(d){try{this.loading.hide();this.clear();d.features&&(d.features=k.filter(d.features,c.hitch(this,function(a){return!!a.attributes})));this.config=d.config;this.features=
d.features;this.featureLayer=d.featureLayer;this.config.highLightColor||(this.config.highLightColor="#00ffff");this._updatePopupFieldInfos();this._calculateDecimalPlaceForFloatField();this.chartTitle.innerHTML=u.stripHTML(this.config.name||"");this.chartTitle.title=this.chartTitle.innerHTML;this.chartTitle.title?e.addClass(this.domNode,this.hasTitleClassName):e.removeClass(this.domNode,this.hasTitleClassName);1>=d.config.types.length?e.addClass(this.domNode,this.noMoreThanOneChartClassName):e.removeClass(this.domNode,
this.noMoreThanOneChartClassName);var l=this._calculateChartBox(),b=l.w+"px",f=l.h+"px",h=k.map(d.config.types,c.hitch(this,function(a){var d=e.create("div",{"class":"chart-div",style:{width:b,height:f}},this.chartContainer),l=e.toDom("\x3cli class\x3d'paging-li'\x3e\x3ca class\x3d'paging-a'\x3e\x3c/a\x3e\x3c/li\x3e");e.place(l,this.pagingUl);l=a.type;a=a.display;a.backgroundColor||(a.backgroundColor="transparent");a.hasOwnProperty("showLegend")||(a.showLegend=!1);a.legendTextColor||(a.legendTextColor=
this.fontColor);"pie"===l?(a.hasOwnProperty("showDataLabel")||(a.showDataLabel=!0),a.dataLabelColor||(a.dataLabelColor=this.fontColor)):(a.hasOwnProperty("showHorizontalAxis")||(a.showHorizontalAxis=!0),a.horizontalAxisTextColor||(a.horizontalAxisTextColor=this.fontColor),a.hasOwnProperty("showVerticalAxis")||(a.showVerticalAxis=!0),a.verticalAxisTextColor||(a.verticalAxisTextColor=this.fontColor));return d})),l=null;"feature"===this.config.mode?l=this._createFeatureModeCharts(d,h):"category"===this.config.mode?
l=this._createCategoryModeCharts(d,h):"count"===this.config.mode?l=this._createCountModeCharts(d,h):"field"===this.config.mode&&(l=this._createFieldModeCharts(d,h));this.charts=l.charts;this.paramsDijits=l.paramsDijits;this.tooltipDialogs=k.map(this.paramsDijits,c.hitch(this,function(d){var l=e.create("div");d.placeAt(l);return new a({content:l})}));d=0;0<=this.initialChartIndex&&this.charts.length>=this.initialChartIndex+1&&(d=this.initialChartIndex);this._showChart(d)}catch(E){console.error(E)}},
_calculateChartBox:function(){var a=e.getContentBox(this.domNode),d=a.h;0<this.resultsHeader.clientHeight&&(d=e.getMarginBox(this.resultsHeader),d=a.h-d.h);a=60;d<a&&(a=d);e.setStyle(this.leftArrow,"height",a+"px");e.setStyle(this.rightArrow,"height",a+"px");e.setStyle(this.chartContainer,"height",d+"px");return e.getContentBox(this.chartContainer)},_updatePopupFieldInfos:function(){this.popupFieldInfosObj={};var a=null;if(this.config.url&&this.map&&this.map.itemInfo&&this.map.itemInfo.itemData){var d=
u.removeSuffixSlashes(this.config.url),d=y.removeProtocol(d),b=this.map.itemInfo.itemData.operationalLayers,f=d.split("/"),e=parseInt(f[f.length-1],10);b&&0<b.length&&k.some(b,c.hitch(this,function(l){var b=l.url;if(b&&(b=u.removeSuffixSlashes(b),b=y.removeProtocol(b),0<=d.indexOf(b)))if(d===b){if(l.popupInfo&&l.popupInfo.fieldInfos)return a=l.popupInfo.fieldInfos,!0}else if(d.length>b.length&&l.layers&&0<=e&&(l=l[e])&&l.popupInfo&&l.popupInfo.fieldInfos)return a=l.popupInfo.fieldInfos,!0;return!1}))}a&&
0<a.length&&k.forEach(a,c.hitch(this,function(a){this.popupFieldInfosObj[a.fieldName]=a}))},_calculateDecimalPlaceForFloatField:function(){this.floatNumberFieldDecimalPlace={};var a=[];this.config.labelField&&a.push(this.config.labelField);this.config.categoryField&&a.push(this.config.categoryField);this.config.valueFields&&(a=a.concat(this.config.valueFields));var d=k.filter(a,c.hitch(this,function(a){return this._isFloatNumberField(a)})),b={};k.forEach(d,c.hitch(this,function(a){b[a]=[]}));(a=this.features)&&
0<a.length&&k.forEach(a,c.hitch(this,function(a){var l=a.attributes;l&&k.forEach(d,c.hitch(this,function(a){var d=l[a];"number"===typeof d&&b[a].push(d)}))}));k.forEach(d,c.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var d=b[a];if(0<d.length)try{var l=this._getBestDecimalPlace(d);this.floatNumberFieldDecimalPlace[a]=l}catch(I){this.floatNumberFieldDecimalPlace[a]=0,console.error(I)}this.popupFieldInfosObj&&(d=this.popupFieldInfosObj[a])&&d.format&&0<=d.format.places&&(this.floatNumberFieldDecimalPlace[a]=
d.format.places)}))},_onDocumentBodyClick:function(a){if(0<=this.currentChartIndex&&this.tooltipDialogs){var d=this.tooltipDialogs[this.currentChartIndex];if(d){var l=!!d.isOpendNow;this._hideAllTooltipDialogs();var b=a.target||a.srcElement;b===this.leftArrow||b===this.rightArrow||e.hasClass(b,"paging-a")||e.hasClass(b,"paging-li")||(b===this.settingsIcon?l?this._hideTooltipDialog(d):this._showTooltipDialog(d):(a=b===d.domNode,b=e.isDescendant(b,d.domNode),a||b?l?this._showTooltipDialog(d):this._hideTooltipDialog(d):
this._hideTooltipDialog(d)))}else this._hideAllTooltipDialogs()}else this._hideAllTooltipDialogs()},clear:function(){this.featureLayer=this.features=this.config=null;this.chartTitle.innerHTML="";this.chartTitle.title="";this.currentChartIndex=-1;this.popupFieldInfosObj=this.floatNumberFieldDecimalPlace=null;t("li",this.pagingUl).removeClass("selected");this.charts||(this.charts=[]);this.paramsDijits||(this.paramsDijits=[]);this.tooltipDialogs||(this.tooltipDialogs=[]);for(var a=0;a<this.charts.length;a++)this.charts[a]&&
this.charts[a].destroy(),this.charts[a]=null,this.paramsDijits[a]&&this.paramsDijits[a].destroy(),this.paramsDijits[a]=null,this.tooltipDialogs[a]&&this.tooltipDialogs[a].destroy(),this.tooltipDialogs[a]=null;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];e.empty(this.pagingUl);e.empty(this.chartContainer);e.addClass(this.domNode,this.noMoreThanOneChartClassName)},_showChart:function(a){this.currentChartIndex=-1;var d=t(".chart-div",this.chartContainer);d.style({display:"none"});var l=
t("li",this.pagingUl);l.removeClass("selected");if(!(0>a)){if(d=d[a])this.currentChartIndex=a,e.setStyle(d,"display","block");(l=l[a])&&e.addClass(l,"selected");if(!this.isBigPreview&&(l=null,this.charts&&0<this.charts.length&&(l=this.charts[a]))){a=this._calculateChartBox();var b=e.getContentBox(d);if(a.w!==b.w||a.h!==b.h)this.loading.show(),b=a.w+"px",a=a.h+"px",e.setStyle(d,"width",b),e.setStyle(d,"height",a),l.resize(b,a),this.loading.hide()}}},_hideAllTooltipDialogs:function(){this.tooltipDialogs&&
0<this.tooltipDialogs.length&&k.forEach(this.tooltipDialogs,c.hitch(this,function(a){this._hideTooltipDialog(a)}))},_hideTooltipDialog:function(a){a&&(h.close(a),a.isOpendNow=!1)},_showTooltipDialog:function(a){a&&(h.open({popup:a,around:this.settingsIcon}),a.isOpendNow=!0)},_onPagingUlClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=a.target||a.srcElement;if("a"===a.tagName.toLowerCase()){var d=t("a",this.pagingUl);a=k.indexOf(d,a);0<=a&&this._showChart(a)}},_onLeftArrowClicked:function(a){a.stopPropagation();
this._hideAllTooltipDialogs();a=(this.currentChartIndex-1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_onRightArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex+1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_getHighLightMarkerSymbol:function(){var a=w.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:.75,type:"esriSLS",
style:"esriSLSSolid"}});a.setSize(30);a.outline.setColor(new p(this.config.highLightColor));return a},_getHighLightLineSymbol:function(){var a=w.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});a.setColor(new p(this.config.highLightColor));return a},_getHighLightFillSymbol:function(){var a=w.fromJson({color:[255,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"});a.outline.setColor(new p(this.config.highLightColor));
return a},_zoomToGraphics:function(a){if(this.map&&this.featureLayer&&this.featureLayer.visible&&a&&0<a.length){var d=null;try{var b=k.filter(a,function(a){return!!a.geometry});0<b.length&&(d=C.graphicsExtent(b))}catch(H){console.error(H)}if(d)this.map.setExtent(d.expand(1.4));else if(a=(a=a[0])&&a.geometry)d=c.hitch(this,function(a){var d=this.map.getNumLevels(),b=this.map.getLevel();this.map.setLevel(Math.max(b,Math.floor(2*d/3))).then(c.hitch(this,function(){this.map.centerAt(a)}))}),"point"===
a.type?d(a):"multipoint"===a.type&&1===a.points.length&&d(a.getPoint(0))}},_removeTempGraphics:function(){if(this.featureLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.featureLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=null},_mouseOverChartItem:function(a){this._removeTempGraphics();if(this.featureLayer&&this.featureLayer.getMap()&&this.featureLayer.visible){var d=u.getTypeByGeometryType(this.featureLayer.geometryType),
b=null;if("point"===d)b=this._getHighLightMarkerSymbol(),this.tempGraphics=[],k.forEach(a,c.hitch(this,function(a){a=new B(a.geometry,b);this.tempGraphics.push(a);this.featureLayer.add(a)}));else if("polyline"===d||"polygon"===d)b="polyline"===d?this._getHighLightLineSymbol():this._getHighLightFillSymbol(),k.forEach(a,c.hitch(this,function(a){a.setSymbol(b)})),this.features.length!==a.length&&"polygon"===d&&(k.forEach(a,c.hitch(this,function(a){this.featureLayer.remove(a)})),k.forEach(a,c.hitch(this,
function(a){this.featureLayer.add(a)})))}},_mouseOutChartItem:function(){this._removeTempGraphics();this.featureLayer&&k.forEach(this.featureLayer.graphics,c.hitch(this,function(a){a.setSymbol(null)}))},_isNumber:function(a){return"[object number]"===Object.prototype.toString.call(a).toLowerCase()},_tryLocaleNumber:function(a,d){var b=a;if(A.isDefined(a)&&isFinite(a))try{var f;if(d&&this._isNumberField(d)){var l=this.popupFieldInfosObj[d];f=l&&c.exists("format.places",l)?u.localizeNumberByFieldInfo(a,
l):u.localizeNumber(a)}else f=a;"string"===typeof f&&(b=f)}catch(E){console.error(E)}return b+""},_getBestDisplayValue:function(a,d){var b=this._tryLocaleNumber(d,a);if(this.featureLayer.typeIdField===a){var f=this.featureLayer.types;if(f&&0<f.length&&(f=k.filter(f,c.hitch(this,function(a){return a.id===d})),0<f.length))return b=f[0].name}(f=this._getFieldInfo(a))&&f.domain&&(f=f.domain.codedValues)&&0<f.length&&k.some(f,function(a){return a.code===d?(b=a.name,!0):!1});return b},_getFieldAliasArray:function(a){return k.map(a,
c.hitch(this,function(a){return this._getFieldAlias(a)}))},_getFieldAlias:function(a){var d=a;(a=this._getFieldInfo(a))&&(d=a.alias||d);return d},_getFieldInfo:function(a){if(this.featureLayer)for(var d=this.featureLayer.fields,b=0;b<d.length;b++)if(d[b].name===a)return d[b];return null},_isNumberField:function(a){var d=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return k.some(this.featureLayer.fields,c.hitch(this,function(b){return b.name===a&&
0<=d.indexOf(b.type)}))},_isFloatNumberField:function(a){var d=["esriFieldTypeSingle","esriFieldTypeDouble"];return k.some(this.featureLayer.fields,c.hitch(this,function(b){return b.name===a&&0<=d.indexOf(b.type)}))},_isDateField:function(a){return(a=this._getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},_getBestDecimalPlace:function(a){var d=0,b={};k.forEach(a,function(a){a=a.toString().split(".");var d=null;1===a.length?d=0:2===a.length&&(d=a[1].length);null!==d&&(b[d]=void 0===b[d]?1:b[d]+1)});
a=null;for(var f in b){f=parseInt(f,10);var c=b[f];a?c>a.value&&(a={key:f,value:c}):a={key:f,value:c}}a&&(d=parseInt(a.key,10));return d},_getFloatNumberFieldDecimalPlace:function(a){var d=0;this.floatNumberFieldDecimalPlace&&(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(d=a));return d},_getBestValueForFloatNumberField:function(a,d){var b=this._getFloatNumberFieldDecimalPlace(d),b=a.toFixed(b);return parseFloat(b)},_getColors:function(a,d){var b=[],f=c.clone(a);if(2===f.colors.length)b=
this._createGradientColors(f.colors[0],f.colors[f.colors.length-1],d);else{for(var e=Math.ceil(d/f.colors.length),l=0;l<e;l++)b=b.concat(f.colors);b=b.slice(0,d)}return b},_createGradientColors:function(a,d,b){var f=[];a=new p(a);var c=new p(d);d=(c.r-a.r)/b;for(var e=(c.g-a.g)/b,c=(c.b-a.b)/b,l=new p,h=0,r=0,g=0,m=0;m<b;m++)h=parseInt(a.r+d*m,10),r=parseInt(a.g+e*m,10),g=parseInt(a.b+c*m,10),l.setColor([h,r,g]),f.push(l.toHex());return f},_createParamsDijit:function(a,d){return new G({isInWidget:this.map?
!0:!1,type:a,config:d})},_createJimuChart:function(a,d,b,f,e){var l=e.type,h=this._createParamsDijit(l,e.display),r=h.getConfig();r&&c.mixin(e.display,r);var p=this._getBasicChartOptionsByStatisticsInfo(d,b,f,l);this._udpateJimuChartDisplayOptions(p,e);var m=new F({chartDom:a,config:p});m.placeAt(a);this._bindChartEvent(m,d,f);this.showSettingIcon&&this.own(q(h,"change",c.hitch(this,function(){h.showShelter();if(m){var a=h.getConfig();c.mixin(e.display,a);this._udpateJimuChartDisplayOptions(p,e);
m.setConfig(p)}h.hideShelter()})));return[m,h]},_udpateJimuChartDisplayOptions:function(a,d){var b=d.type,f=d.display,e={type:b,dataZoom:["inside","slider"],confine:!0,backgroundColor:f.backgroundColor,color:f.colors,legend:f.showLegend,theme:this.theme||"light",advanceOption:function(a){f.showLegend&&a.legend&&(a.legend.textStyle||(a.legend.textStyle={}),a.legend.textStyle.color=f.legendTextColor);"pie"===b?a.series&&0<a.series.length&&k.forEach(a.series,c.hitch(this,function(a){"pie"===a.type&&
(a.label||(a.label={}),a.label.normal||(a.label.normal={}),a.label.normal.show=f.showDataLabel,a.label.normal.textStyle||(a.label.normal.textStyle={}),a.label.normal.textStyle.color=f.dataLabelColor)})):(a.xAxis||(a.xAxis={}),a.xAxis.axisLabel||(a.xAxis.axisLabel={}),a.xAxis.axisLabel.textStyle||(a.xAxis.axisLabel.textStyle={}),a.xAxis.axisLabel.textStyle.color=f.horizontalAxisTextColor,a.yAxis||(a.yAxis={}),a.yAxis.axisLabel||(a.yAxis.axisLabel={}),a.yAxis.axisLabel.textStyle||(a.yAxis.axisLabel.textStyle=
{}),a.yAxis.axisLabel.textStyle.color=f.verticalAxisTextColor)}};"pie"===b&&(e.labelLine=!!f.showDataLabel);c.mixin(a,e);"pie"!==b&&(a.axisPointer=!1,a.scale=!1,a.hidexAxis=!f.showHorizontalAxis,a.hideyAxis=!f.showVerticalAxis);return a},_getBasicChartOptionsByStatisticsInfo:function(a,d,b,f){return"feature"===a||"category"===a?this._getCategoryModeChartOptionsByStatisticsInfo(d,b,f):"count"===a?this._getCountModeChartOptionsByStatisticsInfo(d,b,f):"field"===a?this._getFieldModeChartOptionByStatisticsInfo(d,
b,f):null},_bindChartEvent:function(a,d,b){if(this.map){var f=c.hitch(this,function(a){if("series"===a.componentType){var f=null;(f="field"===d?this.features:b[a.dataIndex].dataFeatures)&&("mouseover"===a.type?this._mouseOverChartItem(f):"mouseout"===a.type?this._mouseOutChartItem(f):"click"===a.type&&this.zoomToFeaturesWhenClick&&this._zoomToGraphics(f))}}),e=[{name:"mouseover",callback:f},{name:"mouseout",callback:f}];this.zoomToFeaturesWhenClick&&e.push({name:"click",callback:f});k.forEach(e,c.hitch(this,
function(d){a.chart.on(d.name,d.callback)}))}},_createFeatureModeCharts:function(a,d){var b=[],f=[],e=a.config,h={layerDefinition:this.featureLayer,features:a.features,labelField:e.labelField,valueFields:e.valueFields,sortOrder:e.sortOrder},l=z.getFeatureModeStatisticsInfo(h);k.forEach(e.types,c.hitch(this,function(a,c){try{var e=this._createJimuChart(d[c],"feature",h,l,a);b.push(e[0]);f.push(e[1])}catch(v){console.error(v)}}));return{charts:b,paramsDijits:f}},_createCategoryModeCharts:function(a,
d){var b=[],f=[],e=a.config,h={layerDefinition:this.featureLayer,features:a.features,categoryField:e.categoryField,valueFields:e.valueFields,operation:a.config.operation,sortOrder:e.sortOrder},r=z.getCategoryModeStatisticsInfo(h);k.forEach(e.types,c.hitch(this,function(a,c){try{var e=this._createJimuChart(d[c],"category",h,r,a);b.push(e[0]);f.push(e[1])}catch(v){console.error(v)}}));return{charts:b,paramsDijits:f}},_getCategoryModeChartOptionsByStatisticsInfo:function(a,d,b){var f={type:b,labels:[],
series:[]},e=this._getFieldAliasArray(a.valueFields),h=a.labelField||a.categoryField;f.series=k.map(e,c.hitch(this,function(a){return{name:a,type:b,data:[]}}));k.forEach(d,c.hitch(this,function(a){var d=this._getBestDisplayValue(h,a.category);f.labels.push(d);for(d=0;d<a.valueFields.length;d++)f.series[d].data.push(a.valueFields[d])}));return f},_createCountModeCharts:function(a,d){var b=[],f=[],e=a.config,h={layerDefinition:this.featureLayer,features:a.features,categoryField:e.categoryField,sortOrder:e.sortOrder},
r=z.getCountModeStatisticsInfo(h);k.forEach(e.types,c.hitch(this,function(a,c){try{var e=this._createJimuChart(d[c],"count",h,r,a);b.push(e[0]);f.push(e[1])}catch(v){console.error(v)}}));return{charts:b,paramsDijits:f}},_getCountModeChartOptionsByStatisticsInfo:function(a,d,b){var f={type:b,labels:[],series:[{name:this._legendNls||"Legend",type:b,data:[]}]},e=a.categoryField;k.forEach(d,c.hitch(this,function(a){var d=a.count;a=this._getBestDisplayValue(e,a.fieldValue);f.labels.push(a);f.series[0].data.push(d)}));
return f},_createFieldModeCharts:function(a,d){var b=[],f=[],e=a.config,h={layerDefinition:this.featureLayer,features:a.features,valueFields:e.valueFields,operation:e.operation},r=z.getFieldModeStatisticsInfo(h);k.forEach(e.types,c.hitch(this,function(a,c){try{var e=this._createJimuChart(d[c],"field",h,r,a);b.push(e[0]);f.push(e[1])}catch(v){console.error(v)}}));return{charts:b,paramsDijits:f}},_getFieldModeChartOptionByStatisticsInfo:function(a,d,b){var f={type:b,labels:[],series:[{name:this._legendNls||
"Legend",type:b,data:[]}]};a=a.valueFields;var e=this._getFieldAliasArray(a);k.forEach(a,c.hitch(this,function(a,b){var c=d[a];f.labels.push(e[b]);f.series[0].data.push(c)}));return f}})})},"jimu/clientStatisticsUtils":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","jimu/utils","esri/lang"],function(q,g,n,b,c){var k=q(null,{popupFieldInfosObj:null,constructor:function(b){b&&n.mixin(this,b);this.popupFieldInfosObj={};this.floatNumberFieldDecimalPlace={}},_isNumber:function(b){return"[object number]"===
Object.prototype.toString.call(b).toLowerCase()},_tryLocaleNumber:function(e,g){var p=e;if(c.isDefined(e)&&isFinite(e))try{var h;if(g&&this._isNumberField(g)){var m=this.popupFieldInfosObj[g];h=m&&n.exists("format.places",m)?b.localizeNumberByFieldInfo(e,m):b.localizeNumber(e)}else h=e;"string"===typeof h&&(p=h)}catch(a){console.error(a)}return p+""},_getBestDisplayValue:function(b,c){var e=this._tryLocaleNumber(c,b);if(this.layerDefinition.typeIdField===b){var h=this.layerDefinition.types;if(h&&
0<h.length&&(h=g.filter(h,n.hitch(this,function(b){return b.id===c})),0<h.length))return e=h[0].name}(h=this._getFieldInfo(b))&&h.domain&&(h=h.domain.codedValues)&&0<h.length&&g.some(h,function(b){return b.code===c?(e=b.name,!0):!1});return e},_getFieldAliasArray:function(b){return g.map(b,n.hitch(this,function(b){return this._getFieldAlias(b)}))},_getFieldAlias:function(b){var c=b;(b=this._getFieldInfo(b))&&(c=b.alias||c);return c},_getFieldInfo:function(b){if(this.layerDefinition)for(var c=this.layerDefinition.fields,
e=0;e<c.length;e++)if(c[e].name===b)return c[e];return null},_isNumberField:function(b){var c=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return g.some(this.layerDefinition.fields,n.hitch(this,function(e){return e.name===b&&0<=c.indexOf(e.type)}))},_isFloatNumberField:function(b){var c=["esriFieldTypeSingle","esriFieldTypeDouble"];return g.some(this.layerDefinition.fields,n.hitch(this,function(e){return e.name===b&&0<=c.indexOf(e.type)}))},_isDateField:function(b){return(b=
this._getFieldInfo(b))?"esriFieldTypeDate"===b.type:!1},_getBestDecimalPlace:function(b){var c=0,e={};g.forEach(b,function(a){a=a.toString().split(".");var d=null;1===a.length?d=0:2===a.length&&(d=a[1].length);null!==d&&(e[d]=void 0===e[d]?1:e[d]+1)});b=null;for(var h in e){h=parseInt(h,10);var m=e[h];b?m>b.value&&(b={key:h,value:m}):b={key:h,value:m}}b&&(c=parseInt(b.key,10));return c},_getFloatNumberFieldDecimalPlace:function(b){var c=0;this.floatNumberFieldDecimalPlace&&(b=this.floatNumberFieldDecimalPlace[b],
"number"===typeof b&&(c=b));return c},_getBestValueForFloatNumberField:function(b,c){var e=this._getFloatNumberFieldDecimalPlace(c),e=b.toFixed(e);return parseFloat(e)},getFeatureModeStatisticsInfo:function(c){var e=c.labelField,k=c.valueFields,h="des"!==c.sortOrder,m=[],m=g.map(c.features,n.hitch(this,function(a){var d=a.attributes;a={category:d[e],valueFields:[],dataFeatures:[a]};a.valueFields=g.map(k,n.hitch(this,function(a){return d[a]}));return a}));h?m.sort(function(a,d){return a.category<d.category?
-1:a.category>d.category?1:0}):m.sort(function(a,d){return a.category<d.category?1:a.category>d.category?-1:0});this._isDateField(e)&&0<m.length&&g.map(m,n.hitch(this,function(a){var d=a.category;"number"===typeof d&&0<d&&(a.category=b.localizeDate(new Date(d)))}));return m},getCategoryModeStatisticsInfo:function(e){var k=e.categoryField,p=e.valueFields,h=e.operation,m="des"!==e.sortOrder,a=[],d={};g.forEach(e.features,n.hitch(this,function(a){var b=a.attributes[k],f=null;d.hasOwnProperty(b)?(f=d[b],
f.dataFeatures.push(a)):(f={dataFeatures:[a]},d[b]=f)}));var f=null,r;for(r in d)f=d[r],this._isNumberField(k)&&c.isDefined(r)&&(r=parseFloat(r)),f.valueFields=g.map(p,n.hitch(this,function(a){var d=g.map(f.dataFeatures,n.hitch(this,function(d){return d.attributes[a]})),b=0;"max"===h?b=-Infinity:"min"===h&&(b=Infinity);var c=0;g.forEach(d,n.hitch(this,function(a){this._isNumber(a)&&(c++,"average"===h||"sum"===h?b+=a:"max"===h?b=Math.max(b,a):"min"===h&&(b=Math.min(b,a)))}));0<c?"average"===h&&(b/=
c):b=0;return b})),a.push({category:r,valueFields:f.valueFields,dataFeatures:f.dataFeatures});m?a.sort(function(a,d){return a.category<d.category?-1:a.category>d.category?1:0}):a.sort(function(a,d){return a.category<d.category?1:a.category>d.category?-1:0});this._isDateField(k)&&0<a.length&&g.map(a,n.hitch(this,function(a){var d=a.category;d&&0<parseInt(d,10)&&(a.category=b.localizeDate(new Date))}));a=g.filter(a,n.hitch(this,function(a){var d=!1;a=a.category;"number"===typeof a&&(d=isNaN(a));return!d}));
"sum"!==h&&"average"!==h||g.forEach(a,n.hitch(this,function(a){g.forEach(p,n.hitch(this,function(d,b){if(this._isFloatNumberField(d)){var f=a.valueFields[b],f=this._getBestValueForFloatNumberField(f,d);a.valueFields[b]=f}}))}));return a},getCountModeStatisticsInfo:function(c){var e=c.categoryField,k="des"!==c.sortOrder,h={};g.forEach(c.features,n.hitch(this,function(a){var d=a.attributes[e],b=null;h.hasOwnProperty(d)?(b=h[d],b.count++,b.dataFeatures.push(a)):(b={count:1,dataFeatures:[a]},h[d]=b)}));
c=[];var m=null,a;for(a in h)m=h[a],this._isNumberField(e)&&(a=parseFloat(a)),c.push({fieldValue:a,count:m.count,dataFeatures:m.dataFeatures});k?c.sort(function(a,b){return a.fieldValue<b.fieldValue?-1:a.fieldValue>b.fieldValue?1:0}):c.sort(function(a,b){return a.fieldValue<b.fieldValue?1:a.fieldValue>b.fieldValue?-1:0});this._isDateField(e)&&0<c.length&&g.forEach(c,n.hitch(this,function(a){if(a.fieldValue){var d=parseInt(a.fieldValue,10);0<d&&(a.fieldValue=b.localizeDate(new Date(d)))}}));return c},
getFieldModeStatisticsInfo:function(b){var c=b.valueFields,e=b.operation,h=g.map(b.features,n.hitch(this,function(a){return a.attributes})),m={};g.forEach(c,n.hitch(this,function(a){m[a]=0;"max"===e?m[a]=-Infinity:"min"===e&&(m[a]=Infinity);var d=0;g.forEach(h,n.hitch(this,function(b){b=b[a];this._isNumber(b)&&(d++,m.hasOwnProperty(a)?"average"===e||"sum"===e?m[a]+=b:"max"===e?m[a]=Math.max(m[a],b):"min"===e&&(m[a]=Math.min(m[a],b)):m[a]=b)}));0<d?"average"===e&&(m[a]/=d):m[a]=0}));"sum"!==e&&"average"!==
e||g.forEach(c,n.hitch(this,function(a){m.hasOwnProperty(a)&&this._isFloatNumberField(a)&&(m[a]=this._getBestValueForFloatNumberField(m[a],a))}));return m}});return{getFeatureModeStatisticsInfo:function(b){return(new k({layerDefinition:b.layerDefinition})).getFeatureModeStatisticsInfo(b)},getCategoryModeStatisticsInfo:function(b){return(new k({layerDefinition:b.layerDefinition})).getCategoryModeStatisticsInfo(b)},getCountModeStatisticsInfo:function(b){return(new k({layerDefinition:b.layerDefinition})).getCountModeStatisticsInfo(b)},
getFieldModeStatisticsInfo:function(b){return(new k({layerDefinition:b.layerDefinition})).getFieldModeStatisticsInfo(b)}}})},"jimu/dijit/Chart":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/dom-style dojo/dom-geometry dojo/Evented esri/lang libs/echarts/echarts jimu/utils ./_Gauge dojo/_base/config libs/echarts/light libs/echarts/dark".split(" "),function(q,g,n,b,c,k,e,t,p,h,m){return q([g,k],{baseClass:"jimu-dijit-chart",templateString:"\x3cdiv\x3e\x3c/div\x3e",declaredClass:"jimu.dijit.chart",
config:null,validConfig:{type:"column bar line pie radar funnel gauge".split(" "),common:"type title labels legend confine toolbox color theme backgroundColor scale dataZoom events series advanceOption".split(" "),axisChart:["stack","axisPointer","hidexAxis","hideyAxis"],pie:["innerRadius","labelLine"],funnel:["min","max","funnelSort"],gauge:["shape","min","max","gaugeOption"],radar:["radarShape","indicator"]},defaultConfiguration:{series:{pieSeries:[{type:"pie",radius:[0,"70%"],labelLine:{normal:{show:!0,
length:5,length2:5}},data:[]}],funnelSeries:[{type:"funnel",minSize:"0%",maxSize:"100%",sort:"descending",data:[]}]},toolboxs:{dataView:{title:"Data view",readOnly:!1},magicType:{title:{line:"switch to line",bar:"switch to bar",stack:"switch to stack",tiled:"switch to tiled"},type:["line","bar","stack","tiled"]},restore:{title:"restore"},saveAsImage:{title:"save as image"}}},postCreate:function(){this.inherited(arguments);if(this.chartDom){var a=c.getMarginBox(this.chartDom);0===a.w&&(a.w=10);0===
a.h&&(a.h=10);b.set(this.domNode,{width:a.w+"px",height:a.h+"px"})}else console.warn("No valid chart dom!"),b.set(this.domNode,{width:"10px",height:"10px"});this.gauge=new h;this.chart=t.init(this.domNode,this.config.theme||"light");this.gauge.setChart(this.chart);this.gauge.setRTL(this._isRTL());this.setConfig()},updateConfig:function(a){return p.isNotEmptyObject(a)?(n.mixin(this.config,a),this.setConfig()):!1},setConfig:function(a){p.isNotEmptyObject(a)?this.config=a:this.config=this.config||{};
if(!this._checkConfig(this.config))return!1;this._customTheme();this.clear();this.chart.setOption(this._chartFactory(this.config),!0);this._resize();return!0},_chartFactory:function(a){a=n.clone(a);var d=n.clone(this.defaultConfiguration),b=this.option={},b=this._settingDefaultGrid(b,a),b=this._settingRenderOption(b,a),b=this._settingTitle(b,a),b=this._settingBackgroundColor(b,a),b=this._settingColor(b,a),b=this._settingToolTip(b,a);this._isAxisChart(a)?(b=this._settingAxisChartAxis(b,a),b=this._settingToolBox(b,
a,d),b=this._settingSeries(b,a),b=this._settingStack(b,a),b=this._settingAxisDisplay(b,a)):this._isNoAxisChart(a)&&(b=this._settingToolBox(b,a,d,"magicType"),b=this._settingNoAxisCharts(b,a,d));b=this._settingLegend(b,a);b=this._settingScale(b,a);b=this._handleChartRtl(b,a);b=this._avoidTitleToolBoxOverlap(b,a);b=this._pieChartAvoidLegendLabelOverLap(b,a);b=this._settingAdvanceOption(b,a);b=this._avoidAdjoiningColorSameForPie(b,a);this._bindEvents(a);return b},_avoidAdjoiningColorSameForPie:function(a,
b){if("pie"!==b.type||!a.color||2>=a.color.length)return a;p.isNotEmptyObject(a.series,!0)&&a.series.forEach(n.hitch(this,function(b){var d=b.data.length;0===(d-1)%a.color.length&&(b=b.data[d-1],b.itemStyle||(b.itemStyle={}),b.itemStyle.normal||(b.itemStyle.normal={}),b.itemStyle.normal.color||(b.itemStyle.normal.color=a.color[1]))}));return a},_pieChartAvoidLegendLabelOverLap:function(a,b){if("pie"!==b.type)return a;var d=b.labelLine?.75:.85,c=this.chart.getHeight(),c=parseInt(c/2,10);b.legend&&
(d-=.12,a.series[0].center=["50%",c-20]);a.series[0].radius[1]=100*d+"%";return a},_settingDefaultGrid:function(a,b){this._isAxisChart(b)&&(a.grid={top:20,bottom:10,left:10,right:10,containLabel:!0});return a},_settingRenderOption:function(a){a.hoverLayerThreshold=1E3;a.progressiveThreshold=1E3;a.progressive=100;a.animationThreshold=1E3;return a},clear:function(){this.chart.clear()},resize:function(a,d){b.set(this.domNode,{width:a||"100%",height:d||"100%"});a?"string"===typeof a&&(a=Number(a.replace("px",
""))):a=this.domNode.clientWidth;this.chart.resize();this._resize(a)},_resize:function(a){this.chart.setOption(this._settingFixedPosition(a));this.config.shape&&"curved"!==this.config.shape&&(this.gauge._resetGrid(this.config),this.gauge._resetGraphic(this.config))},_settingFixedPosition:function(a){var b=this.config,c=this.option;this._isAxisChart(b)&&(c=this._settingDataZoom(c,b,a),c=this._settingGrid(c,b));"pie"===b.type&&(c=this._pieChartAvoidLegendLabelOverLap(c,b));return c},destroy:function(){this.chart.clear();
p.isNotEmptyObject(this.config.events)&&this.config.events.forEach(n.hitch(this,function(a){this.chart.off(a.name)}));this.inherited(arguments)},_settingAxisDisplay:function(a,b){if(!this._isAxisChart(b))return a;a.xAxis.show=!b.hidexAxis;a.yAxis.show=!b.hideyAxis;a.grid.containLabel=!b.hideyAxis;return a},_handleChartRtl:function(a,b){if(!this._isRTL())return a;if(this._isAxisChart(b)||"vertical"===b.shape||"horizontal"===b.shape)a.xAxis.inverse=!0,a.yAxis.position="right";return a},_settingTitle:function(a,
b){b.title&&(a.title={textStyle:{fontSize:16}},a.title.text=b.title);return a},_settingColor:function(a,b){p.isNotEmptyObject(b.color)&&(a.color=b.color);return a},_settingBackgroundColor:function(a,b){b.backgroundColor&&(a.backgroundColor=b.backgroundColor);return a},_settingToolTip:function(a,b){a.tooltip={};if(b.axisPointer){if(a.tooltip.trigger="axis","column"===b.type||"bar"===b.type)a.tooltip.axisPointer={type:"shadow"}}else a.tooltip.axisPointer={type:""};return a},_settingAxisChartAxis:function(a,
b){a.xAxis={};a.yAxis={};"column"===b.type||"line"===b.type&&b.labels?(a.xAxis.data=b.labels,a.xAxis.type="category"):"bar"===b.type&&b.labels&&(a.yAxis.data=b.labels,a.yAxis.type="category");return a},_settingToolBox:function(a,b,c,e){a.toolbox={};e||(e="");p.isNotEmptyObject(b.toolbox)&&(a.toolbox.feature={},b.toolbox.forEach(function(d){d!==e&&(b.stack&&(c.toolboxs.magicType.type=["line","bar","stack","tiled"]),a.toolbox.feature[d]=c.toolboxs[d])}));return a=this._handleToolBoxRTL(a,b)},_settingSeries:function(a,
b){if(p.isNotEmptyObject(b.series))p.isNotEmptyObject(a.series)||(a.series=b.series);else return console.log("No series!"),a;b.series.forEach(n.hitch(this,function(d,c){var f="",f=d.type?d.type:b.type;d.data=d.data.map(n.hitch(this,function(a,d){if(this._isNoAxisChart(b)){var c={};c.value=a;c.name=b.labels[d]||"";return c}return a}));a.series[c].name=d.name||"";a.series[c].type="column"===f?"bar":f;a.series[c].data=d.data}));return a},_settingNoAxisCharts:function(a,b,c){if("pie"===b.type)a=this._settingPie(a,
b,c);else if("funnel"===b.type)a=this._settingFunnel(a,b,c);else if("radar"===b.type)a=this._settingRadar(a,b);else if("gauge"===b.type)return this.gauge._settingGaugeSeries(a,b);return this._settingSeries(a,b)},_settingScale:function(a,b){if(!b.scale)return a;"bar"===b.type?a.xAxis.scale=!0:"line"===b.type||"column"===b.type?a.yAxis.scale=!0:"radar"===b.type&&(a.radar.scale=!0);return a},_settingAdvanceOption:function(a,b){b.advanceOption&&("object"===typeof b.advanceOption?n.mixin(a,b.advanceOption):
"function"===typeof b.advanceOption&&b.advanceOption(a));return a},_bindEvents:function(a){p.isNotEmptyObject(a.events)&&a.events.forEach(n.hitch(this,function(a){this.chart.on(a.name,a.callback)}))},_settingLegend:function(a,b){if(!b.legend)return a;a.legend={orient:"horizontal",x:"left",height:20,y:"bottom",data:[]};this._isAxisChart(b)||"gauge"===b.type?a.series.forEach(function(b){a.legend.data.push(b.name)}):"pie"!==b.type&&"funnel"!==b.type&&"radar"!==b.type||a.series[0].data.forEach(function(b){a.legend.data.push(b.name)});
return a=this._handleLegendRTL(a,b)},_handleDataZoomStyle:function(a,b){b.showDataShadow=!1;b.realtime=!1;b.bottom=a.legend?30:"auto";return b},_showDataZoom:function(a,b,c){c=c||this.chart.getWidth();var d=b.series[0].data.length*b.series.length,f=this._isRTL(),e=this._getaxisZeroPosition(b);c="bar"!==b.type?f?e.left:c-e.left-a.grid.right:e.top;this.showDataZoom=8>c/d;var h=c/(8*d),h=parseInt(100*h,10),h=100<h?100:h;c=[];var g="bar"===b.type?"xAxis":"yAxis",m="bar"===b.type?"yAxisIndex":"xAxisIndex",
k="bar"===b.type?"width":"height";a=this._initAxisOfDataZoom(a,g);c=b.dataZoom.map(n.hitch(this,function(a){a={type:a,start:0,show:this.showDataZoom};a[m]=[0];a[k]=15;a.end=h;"xAxis"===g&&this._isRTL()&&(a.left="10");return a=this._handleDataZoomStyle(b,a)}));a.dataZoom=c;return a},_settingDataZoom:function(a,b,c){if(!p.isNotEmptyObject(b.dataZoom))return{dataZoom:[]};b.dataZoom?a=this._showDataZoom(a,b,c):(this.showDataZoom=!1,a.dataZoom=[]);return a},_avoidTitleToolBoxOverlap:function(a,b){if("gauge"===
b.type)return a;var d=10;b.title&&(d+=20);p.isNotEmptyObject(b.toolbox,!0)&&(d+=20);p.isNotEmptyObject(b.toolbox,!0)&&b.title&&(a.toolbox.top=20);this._isAxisChart(b)&&a.grid&&(a.grid.top=d);return a},_settingGrid:function(a,b){if(!this._isAxisChart(b))return a;var d=10;b.title&&(d+=20);p.isNotEmptyObject(b.toolbox,!0)&&(d+=20);p.isNotEmptyObject(b.toolbox,!0)&&b.title&&(a.toolbox.top=20);a.grid&&(a.grid.top=d);var d=10,c=43;b.hideyAxis&&(d=20,c=63);var e=this._isRTL(),h=0,g=10;b.legend&&(h=10,g+=
20);"bar"===b.type?(e?a.grid.left=this.showDataZoom?30:10:a.grid.right=this.showDataZoom?30:10,a.grid.bottom=g):a.grid.bottom=this.showDataZoom?c+h:d+h;return a},_handleLegendRTL:function(a,b){if(!b.legend)return a;var d={};this._isRTL()?d.x="right":d.x="left";a.legend=n.mixin(a.legend,d);return a},_handleToolBoxRTL:function(a,b){if(!b.toolbox)return a;var d={top:0};this._isRTL()?d.right=0:d.left=0;a.toolbox=n.mixin(a.toolbox,d);return a},_initAxisOfDataZoom:function(a,b){a[b].type="value";a.xAxis.splitLine=
{show:!0,lineStyle:{type:"dashed"}};a.yAxis.splitLine={show:!0,lineStyle:{type:"dashed"}};return a},_isRTL:function(){return"ar"===m.locale||"he"===m.locale},_settingStack:function(a,b){if(!this._isAxisChart(b))return a;a.series=a.series.map(function(a){b.stack&&(a.stack="stack","line"===b.type&&(a.areaStyle={normal:{}},a.smooth=!0));return a});return a},_settingPie:function(a,b,c){if("pie"!==b.type)return a;a.series=c.series.pieSeries;b.innerRadius&&(a.series[0].radius[0]=b.innerRadius);a.series[0].labelLine.normal.show=
"undefined"===typeof b.labelLine?!0:b.labelLine;return a},_settingFunnel:function(a,b,c){if("funnel"!==b.type)return a;a.series=c.series.funnelSeries;p.isNotEmptyObject(b.funnel)&&(a.series[0].min=b.min||0,a.series[0].max=b.max||100,a.series[0].sort=b.funnelSort||"descending");return a},_settingRadar:function(a,b){var d=this;if("radar"!==b.type)return a;a.radar={nameGap:6,radius:"70%"};b.radarShape&&(a.radar.shape=b.radarShape);b.indicator?a.radar.indicator=b.indicator:console.error("No radar indicator");
a.series=[{}];a.series[0].label={normal:{show:!0,formatter:function(a){return d._tryLocaleNumber(a.value)}}};var c=[];b.series[0].data.forEach(function(a,d){c[d]={tooltip:"\x3cspan\x3e"+b.labels[d]+"\x3c/span\x3e"};a.forEach(function(a,e){c[d].tooltip+="\x3cbr/\x3e\x3cspan\x3e"+b.indicator[e].name+"\x3c/span\x3e : \x3cspan\x3e"+a+"\x3c/span\x3e"})});a.tooltip={trigger:"item",formatter:function(a){return'\x3cspan class\x3d"colorEl marginRight5" style\x3d"background-color:'+p.encodeHTML(a.color)+'"\x3e\x3c/span\x3e'+
c[a.dataIndex].tooltip}};this.config.confine&&(a.tooltipconfine=!0);return a},_customTheme:function(){var a=this;p.isNotEmptyObject(this.chart._theme)||(this.chart._theme={});p.isNotEmptyObject(this.config.color)&&(this.chart._theme.color=this.config.color);p.isNotEmptyObject(this.chart._theme.tooltip)||(this.chart._theme.tooltip={});this.config.confine&&(this.chart._theme.tooltip.confine=!0);this.chart._theme.tooltip.axisPointer={type:"cross",label:{show:!0,precision:2,formatter:function(b){return"number"===
typeof b.value?(b=parseFloat(b.value).toFixed(2),a._tryLocaleNumber(b)):b.value}},lineStyle:{color:"#27727B",type:"dashed"},crossStyle:{color:"#27727B"},shadowStyle:{color:"rgba(200,200,200,0.3)"}};this.chart._theme.tooltip.formatter=function(a){function b(a){var b='\x3cdiv class\x3d"tooltip-tr"\x3e',c='\x3cdiv class\x3d"colorEl marginRight5" style\x3d"background-color:'+p.encodeHTML(a.color)+'"\x3e\x3c/div\x3e',b=b+c;a.name&&"%00-"!==encodeURI(a.name)&&(b+="\x3cdiv\x3e"+a.name+"\x3c/div\x3e\x3cdiv\x3e : \x3c/div\x3e");
b+="\x3cdiv\x3e"+d._tryLocaleNumber(a.value)+"\x3c/div\x3e";"pie"===a.seriesType&&(b+="\x3cdiv\x3e("+a.percent+"%)\x3c/div\x3e");return b+"\x3c/div\x3e"}var d=this;return function(a){var d='\x3cdiv class\x3d"tooltip-div"\x3e';Array.isArray(a)?("%00-"!==encodeURI(a[0].seriesName)&&(d+='\x3cdiv class\x3d"tr"\x3e'+a[0].seriesName+"\x3c/div\x3e"),a.forEach(function(a){d+=b(a)})):("%00-"!==encodeURI(a.seriesName)&&(d+='\x3cdiv class\x3d"tr"\x3e'+a.seriesName+"\x3c/div\x3e"),d+=b(a));return d+="\x3c/div\x3e"}(a)}.bind(this);
p.isNotEmptyObject(this.chart._theme.valueAxis)||(this.chart._theme.valueAxis={});p.isNotEmptyObject(this.chart._theme.valueAxis.axisLabel)||(this.chart._theme.valueAxis.axisLabel={});this.chart._theme.valueAxis.axisLabel.formatter=function(a){return p.localizeNumber(a)}},_checkConfig:function(a){var b=!0;p.isNotEmptyObject(a)||(console.error("Empty config"),b=!1);if(!a.type||0>this.validConfig.type.indexOf(a.type))console.error("Invaild chart type!"),b=!1;var c=n.clone(this.validConfig),e=c.common,
h=[],h="column"===a.type||"bar"===a.type||"line"===a.type?e.concat(c.axisChart):e.concat(c[a.type]);Object.keys(a).forEach(function(a){0>h.indexOf(a)&&(b=!1,console.error("Invalid configuration parameter: "+a))});return b},_tryLocaleNumber:function(a){var b=a;if(e.isDefined(a)&&isFinite(a))try{var c=p.localizeNumber(a);"string"===typeof c&&(b=c)}catch(r){console.error(r)}return b+""},_getaxisZeroPosition:function(a){if(!this.chart)return!1;var b={},c=0,e=0;if((p.isNotEmptyObject(a.dataZoom,!0)||a.scale)&&
a.series&&a.series[0]&&a.series[0].data){var h=a.series[0].data;p.isNotEmptyObject(h,!0)&&("bar"!==a.type?e=p.getMinOfArray(h):c=p.getMinOfArray(h))}if(a=this.chart.convertToPixel({xAxisIndex:0,yAxisIndex:0},[c,e]))c=a[1]-5,b.left=a[0]-5,b.top=c;return p.isNotEmptyObject(b)?b:!1},_isAxisChart:function(a){return"column"===a.type||"bar"===a.type||"line"===a.type},_isNoAxisChart:function(a){return"pie"===a.type||"funnel"===a.type||"radar"===a.type||"gauge"===a.type}})})},"jimu/dijit/_Gauge":function(){define(["dojo/_base/declare",
"dojo/_base/lang","jimu/utils"],function(q,g,n){return q([],{curvedGaugeSeries:[{type:"gauge",center:["50%","60%"],startAngle:200,endAngle:-20,axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{distance:-52,textStyle:{color:"#000"}},pointer:{length:"65%",width:5},itemStyle:{normal:{}},detail:{offsetCenter:[0,"60%"],textStyle:{color:"24B5CC"}},title:{show:!1},data:[{value:0}],animationEasingUpdate:"bounceOut",animationDurationUpdate:500,animationDelayUpdate:100}],
horizontalGauge:{grid:{top:"middle",height:90},xAxis:{show:!0,offset:-27,type:"value",scale:!1,interval:1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},splitLine:{show:!1}},yAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{normal:{color:"#E5E5E5"}},barGap:"-100%",data:[100],z:1},{type:"bar",
barWidth:30,label:{normal:{show:!0,position:"top",offset:[20,0],textStyle:{}}},data:[{value:40,label:{normal:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}}},itemStyle:{normal:{}}}],itemStyle:{normal:{color:"#24B5CC"}},z:10}]},verticalGauge:{grid:{left:"middle",width:60},yAxis:{show:!0,offset:-10,type:"value",interval:1,scale:!1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",
fontStyle:"normal",fontWeight:"normal"}},splitLine:{show:!1}},xAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{normal:{color:"#E5E5E5"}},barGap:"-100%",data:[100],z:1},{type:"bar",barWidth:30,label:{normal:{show:!0,position:"insideTopLeft",offset:[30,-15],textStyle:{}}},data:[{value:40,label:{normal:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}}},itemStyle:{normal:{}}}],itemStyle:{normal:{color:"#24B5CC"}},
z:10}]},setChart:function(b){this.chart=b},setRTL:function(b){this._isRTL=b},_settingValueStyle:function(b,c){if(c.gaugeOption&&n.isNotEmptyObject(c.gaugeOption.valueStyle)){var k=c.gaugeOption.valueStyle,e=k.textStyle,k=k.formatter;"horizontal"===c.shape||"vertical"===c.shape?(g.mixin(b.series[1].data[0].label.normal.textStyle,e),k&&(b.series[1].data[0].label.normal.formatter=k)):"curved"===c.shape&&(g.mixin(b.series[0].detail.textStyle,e),k&&(b.series[0].detail.formatter=k))}return b},_settingLabelColor:function(b,
c){var g="#000";c.gaugeOption&&c.gaugeOption.labelColor&&(g=c.gaugeOption.labelColor);"curved"===c.shape?b.series[0].axisLabel.textStyle.color=g:"horizontal"===c.shape?b.xAxis.axisLabel.textStyle.color=g:"vertical"===c.shape&&(b.yAxis.axisLabel.textStyle.color=g);return b},_settingHorizontalGauge:function(b,c){g.mixin(b,g.clone(this.horizontalGauge));b.grid={top:"middle",height:90,left:"10%",right:"10%"};c.min="undefined"!==typeof c.min&&c.min?c.min:0;c.max="undefined"!==typeof c.max&&c.max?c.max:
100;b.xAxis.max=c.max;b.xAxis.min=c.min;b.xAxis.scale=!0;b.series[0].data[0]=c.max;b=this._handleValue(b,c);c.labels&&c.labels[0]&&(b.series[1].data[0].name=c.labels[0]);b.series[1].name=c.series[0].name;b=this._settingNoCurvedGaugeColor(b,c);return b=this._handleHorizontalGaugeValueRTL(b,c)},_handleHorizontalGaugeValueRTL:function(b,c){if(!this._isRTL||"horizontal"!==c.shape)return b;b.series[1].label.normal.offset=[-20,0];return b},_settingVerticalGauge:function(b,c){g.mixin(b,g.clone(this.verticalGauge));
b.grid={left:"middle",width:60,top:"10%",bottom:"10%"};b.grid.left=this._getGridLeftOfVerticalGauge();c.min="undefined"!==typeof c.min&&c.min?c.min:0;c.max="undefined"!==typeof c.max&&c.max?c.max:100;b.yAxis.max=c.max;b.yAxis.min=c.min;b.series[0].data[0]=c.max;b=this._handleValue(b,c);c.labels&&c.labels[0]&&(b.series[1].data[0].name=c.labels[0]);b.series[1].name=c.series[0].name;b=this._settingNoCurvedGaugeColor(b,c);return b=this._handleVerticalGaugeValueRTL(b,c)},_handleVerticalGaugeValueRTL:function(b,
c){if(!this._isRTL||"vertical"!==c.shape)return b;var g=(c.series[0].data[0]+"").length-1;c.gaugeOption&&c.gaugeOption.valueStyle&&"undefined"!==typeof c.gaugeOption.valueStyle.decimalPlaces&&(g+=c.gaugeOption.valueStyle.decimalPlaces);b.series[1].label.normal.offset=[-17-9*g,-15];return b},_handleValue:function(b,c){var g;c.series[0].data[0]<=c.max?g=c.series[0].data[0]:(g=c.max,b.series[1].data[0].label.normal.formatter=function(){return c.series[0].data[0]},b.tooltip.formatter=function(b){return'\x3cspan class\x3d"colorEl marginRight5" style\x3d"background-color:'+
n.encodeHTML(b.color)+'"\x3e\x3c/span\x3e'+c.series[0].data[0]});b.series[1].data[0].value=g;return b},_settingCurvedGauge:function(b,c){b.series=g.clone(this.curvedGaugeSeries);c.min="undefined"!==typeof c.min&&c.min?c.min:0;c.max="undefined"!==typeof c.max&&c.max?c.max:100;b.series[0].min=c.min;b.series[0].max=c.max;b.series[0].axisLine.lineStyle.color[0][0]=parseFloat(c.series[0].data[0]/c.max).toFixed(2);b.series[0].data[0].value=c.series[0].data[0];c.labels&&c.labels[0]&&(b.series[0].data[0].name=
c.labels[0]);c.series[0].name&&(b.series[0].name=c.series[0].name);b.series[0].axisLine.lineStyle.width=30;return b=this._settingCurvedGaugeColor(b,c)},_settingGaugeSeries:function(b,c){if("gauge"!==c.type)return b;"horizontal"===c.shape?b=this._settingHorizontalGauge(b,c):"vertical"===c.shape?b=this._settingVerticalGauge(b,c):"curved"===c.shape&&(b=this._settingCurvedGauge(b,c));b=this._settingGaugeLabel(b,c);b=this._settingLabelColor(b,c);return b=this._settingValueStyle(b,c)},_resetGraphic:function(b){b=
this._settingGraphic(b);n.isNotEmptyObject(b,!0)&&this.chart.setOption({graphic:b})},_resetGrid:function(b){b=this._settingGridLeftOfVerticalGauge(b);n.isNotEmptyObject(b)&&this.chart.setOption({grid:b})},_settingGridLeftOfVerticalGauge:function(b){return"gauge"!==b.type||"vertical"!==b.shape?{}:{left:this._getGridLeftOfVerticalGauge(),width:60,top:"10%",bottom:"10%"}},_settingCurvedGaugeColor:function(b,c){c.gaugeOption&&(c.gaugeOption.bgColor&&(b.series[0].axisLine.lineStyle.color[1][1]=c.gaugeOption.bgColor),
c.gaugeOption.columnColor&&(b.series[0].axisLine.lineStyle.color[0][1]=c.gaugeOption.columnColor));return b},_settingNoCurvedGaugeColor:function(b,c){c.gaugeOption&&(c.gaugeOption.bgColor&&(b.series[0].itemStyle.normal.color=c.gaugeOption.bgColor),c.gaugeOption.columnColor&&(b.series[1].data[0].itemStyle.normal.color=c.gaugeOption.columnColor));return b},_settingGraphic:function(b){var c=[];"gauge"===b.type&&b.gaugeOption&&("horizontal"===b.shape?c=this._settingHorizontalGraphic(b):"vertical"===b.shape&&
(c=this._settingVerticalGraphic(b)));return c},_settingHorizontalGraphic:function(b){var c="#000";b.gaugeOption&&b.gaugeOption.labelColor&&(c=b.gaugeOption.labelColor);var k=[],e=this.chart.convertToPixel({yAxisIndex:0},0),e=parseInt(e,10),e=Number(e)+16;this.cacheCriticalValues=g.clone(this.criticalValues);this.criticalValues.forEach(g.hitch(this,function(g){var p,h;"object"===typeof g?g.type&&(p=g.type,h=g.value):h=g;g=b.min||0;if(!(h>(b.max||100)||h<g)){g=this._getxAxisValueLeft(h);var m=6*(h.toString().length-
2),a=g;0<m&&(a=g-m);p||k.push({z:10,type:"image",left:g,style:{image:require.toUrl("jimu")+"/css/images/chart/top_indicator.svg",width:10,height:10},silent:!0,top:e});k.push({z:10,type:"text",left:a,style:{text:h,fill:c,font:"normal 11px sans-serif"},silent:!0,top:e+11})}}));return k},_settingVerticalGraphic:function(b){var c="#000";b.gaugeOption&&b.gaugeOption.labelColor&&(c=b.gaugeOption.labelColor);var k=[],e=this.chart.convertToPixel({xAxisIndex:0},0),e=parseFloat(e,10).toFixed(2),e=Number(e),
n=require.toUrl("jimu")+"/css/images/chart/left_indicator.svg";this._isRTL&&(e+=40,n=require.toUrl("jimu")+"/css/images/chart/left_indicator_rtl.svg");var p=e-26;this.cacheCriticalValues=g.clone(this.criticalValues);this.criticalValues.forEach(g.hitch(this,function(e){var h,a;"object"===typeof e?e.type&&(h=e.type,a=e.value):a=e;e=p;e=this._isRTL?p+11:p-11-6*(a.toString().length-1);var d=b.min||0;a>(b.max||100)||a<d||(d=this._getyAxisValueTop(a),d-=2,h||k.push({z:10,type:"image",left:p,style:{image:n,
width:10,height:10},silent:!0,top:d}),k.push({z:10,type:"text",left:e,style:{text:a,fill:c,font:"normal 11px sans-serif"},silent:!0,top:d-2}))}));return k},_getGridLeftOfVerticalGauge:function(){return this.chart.getWidth()/2-30},_getxAxisValueLeft:function(b){b=this.chart.convertToPixel({xAxisIndex:0},b);return parseFloat(b,10)-4},_getyAxisValueTop:function(b){b=this.chart.convertToPixel({yAxisIndex:0},b);return parseFloat(b,10)},_showSpecialLabel:function(b,c,g){var e=function(b){var c;g.forEach(function(e){"number"===
typeof e&&0===e%1?c=e===b?e:c:1>e-b&&0<=e-b&&(c=e)});return c};"curved"===c.shape?b.series[0].axisLabel.formatter=e:"horizontal"===c.shape?b.xAxis.axisLabel.formatter=e:"vertical"===c.shape&&(b.yAxis.axisLabel.formatter=e);return b},_settingGaugeLabel:function(b,c){var k=c.min||0,e=c.max||100,n=[];c.gaugeOption&&c.gaugeOption.showTargetValueLabel&&("curved"===c.shape&&(b.series[0].splitNumber=b.series[0].max,b.series[0].axisTick.splitNumber=1,b.series[0].axisTick.show=!1),c.gaugeOption.targetValue&&
c.gaugeOption.targetValue.forEach(function(b){n.push(b)}));this.criticalValues=g.clone(n);c.gaugeOption&&c.gaugeOption.showDataRangeLabel&&(0>n.indexOf(k)&&(n.push(k),this.criticalValues.push({type:"min",value:k})),0>n.indexOf(e)&&(n.push(e),this.criticalValues.push({type:"max",value:e})));return"curved"===c.shape?this._showSpecialLabel(b,c,n):b}})})},"libs/echarts/light":function(){(function(q,g){"function"===typeof define&&define.amd?define(["exports","./echarts"],g):"object"===typeof exports&&
"string"!==typeof exports.nodeName?g(exports,require("./echarts")):g({},q.echarts)})(this,function(q,g){g?g.registerTheme("light",{color:"#2ec7c9 #b6a2de #5ab1ef #ffb980 #d87a80 #8d98b3 #e5cf0d #97b552 #95706d #dc69aa #07a2a4 #9a7fd1 #588dd5 #f5994e #c05050 #59678c #c9ab00 #7eb00a #6f5553 #c14089".split(" "),textStyle:{},title:{textStyle:{color:"#008acd"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:"1"}},symbolSize:"6",symbol:"circle",smooth:!1},
radar:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:"1"}},symbolSize:"6",symbol:"circle",smooth:!1},bar:{itemStyle:{normal:{barBorderWidth:0,barBorderColor:"#ccc"},emphasis:{barBorderWidth:0,barBorderColor:"#ccc"}}},pie:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},funnel:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},
itemStyle:{normal:{color:"#686868"},emphasis:{color:"#686868"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},
splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#2ec7c9"},emphasis:{borderColor:"#18a4a6"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#008acd",width:"1"},crossStyle:{color:"#008acd",width:"1"}}},dataZoom:{backgroundColor:"#F4F4F4",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#E0E0E0",handleColor:"#777777",
handleSize:"100%",borderColor:"#F4F4F4",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"libs/echarts/dark":function(){(function(q,g){"function"===typeof define&&define.amd?define(["exports","./echarts"],g):"object"===typeof exports&&"string"!==typeof exports.nodeName?g(exports,require("./echarts")):g({},q.echarts)})(this,function(q,g){g?g.registerTheme("dark",{color:"#fc97af #87f7cf #f7f494 #72ccff #f7c5a0 #d4a4eb #d2f5a6 #76f2f2".split(" "),
textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{normal:{borderWidth:"1"}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{borderWidth:"1"}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},bar:{itemStyle:{normal:{barBorderWidth:0,barBorderColor:"#ccc"},emphasis:{barBorderWidth:0,barBorderColor:"#ccc"}}},pie:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,
borderColor:"#ccc"}}},funnel:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#1E5F6F"]]}},itemStyle:{normal:{color:"#D9D9D9"},emphasis:{color:"#D9D9D9"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,
areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},
tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},dataZoom:{backgroundColor:"#525252",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#737373",handleColor:"#BDBDBD",handleSize:"100%",borderColor:"#525252",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"jimu/dijit/_StatisticsChartSettings":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dojo/on dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_StatisticsChartSettings.html dijit/ColorPalette jimu/utils".split(" "),
function(q,g,n,b,c,k,e,t,p,h,m,a,d,f){return q([p,h,m,t],{baseClass:"jimu-dijit-statistics-chart-settings",templateString:a,colors:{c1:"#5d9cd3 #eb7b3a #a5a5a5 #febf29 #4673c2 #72ad4c".split(" "),c2:"#5d9cd3 #a5a5a5 #4673c2 #285f8f #636363 #274577".split(" "),c3:"#eb7b3a #febf29 #72ad4c #9c4618 #987214 44682e".split(" "),c4:"#72ad4c #4673c2 #febf29 #44682e #274577 #987214".split(" "),g1:["#43729b","#c4d5ea"],g2:["#ac5928","#f5ccbf"],g3:["#787878","#d8d8d8"],g4:["#bb8b1b","#fee1be"],g5:["#30538d",
"#c0c9e3"],g6:["#517e36","#c9dbc2"],g7:["#c4d5ea","#43729b"],g8:["#f5ccbf","#ac5928"],g9:["#d8d8d8","#787878"],g10:["#fee1be","#bb8b1b"],g11:["#c0c9e3","#30538d"],g12:["#c9dbc2","#517e36"]},palette:null,defaultSingleColor:"#5d9cd3",multiColorValue:"c1",imagesUrl:window.require.toUrl("jimu/css/images/chart/"),isInWidget:!1,type:"",singleColor:!1,config:null,postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart},postCreate:function(){this.inherited(arguments);this._initSelf();this.isInWidget&&
this._bindEvents();this.own(e(this.multiColorSection,"click",g.hitch(this,function(a){a=a.target||a.srcElement;if(b.hasClass(a,"multi-color")&&!b.hasClass(a,"selected")){var d=this.multiColorValue;this._selectMultiColorDiv(a);d!==a.colorValue&&this.isInWidget&&this._configChange()}})))},_initSelf:function(){this.config=g.clone(this.config);f.combineRadioCheckBoxWithLabel(this.cbxAxisX,this.labelAxisX);f.combineRadioCheckBoxWithLabel(this.cbxAxisY,this.labelAxisY);f.combineRadioCheckBoxWithLabel(this.cbxPieLabel,
this.labelPie);this._setSingleColorForColorDiv(this.defaultSingleColor);this.palette=new d({palette:"7x10",cellClass:"cursor:pointer",style:{width:"220px"},onChange:g.hitch(this,function(a){var b=this._getSingleColorFromColorDiv();this._setSingleColorForColorDiv(a);this.isInWidget&&b!==a&&this._configChange()})});this.palette.placeAt(this.paletteContainer);this.palette.startup();n.forEach(["c1","c2","c3","c4"],g.hitch(this,function(a){b.create("div",{"class":"multi-color colorful "+a},this.colorfulContainer).colorValue=
a}));n.forEach("g1 g2 g3 g4 g5 g6 g7 g8 g9 g10 g11 g12".split(" "),g.hitch(this,function(a){b.create("div",{"class":"multi-color monochromatic "+a},this.monochromaticContainer).colorValue=a}));this._setMultiColorValue("c1");"pie"===this.type?(this.singleColor=!1,b.setStyle(this.divAxisX,"display","none"),b.setStyle(this.divAxisY,"display","none")):b.setStyle(this.divPieLabel,"display","none");this.reset();this.config&&this.setConfig(this.config)},_bindEvents:function(){"pie"===this.type?this.own(e(this.cbxPieLabel,
"change",g.hitch(this,this._configChange))):(this.own(e(this.cbxAxisX,"change",g.hitch(this,this._configChange))),this.own(e(this.cbxAxisY,"change",g.hitch(this,this._configChange))))},setConfig:function(a){this.reset();this.cbxAxisX.checked=!1===a.showHorizontalAxis?!1:!0;this.cbxAxisY.checked=!1===a.showVerticalAxis?!1:!0;this.cbxPieLabel.checked=!1===a.showDataLabel?!1:!0;a=g.clone(a.colors||[]);(this.singleColor=1===a.length&&"pie"!==this.type)?this.showSingleColor(a[0]):this.showMultiColor(a)},
getConfig:function(){var a={colors:[]};"pie"===this.type?(a.colors=this.colors[this._getMultiColorValue()],2===a.colors.length&&(a.colors=this._createHexColors(a.colors[0],a.colors[1],6)),a.showDataLabel=this.cbxPieLabel.checked):(a.showHorizontalAxis=this.cbxAxisX.checked,a.showVerticalAxis=this.cbxAxisY.checked,a.colors=this.singleColor?[this._getSingleColorFromColorDiv()]:this.colors[this._getMultiColorValue()]);return a},_setSingleColorForColorDiv:function(a){b.setStyle(this.colorDiv,"backgroundColor",
a);this.colorDiv.bgHex=a},_getSingleColorFromColorDiv:function(){return this.colorDiv.bgHex},_setMultiColorValue:function(a){(a=c("."+a,this.multiColorSection))&&0<a.length&&this._selectMultiColorDiv(a[0])},_selectMultiColorDiv:function(a){c(".multi-color",this.multiColorSection).removeClass("selected");b.addClass(a,"selected");this.multiColorValue=a.colorValue},_getMultiColorValue:function(){return this.multiColorValue},reset:function(){"pie"===this.type?this.cbxPieLabel.checked=!0:(this.cbxAxisX.checked=
!0,this.cbxAxisY.checked=!0);this.singleColor?this.showSingleColor():this.showMultiColor()},showSingleColor:function(a){"pie"===this.type?this.singleColor=!1:(this.singleColor=!0,b.setStyle(this.singleColorSection,"display","block"),b.setStyle(this.multiColorSection,"display","none"),a&&this._setSingleColorForColorDiv(a))},showMultiColor:function(a){this.singleColor=!1;b.setStyle(this.singleColorSection,"display","none");b.setStyle(this.multiColorSection,"display","block");if(a&&0<a.length){var d=
null,c=!1,e;for(e in this.colors)if(d=this.colors[e],c=!1,d.length===a.length&&(c=n.every(d,g.hitch(this,function(b,d){var c=new k(b),e=new k(a[d]);return c.toHex().toLowerCase()===e.toHex().toLowerCase()})))){this._setMultiColorValue(e);break}}},showShelter:function(){b.setStyle(this.shelter,"display","block")},hideShelter:function(){b.setStyle(this.shelter,"display","none")},_configChange:function(){var a=this.getConfig();this.emit("change",a)},_createHexColors:function(a,b,d){var c=[];a=k.fromHex(a);
var e=k.fromHex(b);b=(e.r-a.r)/(d-1);for(var h=(e.g-a.g)/(d-1),e=(e.b-a.b)/(d-1),f=null,g=0;g<d;g++)f=new k,f.r=Math.floor(a.r+b*g),f.g=Math.floor(a.g+h*g),f.b=Math.floor(a.b+e*g),c.push(f.toHex());return c}})})},"widgets/Chart/Query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred esri/tasks/query esri/tasks/QueryTask jimu/utils jimu/dijit/Message".split(" "),function(q,g,n,b,c,k,e,t){function p(){return{url:"",layerInfo:null,limit:1E4,spatialReference:null,queryType:-1,
objectIdField:"",query:{maxRecordCount:1E3,where:"",geometry:null,relationship:c.SPATIAL_REL_INTERSECTS,outFields:["*"],nextIndex:0,allCount:0,objectIds:[],features:[]}}}q=q(null,{currentAttrs:null,constructor:function(b){this.currentAttrs=p();this.currentAttrs.url=b.url;this.currentAttrs.layerInfo=b.layerInfo;this.currentAttrs.spatialReference=b.spatialReference;this.currentAttrs.query.where=b.where;this.currentAttrs.query.geometry=b.geometry;this.currentAttrs.query.maxRecordCount=b.layerInfo.maxRecordCount||
1E3;this.currentAttrs.queryType=this._getQueryType(b.layerInfo);this.currentAttrs.objectIdField=e.getObjectIdField(b.layerInfo);b.relationship&&(this.currentAttrs.query.relationship=b.relationship);b.outFields&&(this.currentAttrs.query.outFields=b.outFields);if(0<b.limit||b.limit>this.currentAttrs.query.maxRecordCount)this.currentAttrs.limit=b.limit},getFeatures:function(){var c=new b,c=this.currentAttrs.query.where,e=this.currentAttrs.query.geometry,a=this.currentAttrs.query.relationship;return c=
2===this.currentAttrs.queryType?this._getAllFeatures_SupportObjectIds(c,e,a):this._getAllFeatures_NotSupportObjectIds(c,e,a)},_getQueryType:function(b){var c=-1;return c=this._isSupportObjectIds(b)?2:3},_isServiceSupportsOrderBy:function(b){var c=!1;b.advancedQueryCapabilities&&b.advancedQueryCapabilities.supportsOrderBy&&(c=!0);return c},_isServiceSupportsPagination:function(b){var c=!1;b.advancedQueryCapabilities&&b.advancedQueryCapabilities.supportsPagination&&(c=!0);return c},_isSupportObjectIds:function(b){var c=
0;b.currentVersion&&(c=parseFloat(b.currentVersion));return 10<=c||b.hasOwnProperty("typeIdField")},_getAllFeatures_SupportObjectIds:function(b,c,a){return this._queryIds(b,c,a).then(g.hitch(this,function(a){if(!(a&&0<a.length))return this.currentAttrs.query.allCount=0,{status:1,count:0,features:[]};var b=a.length;this.currentAttrs.query.allCount=b;this.currentAttrs.query.objectIds=a;this.currentAttrs.query.nextIndex=0;return b>this.currentAttrs.query.maxRecordCount?this._isContinue().then(g.hitch(this,
function(a){return a?this._onResultsScroll_SupportObjectIds():{status:-1,count:b,features:[]}})):this._onResultsScroll_SupportObjectIds()}))},_isContinue:function(){var c=new b,e=window.jimuNls.queryFeatures,a=new t({message:e.tooManyFeaturesTip+" "+e.askForContinue,buttons:[{label:window.jimuNls.common.continue1,onClick:g.hitch(this,function(){c.resolve(!0);a.close()})},{label:window.jimuNls.common.cancel,onClick:g.hitch(this,function(){c.resolve(!1);a.close()})}]});return c},_onResultsScroll_SupportObjectIds:function(){var c=
new b,e=this.currentAttrs.query.objectIds,a=this.currentAttrs.query.allCount,d=this.currentAttrs.query.nextIndex,f=this.currentAttrs.query.maxRecordCount,k=this.currentAttrs.query.relationship;if(d>=a)return c.resolve({status:1,count:a,features:this.currentAttrs.query.features}),c;e=e.slice(d,d+Math.min(e.length-d,f));return 0===e.length?(c.resolve({status:1,count:a,features:this.currentAttrs.query.features}),c):this._queryByObjectIds(e,!0,k).then(g.hitch(this,function(a){a=a.features;this.currentAttrs.query.nextIndex+=
a.length;this.currentAttrs.query.features=this.currentAttrs.query.features.concat(a);return this._onResultsScroll_SupportObjectIds()}))},_getAllFeatures_NotSupportObjectIds:function(b,c,a){return this._doQuery_NotSupportObjectIds(b,c,a).then(g.hitch(this,function(a){return{status:1,count:a.length,features:a}}))},_doQuery_NotSupportObjectIds:function(c,e,a){var d=new b;this._query(c,e,!0,a).then(g.hitch(this,function(a){a=a.features;this.currentAttrs.query.allCount=a.length;d.resolve(a)}),g.hitch(this,
function(a){console.error(a);d.reject(a)}));return d},_getOutputFields:function(){return["*"]},_query:function(b,e,a,d){var f=new c;f.where=b;e&&(f.geometry=e);f.outSpatialReference=this.currentAttrs.spatialReference;f.returnGeometry=!!a;f.spatialRelationship=d;f.outFields=this._getOutputFields();return(new k(this.currentAttrs.url)).execute(f)},_queryIds:function(b,e,a){var d=new c;d.where=b;e&&(d.geometry=e);d.returnGeometry=!1;d.spatialRelationship=a;d.outSpatialReference=this.currentAttrs.spatialReference;
return(new k(this.currentAttrs.url)).executeForIds(d)},_queryByObjectIds:function(e,m,a){var d=new b,f=new c;f.returnGeometry=!!m;f.outSpatialReference=this.currentAttrs.spatialReference;f.outFields=this._getOutputFields();f.objectIds=e;f.spatialRelationship=a;(new k(this.currentAttrs.url)).execute(f).then(g.hitch(this,function(a){d.resolve(a)}),g.hitch(this,function(b){if(400===b.code){var c=this.currentAttrs.objectIdField,f="",h=e.length;n.forEach(e,g.hitch(this,function(a,b){f+=c+" \x3d "+a;b!==
h-1&&(f+=" OR ")}));this._query(f,null,m,a).then(g.hitch(this,function(a){d.resolve(a)}),g.hitch(this,function(a){d.reject(a)}))}else d.reject(b)}));return d}});q.getCleanCurrentAttrsTemplate=p;return q})},"widgets/Chart/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/StatisticsChart.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"results-header" data-dojo-attach-point\x3d"resultsHeader" style\x3d"margin-bottom:15px;"\x3e\r\n\t\t\x3cdiv class\x3d"chart-title jimu-float-leading" data-dojo-attach-point\x3d"chartTitle"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"paging-section jimu-float-leading"\x3e\r\n\t\t\t\x3cul data-dojo-attach-point\x3d"pagingUl" data-dojo-attach-event\x3d"onclick:_onPagingUlClicked"\x3e\x3c/ul\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoomin jimu-float-trailing" data-dojo-attach-point\x3d"zoominIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"settings jimu-float-trailing" data-dojo-attach-point\x3d"settingsIcon"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"chart-section"\x3e\r\n\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;table-layout:fixed;"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"arrow-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item left-arrow arrow" data-dojo-attach-point\x3d"leftArrow" data-dojo-attach-event\x3d"onclick:_onLeftArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"content-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item chart-container" data-dojo-attach-point\x3d"chartContainer" dir\x3d"ltr"\r\n\t\t\t\t\t\tstyle\x3d"direction:ltr;overflow:hidden;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"arrow-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item right-arrow arrow" data-dojo-attach-point\x3d"rightArrow" data-dojo-attach-event\x3d"onclick:_onRightArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_StatisticsChartSettings.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"divAxisX" class\x3d"setting-item"\x3e\r\n\t\t\x3cinput data-dojo-attach-point\x3d"cbxAxisX" type\x3d"checkbox" /\x3e\r\n\t\t\x3clabel data-dojo-attach-point\x3d"labelAxisX"\x3e${nls.horizontalAxis}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"divAxisY" class\x3d"setting-item"\x3e\r\n\t\t\x3cinput data-dojo-attach-point\x3d"cbxAxisY" type\x3d"checkbox" /\x3e\r\n\t\t\x3clabel data-dojo-attach-point\x3d"labelAxisY"\x3e${nls.verticalAxis}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"divPieLabel" class\x3d"setting-item"\x3e\r\n\t\t\x3cinput data-dojo-attach-point\x3d"cbxPieLabel" type\x3d"checkbox" checked /\x3e\r\n\t\t\x3clabel data-dojo-attach-point\x3d"labelPie"\x3e${nls.dataLabels}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv\x3e\r\n\t\t\x3cdiv class\x3d"color-tip"\x3e${nls.color}\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"singleColorSection" class\x3d"single-color-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"colorDiv" class\x3d"single-color-div"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"paletteContainer" class\x3d"palette-container"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"multiColorSection" class\x3d"multi-color-section"\x3e\r\n\t\t\t\x3cdiv class\x3d"colorful-section"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"colorfulContainer"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"monochromatic-section"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monochromaticContainer"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Chart/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"chart-widget-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"chartList" class\x3d"chart-step chart-list"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"chartsNode" class\x3d"charts"\x3e\r\n        \x3cdiv class\x3d"execute-tip"\x3e\r\n          ${nls.executeChartTip}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"charts-table-container"\x3e\r\n          \x3ctable data-dojo-attach-event\x3d"onclick:_onChartListClicked" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"charts-table" onselectstart\x3d"return false;"\x3e\r\n            \x3ccolgroup\x3e\r\n              \x3ccol width\x3d"14px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n            \x3c/colgroup\x3e\r\n            \x3ctbody data-dojo-attach-point\x3d"chartsTbody"\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"invalidConfigNode" class\x3d"invalid-config"\x3e\r\n        \x3cdiv class\x3d"error"\x3e\r\n          ${nls.invalidConfig}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noChartTipSection" class\x3d"no-chart-tip"\x3e\r\n        ${nls.noneChartTip}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"chartParams" class\x3d"chart-step chart-params"\x3e\r\n      \x3cdiv class\x3d"step-head chart-params-head"\x3e\r\n        \x3cdiv class\x3d"step-title params-title"\x3e${nls.chartParams}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back jimu-float-leading" data-dojo-attach-event\x3d"onclick:_onBtnParamsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip jimu-float-leading"\x3e${nls.charts}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"apply jimu-float-trailing" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"onclick:_onBtnApplyClicked"\x3e${nls.apply}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"params-container" data-dojo-attach-point\x3d"paramsContainer"\x3e\r\n        \x3cdiv class\x3d"spatial-section" style\x3d"margin-top:20px; margin-bottom:20px;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3cinput type\x3d"checkbox" checked\x3d"false" data-dojo-attach-point\x3d"cbxUseSpatial" data-dojo-attach-event\x3d"onclick: _onCbxUseSpatialClicked" /\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"labelUseSpatial"\x3e${nls.useSpatialFilter}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"selectSpatialDiv" class\x3d"select-spatial"\x3e\r\n            \x3ctable class\x3d"current-view" valign\x3d"top" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr class\x3d"current-extent-tr"\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"cbxUseMapExtent" checked data-dojo-attach-event\x3d"onclick:_onCbxUseMapExtentClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd class\x3d"current-extent-td"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"labelUseMapExtent" class\x3d"map-extent-tip"\x3e${nls.useCurrentMapExtent}\x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr class\x3d"draw-graphic-tr"\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"cbxDrawGraphic" data-dojo-attach-event\x3d"onclick:_onCbxDrawGraphicClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd class\x3d"draw-graphic-td"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"labelDrawGraphic" class\x3d"draw-graphic-tip"\x3e${nls.drawGraphicOnMap}\x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n            \x3cdiv class\x3d"draw-graphic" data-dojo-attach-point\x3d"drawBoxDiv"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"chartResults" class\x3d"chart-step chart-results"\x3e\r\n      \x3cdiv class\x3d"step-head chart-results-head"\x3e\r\n        \x3cdiv class\x3d"step-title results-title"\x3e${nls.chartResults}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back jimu-float-leading" data-dojo-attach-event\x3d"onclick:_onBtnResultsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip jimu-float-leading" data-dojo-attach-point\x3d"btnResultsBack"\x3e${nls.chartParams}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"results-container" data-dojo-attach-point\x3d"resultsContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"btn-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"btnClearAll" data-dojo-attach-event\x3d"onclick:_onBtnClearAllClicked" class\x3d"jimu-btn jimu-priority-secondary btn-clear-all" title\x3d"${nls.clearResults}"\x3e${nls.clearResults}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Chart/css/style.css":".jimu-widget-chart{position: relative; width: 100%; height: 100%; min-width: 222px; min-height: 237px; overflow-x: hidden;}.jimu-widget-chart .chart-widget-content{position: absolute; width: 100%; left: 0; right: 0; height: auto; top: 0; bottom: 60px;}.jimu-widget-chart .btn-section{position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: auto; text-align: center;}.jimu-widget-chart .btn-section .btn-clear-all{margin-left: auto; margin-right: auto; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-chart .chart-step{position: absolute; width: 100%; height: 100%; top: 0;}.jimu-widget-chart .chart-list{left: 0;}.jimu-widget-chart .chart-list .charts{position: absolute; width: 100%; height: 100%; left: 0; top: 0; overflow-y: auto;}.jimu-widget-chart .chart-list .charts .execute-tip{line-height: 20px;}.jimu-widget-chart .chart-list .charts .charts-table-container{width: 100%; margin-top: 15px;}.jimu-widget-chart .chart-list .charts .charts-table{width: 99%; border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto;}.jimu-widget-chart .chart-list .charts .charts-table td{height: 30px; line-height: 30px; cursor: pointer;}.jimu-widget-chart .chart-list .charts .charts-table tr *{cursor: pointer;}.jimu-widget-chart .chart-list .charts .charts-table .second-td{color: #686868; font-size: 12px;}.jimu-widget-chart .chart-list .charts .charts-table .chart-name-div{width: 100%; overflow: hidden; text-overflow: ellipsis; height: 100%;}.jimu-widget-chart .chart-list .charts .charts-table .third-td .arrow{background-repeat: no-repeat; background-position: center; background-image: url(images/arrow_right1.png); width: 100%; height: 100%;}.jimu-rtl .jimu-widget-chart .chart-list .charts .charts-table .third-td .arrow{background-image: url(images/rtl_arrow_right1.png);}.jimu-widget-chart .charts-table .jimu-table-row.jimu-state-active .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-rtl .jimu-widget-chart .charts-table .jimu-table-row.jimu-state-active .third-td .arrow{background-image: url(images/rtl_arrow_right2.png);}.jimu-widget-chart .charts-table .jimu-table-row:hover .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-rtl .jimu-widget-chart .charts-table .jimu-table-row:hover .third-td .arrow{background-image: url(images/rtl_arrow_right2.png);}.jimu-widget-chart .chart-list .invalid-config{display: none; position: absolute; width: 100%; height: 100%; left: 0; top: 0;}.jimu-widget-chart .chart-list .no-chart-tip{display: none; line-height: 20px;}.jimu-widget-chart .step-head{position: relative; width: 100%; height: 30px; line-height: 30px;}.jimu-widget-chart .step-title{position: absolute; width: 100%; height: 100%; left: 0; top: 0; text-align: center; font-size: 14px; color: #86909c;}.jimu-widget-chart .step-head .operations{position: absolute; width: 100%; height: 100%; left: 0; right: 0; top: 0;}.jimu-widget-chart .step-head .operations .params-back{color: blue; cursor: pointer; height: 100%;}.jimu-widget-chart .step-head .operations .params-back .back-icon{width: 8px; height: 100%; background-repeat: no-repeat; background-position: center center; background-image: url(images/arrow_left.png); margin-right: 5px;}.jimu-rtl .jimu-widget-chart .step-head .operations .params-back .back-icon{background-image: url(images/rtl_arrow_left.png); margin-right: 0; margin-left: 5px;}.jimu-widget-chart .step-head .operations .params-back .back-tip{height: 100%; color: #51b1fe;}.jimu-widget-chart .chart-params{left: 100%;}.jimu-widget-chart .chart-params-head .operations .apply{cursor: pointer; height: 100%; color: #51b1fe;}.jimu-widget-chart .params-container{position: absolute; width: 100%; left: 0; top: 40px; bottom: 0; overflow-y: auto;}.jimu-widget-chart .chart-params table.current-view{width: auto; border-collapse: collapse; margin-top: 10px;}.jimu-widget-chart .chart-params table.current-view td{vertical-align: top;}.jimu-widget-chart .chart-params .draw-graphic{margin-top: 5px;}.jimu-widget-chart .chart-params .select-spatial{margin-left: 7px; margin-top: 7px;}.jimu-rtl .jimu-widget-chart .chart-params .select-spatial{margin-left: 0; margin-right: 7px;}.jimu-widget-chart .chart-params .current-extent-td{padding-left: 8px;}.jimu-rtl .jimu-widget-chart .chart-params .current-extent-td{padding-left: 0; padding-right: 8px;}.jimu-widget-chart .chart-params .draw-graphic-tr td{padding-top: 5px;}.jimu-widget-chart .chart-params .draw-graphic-td{padding-left: 8px;}.jimu-rtl .jimu-widget-chart .chart-params .draw-graphic-td{padding-left: 0; padding-right: 8px;}.jimu-widget-chart .chart-results{left: 200%;}.jimu-widget-chart .chart-results .results-container{position: absolute; width: 100%; left: 0; top: 50px; bottom: 0; overflow-x: hidden; overflow-y: auto;}",
"*now":function(q){q(['dojo/i18n!*preload*widgets/Chart/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/query dojo/_base/html dojo/_base/array dojo/_base/fx dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidget jimu/dijit/Message jimu/dijit/DrawBox jimu/utils jimu/filterUtils esri/layers/FeatureLayer esri/renderers/SimpleRenderer esri/symbols/jsonUtils esri/request esri/graphicsUtils jimu/dijit/StatisticsChart ./Query jimu/LayerInfos/LayerInfos jimu/dijit/Popup jimu/dijit/LoadingShelter".split(" "),function(q,g,n,b,c,k,e,t,p,h,m,a,d,f,r,A,B,C,w,
x,u,y){return q([p,t],{name:"Chart",baseClass:"jimu-widget-chart",isValidConfig:!1,currentAttrs:null,tempResultLayer:null,previewArgs:null,previewPopup:null,layerInfosObj:null,_resetCurrentAttrs:function(){this.currentAttrs={chartTr:null,config:null,layerInfo:null}},postMixInProperties:function(){this.inherited(arguments);this.nls.colorful=this.nls.colorful||"Colorful";this.nls.monochromatic=this.nls.monochromatic||"Monochromatic";this.nls.clearResults=window.jimuNls.drawBox.clear;this.layerInfosObj=
u.getInstanceSync();this.config&&this._updateConfig()},_updateConfig:function(){this.config&&this.config.charts&&0<this.config.charts.length&&c.forEach(this.config.charts,g.hitch(this,function(a){this._rebuildFilter(a.url,a.filter)}))},_rebuildFilter:function(b,c){try{if(c){delete c.expr;var e=new d;e.isHosted=a.isHostedService(b);e.getExprByFilterObj(c)}}catch(l){console.log(l)}},postCreate:function(){this.inherited(arguments);a.combineRadioCheckBoxWithLabel(this.cbxUseSpatial,this.labelUseSpatial);
a.combineRadioCheckBoxWithLabel(this.cbxUseMapExtent,this.labelUseMapExtent);a.combineRadioCheckBoxWithLabel(this.cbxDrawGraphic,this.labelDrawGraphic);this._initDrawBox();this._initPreview();this._initSelf()},onOpen:function(){this.tempResultLayer&&this.tempResultLayer.show()},onDeActive:function(){this.drawBox.deactivate()},onClose:function(){this.tempResultLayer&&this.tempResultLayer.hide();this._hideInfoWindow();this.drawBox.clear();this.inherited(arguments)},resize:function(){var a="BoxTheme"===
this.appConfig.theme.name?1100:100;setTimeout(g.hitch(this,function(){this._updatePreviewHeight();this.preview.resize()}),a)},destroy:function(){this._clickClearButton(!0);this.inherited(arguments)},_isConfigValid:function(){return this.config&&"object"===typeof this.config},_initDrawBox:function(){this.drawBox=new m({types:["point","polyline","polygon"],map:this.map,showClear:!0,keepOneGraphic:!0});this.drawBox.placeAt(this.drawBoxDiv);this.drawBox.startup()},_createBigPreview:function(){if(this.previewArgs){var a=
document.body.clientWidth-40,b=document.body.clientHeight-40;if(!(100>a||100>b)){var c=this._getDefaultFontColor(),d=0;this.preview&&0<=this.preview.currentChartIndex&&(d=this.preview.currentChartIndex);var e=new w({map:this.map,fontColor:c,isBigPreview:!0,showSettingIcon:!0,showZoomIcon:!1,zoomToFeaturesWhenClick:!0,initialChartIndex:d,style:"width:100%;height:100%;"});this.previewPopup=new y({width:a,height:b,titleLabel:this.nls._widgetLabel,content:e,onClose:g.hitch(this,function(){e.destroy();
this.previewPopup=e=null})});setTimeout(g.hitch(this,function(){e.createClientCharts(this.preview.featureLayer,this.preview.features,this.preview.config)}),100)}}},_initPreview:function(){var a=this._getDefaultFontColor();this.preview=new w({map:this.map,fontColor:a,isBigPreview:!1,showSettingIcon:!0,showZoomIcon:!0,zoomToFeaturesWhenClick:!0});this.preview.placeAt(this.resultsContainer);this.preview.startup();this.own(e(this.preview,"zoomin",g.hitch(this,this._createBigPreview)))},_getDefaultFontColor:function(){var a=
"#333333";"DashboardTheme"!==this.appConfig.theme.name||"default"!==this.appConfig.theme.styles[0]&&"style3"!==this.appConfig.theme.styles[0]?"DartTheme"===this.appConfig.theme.name&&(a="#fff"):a="#fff";return a},_initSelf:function(){var d="Chart_"+a.getRandomString();this.cbxUseMapExtent.name=d;this.cbxDrawGraphic.name=d;(this.isValidConfig=this._isConfigValid())?(d=this.config.charts,0===d.length?(b.setStyle(this.chartsNode,"display","none"),b.setStyle(this.noChartTipSection,"display","block")):
c.forEach(d,g.hitch(this,function(c,d){var e=c.name,f=b.toDom('\x3ctr class\x3d"single-chart jimu-table-row"\x3e\x3ctd class\x3d"first-td"\x3e\x3c/td\x3e\x3ctd class\x3d"second-td"\x3e\x3cdiv class\x3d"chart-name-div"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"third-td"\x3e\x3cdiv class\x3d"arrow"\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e');n(".chart-name-div",f)[0].innerHTML=a.stripHTML(e);b.place(f,this.chartsTbody);f.singleConfig=c;0===d%2?b.addClass(f,"even"):b.addClass(f,"odd")}))):(b.setStyle(this.chartsNode,
"display","none"),b.setStyle(this.invalidConfigNode,{display:"block",left:0}))},_clickClearButton:function(a){this._hideInfoWindow();this.drawBox.clear();this._removeTempResultLayer();this._clearResultPage();a||this._fromCurrentPageToChartList()},_slide:function(a,c,d){b.setStyle(a,"display","block");b.setStyle(a,"left",c+"%");k.animateProperty({node:a,properties:{left:{start:c,end:d,units:"%"}},duration:500,onEnd:g.hitch(this,function(){b.setStyle(a,"left",d);0===d?b.setStyle(a,"display","block"):
b.setStyle(a,"display","none")})}).play()},_onChartListClicked:function(c){if(c=a.getAncestorDom(c.target||c.srcElement,g.hitch(this,function(a){return b.hasClass(a,"single-chart")}),10)){var d=c.singleConfig;this._resetCurrentAttrs();this.currentAttrs.chartTr=c;this.currentAttrs.config=g.clone(d);this.currentAttrs.layerInfo=this.currentAttrs.chartTr.layerInfo;n("tr.single-chart",this.chartsTbody).removeClass("jimu-state-active");b.addClass(this.currentAttrs.chartTr,"jimu-state-active");var e=g.hitch(this,
function(){this.currentAttrs.layerInfo=this.currentAttrs.chartTr.layerInfo;this._fromChartListToChartParams()});this.currentAttrs.chartTr.layerInfo?e():(c=this.currentAttrs.config.url,this.shelter.show(),B({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(a){this.domNode&&(this.shelter.hide(),this.currentAttrs.chartTr.layerInfo=a,this.currentAttrs.layerInfo=this.currentAttrs.chartTr.layerInfo,e())}),g.hitch(this,function(a){console.error(a);if(this.domNode){this.shelter.hide();
var b="";a&&403===a.httpCode&&(b=this.nls.noPermissionsMsg);this._showQueryErrorMsg(b)}})))}},_fromCurrentPageToChartList:function(){b.setStyle(this.chartList,"display","block");"block"===b.getStyle(this.chartParams,"display")?(this._slide(this.chartList,-100,0),this._slide(this.chartParams,0,100)):"block"===b.getStyle(this.chartResults,"display")&&(this._slide(this.chartList,-100,0),this._slide(this.chartResults,0,100))},_onCbxUseSpatialClicked:function(){this.cbxUseSpatial.checked?b.setStyle(this.selectSpatialDiv,
"display","block"):b.setStyle(this.selectSpatialDiv,"display","none");this.cbxUseMapExtent.checked?this._onCbxUseMapExtentClicked():this._onCbxDrawGraphicClicked();this._resetDrawBox()},_onCbxUseMapExtentClicked:function(){this.cbxUseMapExtent.checked&&(this._resetDrawBox(),b.setStyle(this.drawBoxDiv,"display","none"))},_onCbxDrawGraphicClicked:function(){this.cbxDrawGraphic.checked&&b.setStyle(this.drawBoxDiv,"display","block")},_onBtnClearAllClicked:function(){0!==this.chartsTbody.childElementCount&&
this._clickClearButton("none"!==this.chartList.style.display)},_resetDrawBox:function(){this.drawBox.deactivate();this.drawBox.clear()},_resetChartParamsPage:function(){this.cbxUseSpatial.checked=!1;this._onCbxUseSpatialClicked();this._resetDrawBox()},_fromChartListToChartParams:function(){this._resetChartParamsPage();var a=this.chartParams,c=this.chartResults;b.setStyle(this.chartList,{left:0,display:"block"});b.setStyle(a,{left:"100%",display:"block"});b.setStyle(c,"display","none");this._slide(this.chartList,
0,-100);this._slide(a,100,0)},_onBtnParamsBackClicked:function(){this._resetDrawBox();b.setStyle(this.chartList,"display","block");b.setStyle(this.chartParams,"display","block");b.setStyle(this.chartResults,"display","none");this._slide(this.chartList,-100,0);this._slide(this.chartParams,0,100)},_onBtnApplyClicked:function(){this._clearResultPage();var a=this.currentAttrs.config.filter.expr,d=null;if(this.cbxUseSpatial.checked){if(this.cbxUseMapExtent.checked)d=this.map.extent;else{var e=this.drawBox.drawLayer.graphics;
0<e.length&&(d=e[0].geometry)}if(!d){new h({message:this.nls.specifySpatialFilterMsg});return}}this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null;this._createChartResultLayer();this._resetDrawBox();b.setStyle(this.chartList,"display","none");b.setStyle(this.chartParams,"display","block");b.setStyle(this.chartResults,"display","block");this._slide(this.chartParams,0,-100);this._slide(this.chartResults,100,0);var f=this.currentAttrs.config,e=[],k=f.mode;"feature"===
k?(e=g.clone(f.valueFields),0>e.indexOf(f.labelField)&&e.push(f.labelField)):"category"===k?(e=g.clone(f.valueFields),0>e.indexOf(f.categoryField)&&e.push(f.categoryField)):"count"===k?e=[f.categoryField]:"field"===k&&(e=g.clone(f.valueFields));this.shelter.show();(k=this._getBaseExpression(this.currentAttrs.config.webMapLayerId))&&(a="("+k+") AND ("+a+")");this._query(a,e,d).then(g.hitch(this,function(a){if(this.domNode&&(this.shelter.hide(),0<a.status)){var b={featureLayer:this.tempResultLayer,
features:a.features,config:f};this.previewArgs=b;this._updatePreviewHeight();this.preview.createClientCharts(b.featureLayer,b.features,b.config);c.forEach(a.features,g.hitch(this,function(a){this.tempResultLayer.add(a)}));this._zoomToLayer(this.tempResultLayer)}}),g.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),this._removeTempResultLayer())}))},_getBaseExpression:function(a){var b="";if(a){var c=null;(c="Table"===this.currentAttrs.layerInfo.type?this.layerInfosObj.getTableInfoById(a):
this.layerInfosObj.getLayerInfoById(a))&&(b=c.getFilter())}return b},_updatePreviewHeight:function(){var a=b.getContentBox(this.domNode);b.setStyle(this.preview.domNode,"height",Math.max(a.h-120,150)+"px")},_createChartResultLayer:function(){this._removeTempResultLayer();var a=g.clone(this.currentAttrs.layerInfo);a.drawingInfo||(a.drawingInfo={});a.drawingInfo.transparency=0;a.minScale=0;a.maxScale=0;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.defaultVisibility=!0;delete a.extent;this.tempResultLayer=
new f({layerDefinition:a,featureSet:null});this.map.addLayer(this.tempResultLayer);a=A.fromJson(this.currentAttrs.config.symbol);a=new r(a);this.tempResultLayer.setRenderer(a)},_removeTempResultLayer:function(){this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null},_query:function(a,b,c){a||(a="1\x3d1");var d={};d.url=this.currentAttrs.config.url;d.layerInfo=this.currentAttrs.layerInfo;d.limit=1E4;d.spatialReference=this.map.spatialReference;d.where=a;d.geometry=
c;d.outFields=b;return(new x(d)).getFeatures()},_clearResultPage:function(){this.previewPopup&&(this.previewPopup.close(),this.previewPopup=null);this.previewArgs=null;this.preview.clear();this._hideInfoWindow()},_zoomToLayer:function(a){try{var b=c.filter(a.graphics,function(a){return!!a.geometry});if(0<b.length){var d=C.graphicsExtent(b);d&&(d=d.expand(1.4),this.map.setExtent(d))}}catch(l){console.error(l)}},_showQueryErrorMsg:function(a){new h({message:a||this.nls.queryError})},_hideInfoWindow:function(){},
_onBtnResultsBackClicked:function(){var a;a=this.chartParams;b.setStyle(this.chartList,"display","none");b.setStyle(a,{display:"block",left:"-100%"});this._slide(a,-100,0);this._slide(this.chartResults,0,100)}})});