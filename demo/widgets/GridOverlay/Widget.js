// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/GridOverlay/lib/GridOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array ./mgrs-utils esri/layers/GraphicsLayer esri/Color xstyle/css!./GridOverlay.css".split(" "),function(h,d,c,p,l,b){Math.log10||(Math.log10=function(a){return Math.log(a)/Math.LN10});return h(null,{minIntervalSpacing:150,currentInterval:0,levelOfDetail:"default",labelPlacement:null,verticalLabels:!0,cornerLabelXOffset:10,cornerLabelYOffset:10,intervalLabelXOffset:30,intervalLabelYOffset:30,
colors:null,lineWidths:null,fontSizes:null,lineOpacity:.8,labelOpacity:1,centerLabelOpacity:.4,centerLabelScaleFactor:3,fontFamily:"Arial, Helvetica, sans-serif",map:null,_lineGraphics:null,_labelGraphics:null,_isIE:!1,_isIE11:!1,constructor:function(a){a=a||{};a.map||console.warn("Before the grid will draw, you must use the 'setMap' method to define which map object to draw on");a.hasOwnProperty("enabled")?this.enabled=a.enabled:this.enabled=!0;this._lineGraphicsLayer=new l;this._labelGraphicsLayer=
new l({className:"gridOverlay"});this._centerLabelGraphicsLayer=new l({className:"gridOverlay"});this.enable=d.hitch(this,this.enable);this.disable=d.hitch(this,this.disable);this.clearGrid=d.hitch(this,this.clearGrid);this.drawGrid=d.hitch(this,this.drawGrid);this.getLayers=d.hitch(this,function(){return[this._lineGraphicsLayer,this._labelGraphicsLayer,this._centerLabelGraphicsLayer]});this.labelPlacement={lowerLeft:!0,lowerRight:!0,upperLeft:!0,upperRight:!0,center:!0};this.colors="#FA5858 #F7FE2E #2EFE2E #2EFEF7 #FFF #BDBDBD #000".split(" ");
this.lineWidths=[3,2,1,1,1,1,1];this.fontSizes=[29,27,19,16,15,13,11];this.map=a.map||{};this._lineGraphics=[];this._labelGraphics=[];this._lineGraphicsLayer.setOpacity(this.lineOpacity);this._labelGraphicsLayer.setOpacity(this.labelOpacity);this._centerLabelGraphicsLayer.setOpacity(this.centerLabelOpacity);for(var f=0;f<this.colors.length;f++)this.colors[f]=new b(this.colors[f]);this.setProperties(a);this._isIE=0<window.navigator.userAgent.indexOf("MSIE")?!0:!1;this._isIE11=0<window.navigator.userAgent.indexOf("Trident")?
!0:!1},setProperties:function(a){a.lineWidths&&this.setLineWidths(a.lineWidths);a.minIntervalSpacing&&this.setMinIntervalSpacing(a.minIntervalSpacing);a.levelOfDetail&&this.setLevelOfDetail(a.levelOfDetail);a.labelPlacement&&this.setLabelPlacement(a.labelPlacement);a.hasOwnProperty("verticalLabels")&&this.setVerticalLabels(a.verticalLabels);a.cornerLabelXOffset&&this.setCornerLabelXOffset(a.cornerLabelXOffset);a.cornerLabelYOffset&&this.setCornerLabelYOffset(a.cornerLabelYOffset);a.intervalLabelXOffset&&
this.setIntervalLabelXOffset(a.intervalLabelXOffset);a.intervalLabelYOffset&&this.setIntervalLabelYOffset(a.intervalLabelYOffset);a.colors&&this.setColors(a.colors);a.lineWidths&&this.setLineWidths(a.lineWidths);a.fontSizes&&this.setFontSizes(a.fontSizes);a.lineOpacity&&this.setLineOpacity(a.lineOpacity);a.labelOpacity&&this.setLabelOpacity(a.labelOpacity);a.centerLabelOpacity&&this.setCenterLabelOpacity(a.centerLabelOpacity);a.centerLabelScaleFactor&&this.setCenterLabelScaleFactor(a.centerLabelScaleFactor);
a.fontFamily&&this.setFontFamily(a.fontFamily);if(this.enabled&&this.map.loaded)this.enable();else if(this.enabled&&this.map.on)this.map.on("load",d.hitch(this,this.enable))},getMinIntervalSpacing:function(){return this.minIntervalSpacing},setMinIntervalSpacing:function(a){"number"===typeof a&&(this.minIntervalSpacing=a,this.drawGrid())},setLevelOfDetail:function(a){if("string"!==typeof a)return null;a=a.toLowerCase();switch(a){case "more":case "best":case "high":case "maximum":case "max":this.levelOfDetail=
"more";break;case "less":case "low":case "minimum":case "mim":this.levelOfDetail="less";break;default:this.levelOfDetail="default"}this.drawGrid()},getLevelOfDetail:function(){return this.levelOfDetail},getLabelPlacement:function(){return this.labelPlacement},setLabelPlacement:function(a,b){if("object"===typeof a&&a.length){this.labelPlacement={lowerLeft:!1,lowerRight:!1,upperLeft:!1,upperRight:!1,center:!1};for(var f=0;f<a.length;f++)this.setLabelPlacement(a[f],!0)}else if("object"===typeof a)this.labelPlacement=
a;else if("undefined"===typeof b?(this.labelPlacement={lowerLeft:!1,lowerRight:!1,upperLeft:!1,upperRight:!1,center:!1},b=!0):"boolean"!==typeof b&&(b=b=!0),a.toLowerCase){switch(a.toLowerCase()){case "center":case "middle":this.labelPlacement.center=b;break;case "top":case "upper":this.labelPlacement.upperLeft=b;this.labelPlacement.upperRight=b;break;case "bottom":case "lower":this.labelPlacement.lowerLeft=b;this.labelPlacement.lowerRight=b;break;case "left":this.labelPlacement.lowerLeft=b;this.labelPlacement.upperLeft=
b;break;case "right":this.labelPlacement.lowerRight=b;this.labelPlacement.upperRight=b;break;case "lower-left":case "bottom-left":this.labelPlacement.lowerLeft=b;break;case "upper-left":case "top-left":this.labelPlacement.upperLeft=b;break;case "lower-right":case "bottom-right":this.labelPlacement.lowerRight=b;break;case "upper-right":case "top-right":this.labelPlacement.upperRight=b;break;case "all":this.labelPlacement.lowerLeft=b;this.labelPlacement.lowerRight=b;this.labelPlacement.upperLeft=b;
this.labelPlacement.upperRight=b;this.labelPlacement.center=b;break;default:this.labelPlacement.lowerLeft=b,this.labelPlacement.lowerRight=b,this.labelPlacement.upperLeft=b,this.labelPlacement.upperRight=b}this.drawGrid()}},getVerticalLabels:function(){return this.verticalLabels},setVerticalLabels:function(a){"boolean"===typeof a&&(this.verticalLabels=a,this.drawGrid())},getCornerLabelXOffset:function(){return this.cornerLabelXOffset},setCornerLabelXOffset:function(a){"number"===typeof a&&(this.cornerLabelXOffset=
a,this.drawGrid())},getCornerLabelYOffset:function(){return this.cornerLabelYOffset},setCornerLabelYOffset:function(a){"number"===typeof a&&(this.cornerLabelYOffset=a,this.drawGrid())},getIntervalLabelXOffset:function(){return this.intervalLabelXOffset},setIntervalLabelXOffset:function(a){"number"===typeof a&&(this.intervalLabelXOffset=a,this.drawGrid())},getIntervalLabelYOffset:function(){return this.intervalLabelYOffset},setIntervalLabelYOffset:function(a){"number"===typeof a&&(this.intervalLabelYOffset=
a,this.drawGrid())},getColor:function(a){return"number"!==typeof a||0>a||a>this.colors.length-1?null:this.colors[a]},setColor:function(a,f){if("number"!==typeof a||0>a||a>this.colors.length-1)return null;this.colors[a]=new b(f);this.drawGrid()},setColors:function(a){if("object"!==typeof a||!a.length)return null;for(var f,e=0;e<this.colors.length;e++)f=a.length>e?e:a.length-1,this.colors[e]=new b(a[f]);this.drawGrid()},getLineWidth:function(a){return"number"!==typeof a||0>a||a>this.lineWidths.length-
1?null:this.lineWidths[a]},setLineWidth:function(a,b){if("number"!==typeof a||"number"!==typeof b||0>a||a>this.lineWidths.length-1)return null;this.lineWidths[a]=b;this.drawGrid()},setLineWidths:function(a){if("object"!==typeof a||!a.length)return null;for(var b,e=0;e<this.lineWidths.length;e++)b=a.length>e?e:a.length-1,"number"===typeof a[b]&&(this.lineWidths[e]=a[b]);this.drawGrid()},getFontSize:function(a){return"number"!==typeof a||0>a||a>this.fontSizes.length-1?null:this.fontSizes[a]},setFontSize:function(a,
b){if("number"!==typeof a||"number"!==typeof b||0>a||a>this.fontSizes.length-1)return null;this.fontSizes[a]=b;this.drawGrid()},setFontSizes:function(a){if("object"!==typeof a||!a.length)return null;for(var b,e=0;e<this.fontSizes.length;e++)b=a.length>e?e:a.length-1,"number"===typeof a[b]&&(this.fontSizes[e]=a[b]);this.drawGrid()},getCenterLabelScaleFactor:function(){return this.centerLabelScaleFactor},setCenterLabelScaleFactor:function(a){"number"===typeof a&&(this.centerLabelScaleFactor=a,this.drawGrid())},
getCenterLabelOpacity:function(){return this.centerLabelOpacity},setCenterLabelOpacity:function(a){"number"===typeof a&&(this.centerLabelOpacity=a,this._centerLabelGraphicsLayer.setOpacity(a),this.drawGrid())},getFontFamily:function(){return this.fontFamily},setFontFamily:function(a){"string"===typeof a&&(this.fontFamily=a,this.drawGrid())},getInterval:function(){return this.currentInterval},setInterval:function(){this.currentInterval=p.getInterval(this.getMinIntervalSpacing(),this.map,this.getLevelOfDetail())},
getMap:function(){return this.map},setMap:d.hitch(this,function(a){this.map.loaded&&this.clearGrid();this.map=a;if(this.enabled&&this.map.loaded)this.enable();else if(this.enabled)this.map.on("load",d.hitch(this,this.enable))}),getLineOpacity:function(){return this.lineOpacity},setLineOpacity:function(a){"number"===typeof a&&(this.lineOpacity=a,this._lineGraphicsLayer.setOpacity(a))},getLabelOpacity:function(){return this.labelOpacity},setLabelOpacity:function(a){"number"===typeof a&&(this.labelOpacity=
a,this._labelGraphicsLayer.setOpacity(a))},getSettings:function(){return{minIntervalSpacing:this.minIntervalSpacing,levelOfDetail:this.levelOfDetail,labelPlacement:this.labelPlacement,verticalLabels:this.verticalLabels,cornerLabelXOffset:this.cornerLabelXOffset,cornerLabelYOffset:this.cornerLabelYOffset,intervalLabelXOffset:this.intervalLabelXOffset,intervalLabelYOffset:this.intervalLabelYOffset,colors:c.map(this.colors,function(a){return a.toHex()}),lineWidths:this.lineWidths,fontSizes:this.fontSizes,
lineOpacity:this.lineOpacity,labelOpacity:this.labelOpacity,centerLabelOpacity:this.centerLabelOpacity,centerLabelScaleFactor:this.centerLabelScaleFactor,fontFamily:this.fontFamily}},enable:function(){var a=this.getMap();this.enabled=!0;a.addLayers(this.getLayers());this._drawEvent=a.on("extent-change",d.hitch(this,function(){this._drawGrid()}));this._drawGrid()},disable:function(){var a=this.getMap();this.enabled=!1;this._drawEvent&&(this._drawEvent.remove(),this._drawEvent=null);this.clearGrid();
for(var b=this.getLayers(),e=0;e<b.length;e++)a.removeLayer(b[e])},clearGrid:function(){var a=this.getMap();if(!a.loaded)var b=a.on("load",d.hitch(this,function(){b.remove();this.clearGrid()}));this._lineGraphicsLayer.clear();this._labelGraphicsLayer.clear();this._centerLabelGraphicsLayer.clear();this._lineGraphics=[];this._labelGraphics=[];this._centerLabelGraphics=[]},drawGrid:function(){this._drawing&&this._drawGrid()},_drawGrid:function(){var a=this.getMap(),b,e;this._drawing&&clearTimeout(this._drawing);
this._drawing=setTimeout(d.hitch(this,function(){if(a.loaded&&this.enabled){e=p.zonesFromExtent(this);this._zoneCount=e.length;this.clearGrid();this.setInterval();this._lineGraphics=[];this._lineGraphics0=[];this._lineGraphics1=[];this._lineGraphics2=[];this._lineGraphics3=[];this._lineGraphics4=[];this._lineGraphics5=[];p.processZonePolygons(e,this);for(b=0;b<this._centerLabelGraphics.length;b++)this._centerLabelGraphicsLayer.add(this._centerLabelGraphics[b]);c.forEach([this._lineGraphics5,this._lineGraphics4,
this._lineGraphics3,this._lineGraphics2,this._lineGraphics1,this._lineGraphics0],function(a){this._lineGraphics=this._lineGraphics.concat(a)},this);for(b=0;b<this._lineGraphics.length;b++)this._lineGraphicsLayer.add(this._lineGraphics[b]);for(b=0;b<this._labelGraphics.length;b++){this._labelGraphicsLayer.add(this._labelGraphics[b]);var f=this._labelGraphics[b].getNode();if(f){var d=this._labelGraphics[b].symbol.color,d=128<.2126*d.r+.7152*d.g+.0722*d.b?"black":"white";this._isIE||this._isIE11?f.className+=
" text-symbol-halo-"+d:f.classList.add("text-symbol-halo-"+d)}}delete this._lineGraphics;delete this._lineGraphics0;delete this._lineGraphics1;delete this._lineGraphics2;delete this._lineGraphics3;delete this._lineGraphics4;delete this._lineGraphics5}}),50)}})})},"widgets/GridOverlay/lib/mgrs-utils":function(){define("dojo/json ./constants ./geometry-utils ./labeling-utils ./mgrs ./NonPolarGridZone ./VisibleGridZone ./GridPolygon esri/geometry/geometryEngine esri/graphic esri/geometry/Point esri/geometry/Polyline esri/geometry/Polygon esri/symbols/SimpleLineSymbol esri/symbols/TextSymbol esri/symbols/Font esri/Color".split(" "),
function(h,d,c,p,l,b,a,f,e,m,k,g,C,z,u,D,H){return{_ZonesDictionary:function(){var a,f,e,c="CDEFGHJKLMNPQRSTUVWX".split(""),g={};for(a=1;60>=a;a++)for(f=0;f<c.length;f++){var l=e=e=void 0,k=void 0,p=void 0,m=a+c[f];"32X"===m||"34X"===m||"36X"===m?e=null:("31V"===m?e={xmin:0,ymin:56,xmax:3,ymax:64,id:m}:"32V"===m?e={xmin:3,ymin:56,xmax:12,ymax:64,id:m}:"31X"===m?e={xmin:0,ymin:72,xmax:9,ymax:84,id:m}:"33X"===m?e={xmin:9,ymin:72,xmax:21,ymax:84,id:m}:"35X"===m?e={xmin:21,ymin:72,xmax:33,ymax:84,id:m}:
"37X"===m?e={xmin:33,ymin:72,xmax:42,ymax:84,id:m}:(e=(a-1)*d.ZONE_WIDTH_DEGREES-180,l=a*d.ZONE_WIDTH_DEGREES-180,k=f*d.ZONE_HEIGHT_DEGREES+d.MIN_MGRS_LATITUDE,p=(f+1)*d.ZONE_HEIGHT_DEGREES+d.MIN_MGRS_LATITUDE,e=180===e?d.POSITIVE_180:e,e=-180===e?d.NEGATIVE_180:e,l=180===l?d.POSITIVE_180:l,l=-180===l?d.NEGATIVE_180:l,80===p&&(p=d.MAX_MGRS_LATITUDE),e={xmin:e,ymin:k,xmax:l,ymax:p,id:m}),e=new b(e));e&&(g[e.id]=e)}return g}(),getInterval:function(a,b,e){var f,c,g,d=0;f=b.getResolutionInMeters()*a;
c=b.extent.getCenter();g=b.toMap(b.toScreen(c).offset(0,a/2));for(f=b.toMap(b.toScreen(c).offset(0,-a/2));84<=g.getLatitude()||84<=f.getLatitude();)d++,g=b.toMap(b.toScreen(c).offset(0,a/2+d*a)),f=b.toMap(b.toScreen(c).offset(0,-a/2+d*a));for(;-80>=g.getLatitude()||-80>=f.getLatitude();)d++,g=b.toMap(b.toScreen(c).offset(0,a/2-d*a)),f=b.toMap(b.toScreen(c).offset(0,-a/2-d*a));a=g.getLatitude();b=g.getLongitude();g=f.getLatitude();d=f.getLongitude();f=l.getZoneNumber(a,b);f=Math.abs(l.LLtoUTM(a,b,
f)[1]-l.LLtoUTM(g,d,f)[1]);a=Math.log10(f);switch(e){case "more":e=Math.floor(a);break;case "less":case "strict":e=Math.ceil(a);break;default:e=Math.round(a)}e=Math.pow(10,e);f>2*e&&(e*=10);return 1E5<e?!1:e},zonesFromExtent:function(b){var f,l,m,p,E,I,u,z,t,D,x,q;l=b.map.extent;var w=l.spatialReference.isWebMercator()?d.WEBMERCATOR_360:d.GEOGRAPHIC_360,r={xOffset:b.getCornerLabelXOffset(),yOffset:b.getCornerLabelYOffset(),rotation:0,color:b.getColor(0),fontFamily:b.getFontFamily(),fontSize:b.getFontSize(0)},
v="CDEFGHJKLMNPQRSTUVWX".split(""),y=[];if(l.xmax-l.xmin>w)return y;var w=c.extentToPolygon(l),w=c.toWebMercator(w),A=c.pointToGeographic(new k([l.xmin,l.ymin],l.spatialReference)),F=c.pointToGeographic(new k([l.xmax,l.ymax],l.spatialReference));l=A.y;p=F.y;x=A.offsetX;q=F.offsetX;for(var B=x;B<=q;B++)for(f=B>x?d.NEGATIVE_180:A.x,m=B<q?d.POSITIVE_180:F.x,E=Math.min(Math.max(Math.floor((l+80)/d.ZONE_HEIGHT_DEGREES),0),19),I=Math.min(Math.floor((p+80)/d.ZONE_HEIGHT_DEGREES),19),f=Math.floor((f+180)/
d.ZONE_WIDTH_DEGREES),m=Math.min(Math.floor((m+180)/d.ZONE_WIDTH_DEGREES)+2,60);f<=m;f++)for(var H=E;H<=I;H++)if(u=v[H],u=f+u,this._ZonesDictionary[u]){z=h.parse(h.stringify(this._ZonesDictionary[u]._rings));for(t=0;t<z[0].length;t++)z[0][t][0]+=B*d.GEOGRAPHIC_360;t=new C({rings:z});D=new g({paths:z});if(z=e.intersect(c.toWebMercator(t),w))t=e.intersect(c.toWebMercator(D),w),y.push(new a({map:b.map,polyline:t,polygon:z,offset:B,nonPolarGridZone:this._ZonesDictionary[u],labelParameters:r}))}return y},
processZonePolygons:function(a,b){for(var f={},g=b.getInterval(),d=0;d<a.length;d++){var k=a[d];k&&(this.handleZonePolygon(k,b),g&&(f[k.nonPolarGridZone.utmZone]?f[k.nonPolarGridZone.utmZone].polygon=e.union([c.toWebMercator(k.polygon),f[k.nonPolarGridZone.utmZone].polygon]):f[k.nonPolarGridZone.utmZone]={polygon:c.toWebMercator(k.polygon),offset:k.offset}))}if(g)for(d=Object.keys(f),k=0;k<d.length;k++){var m=d[k],p=f[m].polygon,E=f[m].offset,t=c.toGeographic(p.getExtent()),h=l.LLtoUTM(t.ymin,t.xmin,
m),u=l.LLtoUTM(t.ymin,t.xmax,m),q=l.LLtoUTM(t.ymax,t.xmax,m),t=l.LLtoUTM(t.ymax,t.xmin,m),m={minE:Math.min(h[0],u[0],q[0],t[0]),maxE:Math.max(h[0],u[0],q[0],t[0]),minN:Math.min(h[1],u[1],q[1],t[1]),maxN:Math.max(h[1],u[1],q[1],t[1]),utmZone:m,polygon:p,offset:E,grid:b};this.handle100kGrids(m);1E5>g&&this.handleIntervals(m)}},handleZonePolygon:function(a,b){var f,e,g;f=a.polyline;e=b.getColor(0);g=b.getLineWidth(0);b._lineGraphics0.push(new m(f,new z(z.STYLE_SOLID,new H(e),g)));if(!(4>b.map.getZoom()))if(5>=
b.map.getZoom())b._labelGraphics.push(a.getCenterLabel());else for(f=a.getLabels(),e=0;e<f.length;e++)b._labelGraphics.push(f[e])},handle100kGrids:function(a){var b=a.polygon,g=a.offset,k=a.utmZone,p=a.minE,E=a.maxE,h=a.minN,u=a.maxN;a=a.grid;for(var D=a.getColor(1),t=a.getLineWidth(1),J=a.getMap(),x,q,w,r,v,h=1E5*Math.floor(h/1E5);h<u;h+=1E5)for(x=1E5*Math.floor(p/1E5);x<E;x+=1E5){v=l.findGridLetters(k,0>h+5E4?1E7+(h+5E4):h+5E4,x+5E4);w=[];for(q=x;q<=x+1E5;q+=1E4)r=l.UTMtoLL(h,q,k),w.push([r.lon,
r.lat]);for(q=h;q<h+1E5;q+=1E4)r=l.UTMtoLL(q,x+1E5,k),w.push([r.lon,r.lat]);for(q=x+1E5;q>=x;q-=1E4)r=l.UTMtoLL(h+1E5,q,k),w.push([r.lon,r.lat]);for(q=h+1E5;q>=h;q-=1E4)r=l.UTMtoLL(q,x,k),w.push([r.lon,r.lat]);for(q=0;q<w.length;q++)w[q][0]+=g*d.GEOGRAPHIC_360;w=new C([w]);q=c.polygonToPolyline(w);r=e.intersect(c.toWebMercator(w),c.toWebMercator(b));q=e.intersect(c.toWebMercator(q),c.toWebMercator(b));if(r&&(v={clippedPolygon:r,unclippedPolygon:w,map:J,xmin:x%1E6,ymin:h%1E6,xmax:(x+1E5)%1E6,ymax:(h+
1E5)%1E6,minMaxType:"utm",utmZone:k,text:v,labelParameters:{xOffset:10,yOffset:10,rotation:0,color:a.getColor(1),fontFamily:a.getFontFamily(),fontSize:a.getFontSize(1)}},v=new f(v),!(7>a.map.getZoom())))for(v=9>J.getZoom()?[v.getCenterLabel(!0)]:v.getLabels(),q&&a._lineGraphics1.push(new m(q,new z(z.STYLE_SOLID,new H(D),t))),q=0;q<v.length;q++)a._labelGraphics.push(v[q])}},handleIntervals:function(a){var b=a.polygon,f=a.utmZone,h=a.offset,C=a.minE,E=a.maxE,I=a.minN,M=a.maxN;a=a.grid;var N=a.getFontFamily(),
t=a.getIntervalLabelXOffset(),J=a.getIntervalLabelYOffset(),x=a.getInterval(),q=a.getMap(),w=a.getVerticalLabels(),r,v,y,A,F,B,K,G,n,L;for(r=Math.floor(I/x)*x;r<=M;r+=x)if(0!==r%1E5){0===r%1E4?(y=2,A=a._lineGraphics2):0===r%1E3?(y=3,A=a._lineGraphics3):0===r%100?(y=4,A=a._lineGraphics4):(y=5,A=a._lineGraphics5);F=a.getColor(y);B=a.getLineWidth(y);y=a.getFontSize(y);K=new D(y,D.STYLE_NORMAL,D.VARIANT_NORMAL,D.WEIGHT_BOLD,N);n=[];v=l.UTMtoLL(r,C,f);G=l.UTMtoLL(r,E,f);for(v=0;v<E;v+=1E4)L=l.UTMtoLL(r,
C+v,f),n.push([L.lon,L.lat]);n.push([G.lon,G.lat]);for(v=0;v<n.length;v++)n[v][0]+=h*d.GEOGRAPHIC_360;if(G=e.intersect(c.toWebMercator(new g([n])),c.toWebMercator(b))){B=new m(G,new z(z.STYLE_SOLID,new H(F),B));A.push(B);A=p.padZero((0>I?1E7+r:r)%1E5/x,5-Math.log10(x));n=G.paths[0];v=new k({x:n[0][0]+.001,y:n[0][1],spatialReference:G.spatialReference});G=new k({x:n[n.length-1][0]-.001,y:n[n.length-1][1],spatialReference:G.spatialReference});B=p.screenDistanceBetweenPoints(v,G,q).horizontal;n=p.distanceFromMapEdge(v,
q).horizontal;if(2>n||200<n&&300<B)n=(new u(A)).setAngle(0).setColor(F).setOffset(t,-(y/1.333)/2).setAlign("start").setFont(K),n=new m(v,n),a._labelGraphics.push(n);n=p.distanceFromMapEdge(G,q).horizontal;if(2>n||200<n&&300<B)n=(new u(A)).setAngle(0).setColor(F).setOffset(-t,-(y/1.333)/2).setAlign("end").setFont(K),n=new m(G,n),a._labelGraphics.push(n)}}for(C=Math.floor(C/x)*x;C<=E;C+=x)if(0!==C%1E5){0===C%1E4?(y=2,A=a._lineGraphics2):0===C%1E3?(y=3,A=a._lineGraphics3):0===C%100?(y=4,A=a._lineGraphics4):
(y=5,A=a._lineGraphics5);F=a.getColor(y);B=a.getLineWidth(y);y=a.getFontSize(y);K=new D(y,D.STYLE_NORMAL,D.VARIANT_NORMAL,D.WEIGHT_BOLD,N);n=[];r=l.UTMtoLL(I-1E4,C,f);t=l.UTMtoLL(M+1E4,C,f);n.push([r.lon,r.lat]);n.push([t.lon,t.lat]);for(v=0;v<n.length;v++)n[v][0]+=h*d.GEOGRAPHIC_360;if(t=e.intersect(c.toWebMercator(new g([n])),c.toWebMercator(b))){r=new m(t,new z(z.STYLE_SOLID,new H(F),B));A.push(r);A=p.padZero(C%1E5/x,5-Math.log10(x));n=t.paths[0];r=new k({x:n[0][0],y:n[0][1]+.001,spatialReference:{wkid:102100}});
t=new k({x:n[n.length-1][0],y:n[n.length-1][1]-.001,spatialReference:{wkid:102100}});B=p.screenDistanceBetweenPoints(r,t,q).vertical;n=p.distanceFromMapEdge(r,q).vertical;if(2>n||200<n&&300<B)n=(new u(A)).setAngle(w?90:0).setColor(F).setOffset(w?-(y/1.333)/2:0,J).setAlign(w?"end":"middle").setFont(K),n=new m(r,n),a._labelGraphics.push(n);n=p.distanceFromMapEdge(t,q).vertical;if(2>n||200<n&&300<B)n=(new u(A)).setAngle(w?90:0).setColor(F).setOffset(w?-(y/1.333)/2:0,w?-J:-J-y/1.333).setAlign(w?"start":
"middle").setFont(K),n=new m(t,n),a._labelGraphics.push(n)}}}}})},"widgets/GridOverlay/lib/constants":function(){define([],function(){return{ZONE_WIDTH_DEGREES:6,ZONE_HEIGHT_DEGREES:8,MIN_MGRS_LATITUDE:-80,MAX_MGRS_LATITUDE:84,POSITIVE_180:179.99999999,NEGATIVE_180:-179.99999999,WEST_GEOGRAPHIC_LIMIT:-180,EAST_GEOGRAPHIC_LIMIT:180,GEOGRAPHIC_360:360,WEST_WEBMERCATOR_LIMIT:-2.0037508342789244E7,EAST_WEBMERCATOR_LIMIT:2.0037508342789244E7,WEBMERCATOR_360:4.007501668557849E7,DEGREES_PER_RADIAN:57.29577951308232,
RADIANS_PER_DEGREE:.017453292519943295,WGS84_EQUATORIAL_RADIUS:6378137,WGS84_HALF_EQUATORIAL_RADIUS:3189068.5,HALF_PI:1.5707963267948966}})},"widgets/GridOverlay/lib/geometry-utils":function(){define(["./constants","esri/geometry/webMercatorUtils","esri/geometry/Polyline","esri/geometry/Polygon"],function(h,d,c,p){return{toGeographic:function(c){return c.spatialReference.isWebMercator()?d.webMercatorToGeographic(c):c},toWebMercator:function(c){return c.spatialReference.isWebMercator()?c:d.geographicToWebMercator(c)},
_latitudeToWebMercatorY:function(c){return h.GEOGRAPHIC_360/2*(h.HALF_PI-2*Math.atan(Math.exp(-1*c/h.WGS84_EQUATORIAL_RADIUS)))/Math.PI},_longitudeToWebMercatorX:function(c){var b=h.GEOGRAPHIC_360,a=h.GEOGRAPHIC_360/2,f=h.WGS84_EQUATORIAL_RADIUS;return c/f*a/Math.PI-Math.floor((c/f*a/Math.PI+a)/b)*b},pointToGeographic:function(c){for(var b=c.x,a=c.y,f=(c=c.spatialReference.isWebMercator())?h.WEST_WEBMERCATOR_LIMIT:h.WEST_GEOGRAPHIC_LIMIT,e=c?h.EAST_WEBMERCATOR_LIMIT:h.EAST_GEOGRAPHIC_LIMIT,d=c?h.WEBMERCATOR_360:
h.GEOGRAPHIC_360,k=0;b<=f;)b+=d,--k;for(;b>e;)b-=d,k+=1;c&&(b=this._longitudeToWebMercatorX(b),a=this._latitudeToWebMercatorY(a));return{x:b,y:a,offsetX:k}},extentToPolygon:function(c){return new p({rings:[[[c.xmin,c.ymin],[c.xmax,c.ymin],[c.xmax,c.ymax],[c.xmin,c.ymax],[c.xmin,c.ymin]]],spatialReference:c.spatialReference})},polygonToPolyline:function(d){return new c({paths:d.rings,spatialReference:{wkid:d.spatialReference.wkid}})}}})},"widgets/GridOverlay/lib/labeling-utils":function(){define(["./mgrs",
"esri/geometry/Point"],function(h,d){var c=document.createElement("canvas").getContext("2d");return{getWidthOfText:function(d,l,b){c.font=b+"px "+l;return c.measureText(d).width},padZero:function(c,d){for(c=c.toString();c.length<d;)c="0"+c;return c},getScreenSize:function(c,l){var b=c.getExtent(),a=new d([b.xmin,b.ymin],b.spatialReference),b=new d([b.xmax,b.ymax],b.spatialReference),a=l.toScreen(a),b=l.toScreen(b);return{width:Math.abs(b.x-a.x),height:Math.abs(b.y-a.y)}},distanceFromMapEdge:function(c,
d){var b,a,f;a=d.toScreen(c);"undefined"===typeof h&&(h=!0);b=Math.min(Math.abs(d.width-a.x),Math.abs(a.x));a=Math.min(Math.abs(d.height-a.y),Math.abs(a.y));h&&(f=Math.round(1E4*c.getLatitude())/1E4,84===f||-80===f)&&(a=0);return{horizontal:b,vertical:a,total:Math.sqrt(b*b+a*a)}},screenDistanceBetweenPoints:function(c,d,b){c=b.toScreen(c);b=b.toScreen(d);d=Math.abs(c.x-b.x);c=Math.abs(c.y-b.y);return{horizontal:d,vertical:c,total:Math.sqrt(d*d+c*c)}}}})},"widgets/GridOverlay/lib/mgrs":function(){define(["esri/geometry/Point"],
function(h){var d,c,p;d=6378137;c=.00669437999;p=c/(1-c);var l=(1-Math.sqrt(1-c))/(1+Math.sqrt(1-c));return{setSpheroid:function(b){b=b.toUpperCase();switch(b){case "AIRY 1830":d=6377563.396;c=.00667053999998536;break;case "AIRY MODIFIED":d=6377340.189;c=.00667053999998536;break;case "AVERAGE TERRESTRIAL SYSTEM 1977":d=6378135;c=.00669438499958795;break;case "AUSTRALIAN NATIONAL":d=6378160;c=.00669454185458764;break;case "BESSEL 1841":d=6377397.155;c=.00667437223180214;break;case "BESSEL MODIFIED":d=
6377492.018;c=.00667437223180214;break;case "BESSEL NAMIBIA":d=6377483.865;c=.00667437223180214;break;case "CLARKE 1858":d=6378293.639;c=.00678514600473303;break;case "NAD27":case "CLARKE 1866":d=6378206.4;c=.00676865799760964;break;case "CLARKE 1866 MICHIGAN":d=6378450.047;c=.00676865830738507;break;case "CLARKE 1880":d=6378249.138;c=.00680348101883452;break;case "CLARKE 1880 (ARC)":d=6378249.145;c=.00680348101883452;break;case "CLARKE 1880 (BENOIT)":d=6378300.79;c=.00680348271028565;break;case "CLARKE 1880 (IGN)":d=
6378249.2;c=.00680348767623919;break;case "CLARKE 1880 (RGS)":d=6378249.145;c=.00680351128284906;break;case "CLARKE 1880 (SGA)":d=6378249.2;c=.00680348860198551;break;case "EVEREST 1830 (DEFINITION)":d=6377299.36;c=.00663784663019969;break;case "EVEREST 1830 (MODIFIED)":d=6377304.063;c=.00663784663019969;break;case "EVEREST (ADJUSTMENT 1937)":d=6377276.345;c=.00663784663019969;break;case "EVEREST (DEFINITION 1962)":d=6377301.243;c=.00663784606842344;break;case "EVEREST (DEFINITION 1967)":d=6377298.556;
c=.00663784663019969;break;case "EVEREST (DEFINITION 1975)":d=6377299.151;c=.00663784606842344;break;case "NAD83":case "GEM GRAVITY POTENTIAL MODEL":case "GRS 1980":d=6378137;c=.00669438002290079;break;case "GRS 1967 \x3d INTERNATIONAL 1967":d=6378160;c=.00669460532856765;break;case "HELMERT 1906":d=6378200;c=.00669342162296594;break;case "INDONESIAN NATIONAL":d=6378160;c=.0066946090804091;break;case "INTERNATIONAL 1924":d=6378388;c=.00672267002233332;break;case "INTERNATIONAL 1967":d=6378160;c=.00669454185458764;
break;case "KRASOVSKY 1940":d=6378245;c=.00669342162296594;break;case "TRANSIT PRECISE EPHEMERIS":d=6378145;c=.00669454185458764;break;case "OSU 1986 GEOIDAL MODEL":d=6378136.2;c=.00669438006997852;break;case "OSU 1991 GEOIDAL MODEL":d=6378136.3;c=.00669438006997852;break;case "PLESSIS 1817":d=6376523;c=.00646954373789485;break;case "STRUVE 1860":d=6378298.3;c=.00677435980080942;break;case "WAR OFFICE":d=6378300.583;c=.00674534331628926;break;case "NWL-10D \x3d\x3d WGS 1972":d=6378135;c=.00669431777826672;
break;case "WGS 1972":d=6378135;c=.00669431777826672;break;case "WGS84":case "WGS 1984":d=6378137;c=.00669437999014132;break;case "WGS 1966":d=6378145;c=.00669454185458764;break;case "FISCHER 1960":d=6378166;c=.00669342162296594;break;case "FISCHER 1968":d=6378150;c=.00669342162296594;break;case "FISCHER MODIFIED":d=6378155;c=.00669342162296594;break;case "HOUGH 1960":d=6378270;c=.00672267002233332;break;case "EVEREST MODIFIED 1969":d=6377295.664;c=.00663784663019969;break;case "WALBECK":d=6376896;
c=.00659454809414964;break;case "GRS 1967 TRUNCATED":d=6378160,c=.00669454185458764}p=c/(1-c);l=(1-Math.sqrt(1-c))/(1+Math.sqrt(1-c))},getSpheroidList:function(){return"AIRY 1830;AIRY MODIFIED;AUSTRALIAN NATIONAL;AVERAGE TERRESTRIAL SYSTEM 1977;BESSEL 1841;BESSEL MODIFIED;BESSEL NAMIBIA;CLARKE 1858;CLARKE 1866 MICHIGAN;CLARKE 1866;CLARKE 1880 (ARC);CLARKE 1880 (BENOIT);CLARKE 1880 (IGN);CLARKE 1880 (RGS);CLARKE 1880 (SGA);CLARKE 1880;EVEREST (ADJUSTMENT 1937);EVEREST (DEFINITION 1962);EVEREST (DEFINITION 1967);EVEREST (DEFINITION 1975);EVEREST 1830 (DEFINITION);EVEREST 1830 (MODIFIED);EVEREST MODIFIED 1969;FISCHER 1960;FISCHER 1968;FISCHER MODIFIED;GEM GRAVITY POTENTIAL MODEL;GRS 1967 \x3d INTERNATIONAL 1967;GRS 1967 TRUNCATED;GRS 1980;HELMERT 1906;HOUGH 1960;INDONESIAN NATIONAL;INTERNATIONAL 1924;INTERNATIONAL 1967;KRASOVSKY 1940;NWL-10D \x3d\x3d WGS 1972;OSU 1986 GEOIDAL MODEL;OSU 1991 GEOIDAL MODEL;PLESSIS 1817;STRUVE 1860;TRANSIT PRECISE EPHEMERIS;WALBECK;WAR OFFICE;WGS 1966;WGS 1972;WGS 1984".split(";")},
getZoneNumber:function(b,a){b=parseFloat(b);a=parseFloat(a);if(360<a||-180>a){for(;-180>a;)a+=360;for(;180<a;)a-=360}(360<a||-180>a||90<b||-90>b)&&console.error("Bad input. lat: "+b+" lon: "+a);var f=a+180-360*Math.floor((a+180)/360)-180,c=Math.floor((f+180)/6)+1;56<=b&&64>b&&3<=f&&12>f&&(c=32);72<=b&&84>b&&(0<=f&&9>f?c=31:9<=f&&21>f?c=33:21<=f&&33>f?c=35:33<=f&&42>f&&(c=37));return c},LLtoUTM:function(b,a,f){b=parseFloat(b);a=parseFloat(a);if(84<b||-80>b)return"undefined, ensure 84N \x3e Lat \x3e 80S";
if(360<a||-180>a){for(;-180>a;)a+=360;for(;180<a;)a-=360}(360<a||-180>a||90<b||-90>b)&&console.error("Bad input. lat: "+b+" lon: "+a);var e,m,k,g;e=a+180-360*Math.floor((a+180)/360)-180;m=b*Math.PI/180;e=e*Math.PI/180;a=f?f:this.getZoneNumber(b,a);f=(6*(a-1)-180+3)*Math.PI/180;this.UTMLetterDesignator(b);b=d/Math.sqrt(1-c*Math.sin(m)*Math.sin(m));k=Math.tan(m)*Math.tan(m);g=p*Math.cos(m)*Math.cos(m);e=Math.cos(m)*(e-f);return[.9996*b*(e+(1-k+g)*e*e*e/6+(5-18*k+k*k+72*g-58*p)*e*e*e*e*e/120)+5E5,.9996*
(d*((1-c/4-3*c*c/64-5*c*c*c/256)*m-(3*c/8+3*c*c/32+45*c*c*c/1024)*Math.sin(2*m)+(15*c*c/256+45*c*c*c/1024)*Math.sin(4*m)-35*c*c*c/3072*Math.sin(6*m))+b*Math.tan(m)*(e*e/2+(5-k+9*g+4*g*g)*e*e*e*e/24+(61-58*k+k*k+600*g-330*p)*e*e*e*e*e*e/720)),a]},LLtoUSNG:function(b,a,c,e){c=c||5;var f;f=e?e:this.getZoneNumber(b,a);b=parseFloat(b);a=parseFloat(a);var d=this.LLtoUTM(b,a,f);e=d[0];var g=d[1];0>b&&(g+=1E7);d=this.findGridLetters(f,g,e);f=Math.round(g)%1E5;e=Math.round(e)%1E5;f=Math.floor(f/Math.pow(10,
5-c));e=Math.floor(e/Math.pow(10,5-c));b=this.getZoneNumber(b,a)+this.UTMLetterDesignator(b)+" "+d+" ";for(a=String(e).length;a<c;a++)b+="0";b+=e+" ";for(a=String(f).length;a<c;a++)b+="0";return b+f},UTMLetterDesignator:function(b){b=parseFloat(b);return 84>=b&&72<=b?"X":72>b&&64<=b?"W":64>b&&56<=b?"V":56>b&&48<=b?"U":48>b&&40<=b?"T":40>b&&32<=b?"S":32>b&&24<=b?"R":24>b&&16<=b?"Q":16>b&&8<=b?"P":8>b&&0<=b?"N":0>b&&-8<=b?"M":-8>b&&-16<=b?"L":-16>b&&-24<=b?"K":-24>b&&-32<=b?"J":-32>b&&-40<=b?"H":-40>
b&&-48<=b?"G":-48>b&&-56<=b?"F":-56>b&&-64<=b?"E":-64>b&&-72<=b?"D":-72>b&&-80<=b?"C":"Z"},findSet:function(b){b=parseInt(b,10);switch(b%6){case 0:return 6;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return-1}},findGridLetters:function(b,a,c){b=parseInt(b,10);a=parseFloat(a);c=parseFloat(c);var f=1;for(a=Math.round(a);1E5<=a;)a-=1E5,f++;f%=20;a=0;for(c=Math.round(c);1E5<=c;)c-=1E5,a++;a%=8;return this.lettersHelper(this.findSet(b),f,a)},lettersHelper:function(b,
a,c){0===a?a=19:a--;0===c?c=7:c--;switch(b){case 1:return b="ABCDEFGHJKLMNPQRSTUV","ABCDEFGH".charAt(c)+b.charAt(a);case 2:return b="FGHJKLMNPQRSTUVABCDE","JKLMNPQR".charAt(c)+b.charAt(a);case 3:return b="ABCDEFGHJKLMNPQRSTUV","STUVWXYZ".charAt(c)+b.charAt(a);case 4:return b="FGHJKLMNPQRSTUVABCDE","ABCDEFGH".charAt(c)+b.charAt(a);case 5:return b="ABCDEFGHJKLMNPQRSTUV","JKLMNPQR".charAt(c)+b.charAt(a);case 6:return b="FGHJKLMNPQRSTUVABCDE","STUVWXYZ".charAt(c)+b.charAt(a)}},UTMtoLL:function(b,a,f){a=
parseFloat(a)-5E5;b=parseFloat(b);f=parseInt(f,10);b=b/.9996/(d*(1-c/4-3*c*c/64-5*c*c*c/256));b=b+(3*l/2-27*l*l*l/32)*Math.sin(2*b)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*b)+151*l*l*l/96*Math.sin(6*b);var e=d/Math.sqrt(1-c*Math.sin(b)*Math.sin(b)),m=Math.tan(b)*Math.tan(b),k=p*Math.cos(b)*Math.cos(b),g=a/(.9996*e);a=b-e*Math.tan(b)/(d*(1-c)/Math.pow(1-c*Math.sin(b)*Math.sin(b),1.5))*(g*g/2-(5+3*m+10*k-4*k*k-9*p)*g*g*g*g/24+(61+90*m+298*k+45*m*m-252*p-3*k*k)*g*g*g*g*g*g/720);a=180*a/Math.PI;b=(g-(1+
2*m+k)*g*g*g/6+(5-2*k+28*m-3*k*k+8*p+24*m*m)*g*g*g*g*g/120)/Math.cos(b);b=6*(f-1)-180+3+180*b/Math.PI;f={};f.lat=a;f.lon=b;return f},USNGtoUTM:function(b,a,c,e,d,k){c=1+"ABCDEFGHJKLMNPQRSTUVWXYZ".indexOf(c)%8;var f="CDEFGHJKLMNPQRSTUVWX".indexOf(a);e=b%2?"ABCDEFGHJKLMNPQRSTUV".indexOf(e):"FGHJKLMNPQRSTUVABCDE".indexOf(e);e=Number([0,2,2,2,4,4,6,6,8,8,0,0,0,2,2,4,4,6,6,6][f])+e/10;e<[1.1,2,2.9,3.8,4.7,5.6,6.5,7.3,8.2,9.1,0,.8,1.7,2.6,3.5,4.4,5.3,6.2,7,7.9][f]&&(e+=2);f={};f.N=1E6*e+Number(k)*Math.pow(10,
5-k.length);f.E=1E5*c+Number(d)*Math.pow(10,5-d.length);f.zone=b;f.letter=a;return f},USNGtoLL:function(b){b=this.parseUSNG_str(b);var a=this.USNGtoUTM(b.zone,b.ltr,b.sq1,b.sq2,b.east,b.north);"N">b.ltr&&(a.N-=1E7);a=this.UTMtoLL(a.N,a.E,b.zone);return[a.lat,a.lon]},parseUSNG_str:function(b){var a=[];b=b.toUpperCase();a=/%20/g;a=b.replace(a,"");a=/ /g;a=b.replace(a,"");if(7>a.length)return 0;b={};var c=0;b.zone=10*a.charAt(c++)+1*a.charAt(c++);b.ltr=a.charAt(c++);b.sq1=a.charAt(c++);b.sq2=a.charAt(c++);
b.precision=(a.length-c)/2;b.east="";b.north="";for(var e=0;e<b.precision;e++)b.east+=a.charAt(c++);" "===a[c]&&c++;for(e=0;e<b.precision;e++)b.north+=a.charAt(c++);return b},isUSNG:function(b){var a;b=b.toUpperCase();a=/%20/g;b=b.replace(a,"");a=/ /g;b=b.replace(a,"");if(15<b.length)return 0;a=/^[0-9]{2}[CDEFGHJKLMNPQRSTUVWX]$/;if(b.match(a))return 0;a=/^[0-9]{2}[CDEFGHJKLMNPQRSTUVWX][ABCDEFGHJKLMNPQRSTUVWXYZ][ABCDEFGHJKLMNPQRSTUV]([0-9][0-9]){0,5}/;return!b.match(a)||7>b.length?0:b},LLtoMGRS:function(b,
a,c){return this.LLtoUSNG(b,a,c||5).replace(/ /g,"")},USNGtoPoint:function(b){b=this.USNGtoLL(b);return new h(b[1],b[0])},pointToUSNG:function(b,a){var c=b.getLatitude(),e=b.getLongitude();return this.LLtoUSNG(c,e,a)},LLtoUSNG_nad27:function(b,a,c){return this.LLtoUSNG(b,a,c||5)+" (NAD27)"}}})},"widgets/GridOverlay/lib/NonPolarGridZone":function(){define("dojo/_base/declare dojo/json ./constants esri/geometry/Polygon esri/geometry/Polyline esri/geometry/Extent".split(" "),function(h,d,c,p,l,b){return h(null,
{extent:null,id:null,utmZone:null,latitudeZone:null,_rings:[],constructor:function(a){var c=a.id.match(/(\d+)|([A-Za-z]+)/g);this.id=a.id;this.utmZone=1*c[0];this.latitudeZone=c[1];this.extent=new b({xmin:a.xmin,ymin:a.ymin,xmax:a.xmax,ymax:a.ymax,spatialReference:a.spatialReference||{wkid:4326}});a=[this.extent.xmin,this.extent.ymin];this._rings=[[a,[this.extent.xmax,this.extent.ymin],[this.extent.xmax,this.extent.ymax],[this.extent.xmin,this.extent.ymax],a]]},toPolygon:function(a){var b=d.parse(d.stringify(this._rings));
if(a)for(var e=0;e<b[0].length;e++)b[0][e][0]+=a*c.GEOGRAPHIC_360;return new p({rings:b,spatialReference:this.spatialReference})},toPolyline:function(a){var b=d.parse(d.stringify(this._rings));if(a)for(var e=0;e<b[0].length;e++)b[0][e][0]+=a*c.GEOGRAPHIC_360;return new l({paths:b,spatialReference:this.spatialReference})}})})},"widgets/GridOverlay/lib/VisibleGridZone":function(){define(["dojo/_base/declare","./GridPolygon"],function(h,d){return h(null,{polyline:null,polygon:null,offset:null,nonPolarGridZone:null,
map:null,constructor:function(c){this.offset=Math.round(c.offset);this.polyline=c.polyline;this.polygon=c.polygon;this.nonPolarGridZone=c.nonPolarGridZone;this.map=c.map;c={clippedPolygon:this.polygon,unclippedPolygon:this.nonPolarGridZone.toPolygon(c.offset),map:this.map,xmin:this.nonPolarGridZone.extent.xmin,ymin:this.nonPolarGridZone.extent.ymin,xmax:this.nonPolarGridZone.extent.xmax,ymax:this.nonPolarGridZone.extent.ymax,minMaxType:"degrees",utmZone:0,text:this.nonPolarGridZone.id,labelParameters:c.labelParameters};
this.gridPolygon=new d(c)},getLabels:function(){return this.gridPolygon.getLabels(!0)},getCenterLabel:function(){return this.gridPolygon.getCenterLabel()}})})},"widgets/GridOverlay/lib/GridPolygon":function(){define(["dojo/_base/declare","./mgrs","./labeling-utils","./LabelElement","esri/geometry/Point"],function(h,d,c,p,l){return h(null,{clippedPolygon:null,unclippedPolygon:null,map:null,xmin:0,ymin:0,xmax:0,ymax:0,minMaxType:"",utmZone:0,text:"",color:null,labelParameters:null,_centerLabelSet:!1,
_centerLabel:null,_labelsSet:!1,_labels:[],_cornerLabels:[],_borderLabels:[],_interiorLabels:[],candidatePoint:null,constructor:function(b){this.unclippedPolygon=b.unclippedPolygon;this.clippedPolygon=b.clippedPolygon;this.map=b.map;this.xmin=b.xmin;this.ymin=b.ymin;this.xmax=b.xmax;this.ymax=b.ymax;this.minMaxType=b.minMaxType;this.utmZone=Math.round(b.utmZone);this.text=b.text;this.labelParameters=b.labelParameters;this._cornerLabels=[];this._borderLabels=[];this._interiorLabels=[];this._centerLabel=
null;this._labelsSet=this._centerLabelSet=!1},getLabels:function(b){b=b||!1;this._labelsSet||(this._cornerLabels=this.setLabels(b),this._labelsSet=!0);b=0<this._cornerLabels.length?this._cornerLabels:0<this._borderLabels.length?this._borderLabels:this._interiorLabels;for(var a=0;a<b.length;a++)b[a]=b[a].getLabelGraphic();return b},getCenterLabel:function(b){this._centerLabelSet||(this.setCenterLabel(b),this._centerLabelSet=!0);return this._centerLabel.getLabelGraphic()},setCenterLabel:function(b){b=
b?this.clippedPolygon:this.unclippedPolygon;var a={xOffset:0,yOffset:0,rotation:0,color:this.labelParameters.color,fontFamily:this.labelParameters.fontFamily,fontSize:this.labelParameters.fontSize};this._centerLabel=new p({map:this.map,point:b.getCentroid(),labelParameters:a,text:this.text,verticalAlign:"middle",horizontalAlign:"middle"});a=new p({map:this._centerLabel.map,point:this._centerLabel.point,labelParameters:a,text:"utm"===this.minMaxType?"WW":"22W",verticalAlign:"middle",horizontalAlign:"middle"});
a.shrinkToFit(b,12);this._centerLabel.font.setSize(a.font.size);this._centerLabel.setExtent()},setLabels:function(b){b=b||!1;for(var a=this.clippedPolygon.rings,f=c.getScreenSize(this.clippedPolygon.getExtent(),this.map),e={xmin:Math.round(1E3*this.xmin)/1E3,ymin:Math.round(1E3*this.ymin)/1E3,xmax:Math.round(1E3*this.xmax)/1E3,ymax:Math.round(1E3*this.ymax)/1E3,map_xmin:this.map.extent.xmin,map_ymin:this.map.extent.ymin,map_xmax:this.map.extent.xmax,map_ymax:this.map.extent.ymax},d,k,g={"lower-left":{label:null,
priority:99,hidden:!1},"lower-right":{label:null,priority:99,hidden:!1},"upper-left":{label:null,priority:99,hidden:!1},"upper-right":{label:null,priority:99,hidden:!1}},h=0;h<a.length;h++){d=null;for(var z=0;z<a[h].length-1;z++){this.candidatePoint=new l(a[h][z],this.clippedPolygon.spatialReference);k=new l(a[h][z+1],this.clippedPolygon.spatialReference);if(0===z){var u=new l(a[h][a[h].length-2],this.clippedPolygon.spatialReference);d=this._findAngle(u,this.candidatePoint)}k=this._findAngle(this.candidatePoint,
k);if(k!==d&&(u="",0===k&&90===d?u="lower-right":270===k&&180===d?u="lower-right":0===k&&270===d?u="lower-left":90===k&&180===d?u="lower-left":90===k&&0===d?u="upper-left":180===k&&270===d?u="upper-left":180===k&&90===d?u="upper-right":270===k&&0===d&&(u="upper-right"),u)){d=this._findType(this.candidatePoint,e);var D=d.priority,H=new p({map:this.map,point:this.candidatePoint,labelParameters:this.labelParameters,text:this.text,verticalAlign:u.split("-")[0],horizontalAlign:u.split("-")[1]});g[u].priority>
D&&(g[u].label=H,g[u].priority=D,g[u].xOffset=d.xOffset,g[u].yOffset=d.yOffset)}d=k}}a=g["lower-left"];e=g["upper-left"];h=g["lower-right"];g=g["upper-right"];300>f.width&&(a.priority>h.priority&&(a.hidden=!0),h.priority>a.priority&&(h.hidden=!0),e.priority>g.priority&&(e.hidden=!0),g.priority>e.priority&&(g.hidden=!0));200>f.height&&(a.priority>e.priority&&(a.hidden=!0),h.priority>g.priority&&(h.hidden=!0),e.priority>a.priority&&(e.hidden=!0),g.priority>h.priority&&(g.hidden=!0));"utm"===this.minMaxType&&
(a.xOffset&&(a.label.xOffset=70),e.xOffset&&(e.label.xOffset=70),g.xOffset&&(g.label.xOffset=70),h.xOffset&&(h.label.xOffset=70),a.yOffset&&(a.label.yOffset=40),e.yOffset&&(e.label.yOffset=40),g.yOffset&&(g.label.yOffset=40),h.yOffset&&(h.label.yOffset=40));f=[];!a.hidden&&a.label&&f.push(a.label);!e.hidden&&e.label&&f.push(e.label);!g.hidden&&g.label&&f.push(g.label);!h.hidden&&h.label&&f.push(h.label);b=b?this.unclippedPolygon:this.clippedPolygon;for(g=0;g<f.length;g++)(new p({map:this.map,point:f[g].point,
labelParameters:this.labelParameters,text:"utm"===this.minMaxType?"WW":"22W",verticalAlign:f[g].verticalAlign,horizontalAlign:f[g].horizontalAlign})).fitsInPolygon(b)||(f.splice(g,1),g--);return f},_findXY:function(b){var a;a=b.getLongitude();b=b.getLatitude();"utm"===this.minMaxType?(b=d.LLtoUTM(b,a,this.utmZone),a=100*Math.round(b[0]/100),b=100*Math.round(b[1]/100),a%=1E6,b%=1E6):(a=Math.round(1E3*a)/1E3,b=Math.round(1E3*b)/1E3);return{x:a,y:b}},_findAngle:function(b,a){for(var c=-(180*Math.atan2(a.y-
b.y,a.x-b.x)/Math.PI)+90;0>c;)c+=360;for(;360<=c;)c-=360;15>c||345<c?c=0:105>c&&75<c?c=90:195>c&&165<c?c=180:285>c&&255<c&&(c=270);return c},_findType:function(b,a){var c=this._findXY(this.candidatePoint),d=c.x,c=c.y,h=!1,k=!1,g=0;b.x===a.map_xmin||b.x===a.map_xmax?(h=!0,g+=2):d===a.xmin||d===a.xmax?console.warn():g+=1;b.y===a.map_ymin||b.y===a.map_ymax?(k=!0,g+=2):c===a.ymin||c===a.ymax?console.warn():g+=1;return{priority:g,xOffset:h,yOffset:k}}})})},"widgets/GridOverlay/lib/LabelElement":function(){define("dojo/_base/declare ./geometry-utils ./labeling-utils esri/geometry/geometryEngine esri/geometry/screenUtils esri/graphic esri/geometry/Point esri/geometry/Extent esri/symbols/Font esri/symbols/TextSymbol".split(" "),
function(h,d,c,p,l,b,a,f,e,m){return h(null,{map:null,point:null,xOffset:0,yOffset:0,text:"",verticalAlign:"",horizontalAlign:"",rotation:0,color:null,fontFamily:"",fontSize:0,font:null,constructor:function(a){this.map=a.map;this.point=a.point;this.xOffset=a.labelParameters.xOffset||0;this.yOffset=a.labelParameters.yOffset||0;this.text=a.text;this.verticalAlign=a.verticalAlign||"bottom";this.verticalAlign.toLowerCase();this.horizontalAlign=a.horizontalAlign||"middle";this.horizontalAlign.toLowerCase();
this.rotation=a.labelParameters.rotation||0;this.rotation=90*Math.round(this.rotation/90);this.color=a.labelParameters.color;this.font=(new e).setFamily(a.labelParameters.fontFamily||"Arial, Helvetica, sans-serif").setSize(a.labelParameters.fontSize||0).setWeight(e.WEIGHT_BOLD)},getPixelWidth:function(){return 0!==this.rotation%180?this.font.size:c.getWidthOfText(this.text,this.font.family,this.font.size)},getPixelHeight:function(){return 0!==this.rotation%180?c.getWidthOfText(this.text,this.font.family,
this.font.size):this.font.size},decreaseFontSize:function(a){0!==this.font.size&&(this.font.setSize(this.font.size-(a||1)),this.setExtent())},setExtent:function(){var a=this.map,b=a.toScreen(this.point),c=this.getPixelWidth(),e=this.getPixelHeight()/1.3333,h,m,p,E;switch(this.horizontalAlign){case "left":b=b.offset(this.xOffset,0);h=b.x;p=b.x+c;break;case "middle":case "center":h=b.x-c/2;p=b.x+c/2;break;case "right":b=b.offset(-this.xOffset,0),h=b.x-c,p=b.x}switch(this.verticalAlign){case "bottom":case "lower":b=
b.offset(0,-this.yOffset);m=b.y;E=b.y-e;break;case "middle":case "center":m=b.y+e/2;E=b.y-e/2;break;case "upper":case "top":b=b.offset(0,this.yOffset),m=b.y+e,E=b.y}b=new f({xmin:h,ymin:m,xmax:p,ymax:E});this.extent=d.toWebMercator(l.toMapGeometry(a.extent,a.width,a.height,b))},getExtent:function(){this.extent||this.setExtent();return this.extent},fitsInPolygon:function(a){var b=this.getExtent(),b=d.toWebMercator(b);a=d.toWebMercator(a);return p.contains(a,b)},fitsInExtent:function(a){var b=this.getExtent(),
b=d.toWebMercator(b);a=d.toWebMercator(a);return p.contains(a,b)},shrinkToFit:function(a,b){b=b||0;!this.fitsInPolygon(a)&&0<this.font.size&&(this.font.setSize(this.font.size-1),this.font.size<b&&this.font.setSize(0),this.setExtent(),this.shrinkToFit(a,b))},getLabelGraphic:function(){var c=(new m(this.text)).setColor(this.color).setAlign(m.ALIGN_START).setFont(this.font),d=this.getExtent(),e=this.map.toScreen(this.point),d=this.map.toScreen(new a([d.xmin,d.ymin],d.spatialReference));c.setOffset(d.x-
e.x,-(d.y-e.y));return new b(this.point,c)}})})},"widgets/GridOverlay/_build-generate_module":function(){define(["dojo/i18n!./nls/strings"],function(){})},"*now":function(h){h(['dojo/i18n!*preload*widgets/GridOverlay/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define(["dojo/_base/declare","jimu/BaseWidget","./lib/GridOverlay"],function(h,d,c){return h([d],{baseClass:"grid-overlay",postCreate:function(){this.inherited(arguments);var d=this.config;this.gridOverlay=new c({map:this.map,minIntervalSpacing:d.minIntervalSpacing,levelOfDetail:d.levelOfDetail,labelPlacement:d.labelPlacement,verticalLabels:d.verticalLabels,cornerLabelXOffset:d.cornerLabelXOffset,cornerLabelYOffset:d.cornerLabelYOffset,intervalLabelXOffset:d.intervalLabelXOffset,intervalLabelYOffset:d.intervalLabelYOffset,
colors:d.colors,lineWidths:d.lineWidths,fontSizes:d.fontSizes,lineOpacity:d.lineOpacity,labelOpacity:d.labelOpacity,centerLabelOpacity:d.centerLabelOpacity,centerLabelScaleFactor:d.centerLabelScaleFactor,fontFamily:d.fontFamily,enabled:!1})},destroy:function(){this.gridOverlay.disable();this.inherited(arguments)},startup:function(){this.inherited(arguments)},onOpen:function(){this.gridOverlay.enable()},onClose:function(){this.gridOverlay.disable()}})});