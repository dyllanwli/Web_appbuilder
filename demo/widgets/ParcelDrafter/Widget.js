// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/ParcelDrafter/PlanSettings":function(){define("dojo/_base/declare dojo/_base/array jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./PlanSettings.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/query ./utils dijit/form/Select".split(" "),function(e,b,a,c,h,f,n,k,r,t){return e([a,c,n],{baseClass:"jimu-widget-ParcelDrafter-PlanSettings",templateString:h,selectedPlanSettings:{},planSettingsOptions:f.clone(t.planSettingsOptions),constructor:function(a){f.mixin(this,
a)},startup:function(){this._loadOptionsForDropDown(this.directionOrAngleType,this.planSettingsOptions.directionOrAngleType);this._loadOptionsForDropDown(this.directionOrAngleUnits,this.planSettingsOptions.directionOrAngleUnits);this._loadOptionsForDropDown(this.distanceAndLengthUnits,this.planSettingsOptions.distanceAndLengthUnits);this._loadOptionsForDropDown(this.areaUnits,this.planSettingsOptions.areaUnits);this._loadOptionsForDropDown(this.circularCurveParameters,this.planSettingsOptions.circularCurveParameters);
this.onPlansettingsChanged()},postCreate:function(){this.inherited(arguments);this.selectedPlanSettings={};this.planSettingsOptions=f.clone(t.planSettingsOptions);k.add(this.domNode,"esriCTPlanSettingsContainer esriCTFullWidth");setTimeout(f.hitch(this,this._setBackgroundColorForDartTheme),500)},_setBackgroundColorForDartTheme:function(){var a,b,c;if("DartTheme"===this.appConfig.theme.name)for(a=r(".dijitSelect .dijitButtonContents",this.planSettingsNode),c=r(".dijitSelect .dijitArrowButton",this.planSettingsNode),
b=0;b<a.length&&b<c.length;b++)k.add(a[b],"dijitButtonContentsDartTheme"),k.add(c[b],"dijitArrowButtonDartTheme")},_loadOptionsForDropDown:function(a,c){var g=[],e;b.forEach(c,f.hitch(this,function(a){e={value:a,label:this.nls.planSettings[a]||window.jimuNls.units[a]};g.push(e)}));a.addOption(g)},_isSettingsChanged:function(){var a=!1;this.selectedPlanSettings.directionOrAngleType!==this.directionOrAngleType.get("value")?a=!0:this.selectedPlanSettings.directionOrAngleUnits!==this.directionOrAngleUnits.get("value")?
a=!0:this.selectedPlanSettings.distanceAndLengthUnits!==this.distanceAndLengthUnits.get("value")?a=!0:this.selectedPlanSettings.areaUnits!==this.areaUnits.get("value")?a=!0:this.selectedPlanSettings.circularCurveParameters!==this.circularCurveParameters.get("value")&&(a=!0);return a},onClose:function(){if(this._isSettingsChanged())this.onPlansettingsChanged()},onPlansettingsChanged:function(){this.selectedPlanSettings={directionOrAngleType:this.directionOrAngleType.get("value"),directionOrAngleUnits:this.directionOrAngleUnits.get("value"),
distanceAndLengthUnits:this.distanceAndLengthUnits.get("value"),areaUnits:this.areaUnits.get("value"),circularCurveParameters:this.circularCurveParameters.get("value")};this.emit("planSettingsChanged",this.selectedPlanSettings)}})})},"widgets/ParcelDrafter/utils":function(){define([],function(){var e={bearingFieldPlaces:2,planSettingsOptions:{directionOrAngleType:["northAzimuth","southAzimuth","quadrantBearing"],directionOrAngleUnits:["decimalDegree","degreeMinuteSeconds"],distanceAndLengthUnits:["uSSurveyFeet",
"meters"],areaUnits:["squareUSSurveyFeet","acres","squareMeters"],circularCurveParameters:["radiusAndChordLength","radiusAndArcLength"]},getQuadrant:function(b){return{"-1":"NE","-2":"SE","-3":"SW","-4":"NW"}[b]},getQuadrantShortcut:function(b){b=b.toUpperCase();return{NE:"-1",SE:"-2",SW:"-3",NW:"-4"}[b]},getQuadrantShortcutFromDD:function(b){var a;0<=b&&90>=b?a="-1":90<b&&180>=b?a="-2":180<b&&270>b?a="-3":270<=b&&360>b&&(a="-4");return a},getQuadrantAngleFromNADD:function(b){b=e.getQuadrantAngleAndShortcut(b);
return b.quadrant.charAt(0)+b.quadrantAngle+b.quadrant.charAt(1)},getSouthAzimuthFromNorthAzimuth:function(b){var a;180<b?a=b-180:180>b?a=b+180:180===b&&(a=0);return a},DMStoDD:function(b){var a,c,e;a=Math.abs(parseFloat(b.degree));c=parseFloat(b.minutes);e=parseFloat(b.seconds);a=a+c/60+e/3600;b.isNegative&&(a*=-1);return a},DDtoDMS:function(b){var a,c;a=3600*b.angle;b=Math.round(a%60);b=60==b?0:b;c=(a-b)/60;a=Math.round(c%60);a=60==a?0:a;return{degree:Math.round((c-a)/60),minutes:a,seconds:b}},
getBearingObjForFormat0:function(b){var a,c;a={};a.degree=parseInt(b[1],10);a.minutes=parseInt(b[2]||0,10);a.seconds=parseInt(b[3]||0,10);a.quadrant=e.getQuadrant("-"+b[4]);a.quadrantShortcut="-"+b[4];"string"===typeof b[1]&&(c="-"===b[1].charAt(0));a.decimalDegrees=e.DMStoDD({degree:a.degree,minutes:a.minutes,seconds:a.seconds,isNegative:c});return a},getBearingObjForFormat1:function(b){var a,c;a={};a.degree=parseInt(b[2],10);a.minutes=parseInt(b[3]||0,10);a.seconds=parseInt(b[4]||0,10);a.quadrant=
b[1]+b[5];a.quadrantShortcut=e.getQuadrantShortcut(b[1]+b[5]);"string"===typeof b[2]&&(c="-"===b[2].charAt(0));a.decimalDegrees=e.DMStoDD({degree:a.degree,minutes:a.minutes,seconds:a.seconds,isNegative:c});return a},getBearingObjForFormat2:function(b){var a,c;a={};a.degree=parseInt(b[2],10);a.minutes=parseInt(b[3]||0,10);a.seconds=parseInt(b[4]||0,10);a.quadrant=b[1]+b[5];a.quadrantShortcut=e.getQuadrantShortcut(b[1]+b[5]);"string"===typeof b[2]&&(c="-"===b[2].charAt(0));a.decimalDegrees=e.DMStoDD({degree:a.degree,
minutes:a.minutes,seconds:a.seconds,isNegative:c});return a},getBearingObjForFormat3:function(b){var a,c;a={};a.degree=parseInt(b[1],10);a.minutes=parseInt(b[2]||0,10);a.seconds=parseInt(b[3]||0,10);"string"===typeof b[1]&&(c="-"===b[1].charAt(0));a.decimalDegrees=e.DMStoDD({degree:a.degree,minutes:a.minutes,seconds:a.seconds,isNegative:c});a.quadrantShortcut=e.getQuadrantShortcutFromDD(a.decimalDegrees);a.quadrant=e.getQuadrant(a.quadrantShortcut);return a},getBearingObjForFormat4:function(b){var a,
c;a=e.DDtoDMS({angle:b[1]});c={};c.degree=a.degree;c.minutes=a.minutes;c.seconds=a.seconds;c.decimalDegrees=b[1];c.quadrantShortcut=e.getQuadrantShortcutFromDD(c.decimalDegrees);c.quadrant=e.getQuadrant(c.quadrantShortcut);return c},getBearingObjForFormat5:function(b){var a,c;a={};a.degree=parseInt(b[1],10);a.minutes=parseInt(b[2]||0,10);a.seconds=parseInt(b[3]||0,10);"string"===typeof b[1]&&(c="-"===b[1].charAt(0));a.decimalDegrees=e.DMStoDD({degree:a.degree,minutes:a.minutes,seconds:a.seconds,isNegative:c});
a.quadrantShortcut=e.getQuadrantShortcutFromDD(a.decimalDegrees);a.quadrant=e.getQuadrant(a.quadrantShortcut);return a},getBearingObjForFormat6:function(b){var a,c;a={};a.degree=parseInt(b[1],10);a.minutes=parseInt(b[2]||0,10);a.seconds=parseInt(b[3]||0,10);a.quadrantShortcut=b[4];a.quadrant=e.getQuadrant(a.quadrantShortcut);"string"===typeof b[1]&&(c="-"===b[1].charAt(0));a.decimalDegrees=e.DMStoDD({degree:a.degree,minutes:a.minutes,seconds:a.seconds,isNegative:c});return a},getBearingObjForFormat7:function(b){var a,
c;a={};a.decimalDegrees=b[2];c=e.DDtoDMS({angle:a.decimalDegrees});a.degree=parseInt(c.degree,10);a.minutes=parseInt(c.minutes||0,10);a.seconds=parseInt(c.seconds||0,10);a.quadrant=b[1]+b[3];a.quadrantShortcut=e.getQuadrantShortcut(a.quadrant);return a},getBearingObjForFormat8:function(b){var a,c;a={};a.decimalDegrees=b[1];c=e.DDtoDMS({angle:a.decimalDegrees});a.degree=parseInt(c.degree,10);a.minutes=parseInt(c.minutes||0,10);a.seconds=parseInt(c.seconds||0,10);a.quadrantShortcut=b[2];a.quadrant=
e.getQuadrant(a.quadrantShortcut);return a},getQuadrantAngleAndShortcut:function(b){var a={};0<=b&&90>=b?(a.quadrantAngle=b,a.quadrant="NE"):90<b&&180>=b?(a.quadrantAngle=180-b,a.quadrant="SE"):180<b&&270>b?(a.quadrantAngle=b-180,a.quadrant="SW"):270<=b&&360>b&&(a.quadrantAngle=360-b,a.quadrant="NW");return a},roundSeconds:function(b){b=Number(b);return 10>b?"0"+b:b},honourPopupRounding:function(b,a){var c;if(isNaN(b)||null===b)b=4;c=Math.pow(10,b);c=Math.round(a*c)/c;return c=c.toFixed(b)},convertBearingToOutputFormats:function(b){var a,
c,h,f,n;a={};c={};360===b.degree&&(b.degree=0);a=b.decimalDegrees;360===a&&(a=0);c.naDD=a;c.naDDRound=e.honourPopupRounding(e.bearingFieldPlaces,a);360===Number(c.naDDRound)&&(c.naDDRound=0);h=10>b.minutes?"0"+b.minutes:b.minutes;f=b.seconds;0<Number(h)&&0<Number(e.roundSeconds(f))?c.naDMS=b.degree+"-"+h+"-"+e.roundSeconds(f):0===Number(h)&&0<Number(e.roundSeconds(f))?c.naDMS=b.degree+"-"+h+"-"+e.roundSeconds(f):0<Number(h)&&0===Number(e.roundSeconds(f))?c.naDMS=b.degree+"-"+h+"-00":0===Number(h)&&
0===Number(e.roundSeconds(f))&&(c.naDMS=b.degree+"-00-00");b=e.getQuadrantAngleAndShortcut(a);c.qb3DD=b.quadrant.charAt(0)+b.quadrantAngle+b.quadrant.charAt(1);c.qb3DDRound=b.quadrant.charAt(0)+e.honourPopupRounding(e.bearingFieldPlaces,b.quadrantAngle)+b.quadrant.charAt(1);h=e.DDtoDMS({angle:b.quadrantAngle});f=10>h.minutes?"0"+h.minutes:h.minutes;n=h.seconds;0<Number(f)&&0<Number(e.roundSeconds(n))?c.qb3DMS=b.quadrant.charAt(0)+h.degree+"-"+f+"-"+e.roundSeconds(n)+b.quadrant.charAt(1):0===Number(f)&&
0<Number(e.roundSeconds(n))?c.qb3DMS=b.quadrant.charAt(0)+h.degree+"-"+f+"-"+e.roundSeconds(n)+b.quadrant.charAt(1):0<Number(f)&&0===Number(e.roundSeconds(n))?c.qb3DMS=b.quadrant.charAt(0)+h.degree+"-"+f+"-00"+b.quadrant.charAt(1):0===Number(f)&&0===Number(e.roundSeconds(n))&&(c.qb3DMS=b.quadrant.charAt(0)+h.degree+"-00-00"+b.quadrant.charAt(1));a=e.getSouthAzimuthFromNorthAzimuth(a);360===a&&(a=0);c.saDD=a;c.saDDRound=e.honourPopupRounding(e.bearingFieldPlaces,a);360===Number(c.saDDRound)&&(c.saDDRound=
0);a=e.DDtoDMS({angle:a});360===a.degree&&(a.degree=0);b=10>a.minutes?"0"+a.minutes:a.minutes;h=a.seconds;0<Number(b)&&0<Number(e.roundSeconds(h))?c.saDMS=a.degree+"-"+b+"-"+e.roundSeconds(h):0===Number(b)&&0<Number(e.roundSeconds(h))?c.saDMS=a.degree+"-"+b+"-"+e.roundSeconds(h):0<Number(b)&&0===Number(e.roundSeconds(h))?c.saDMS=a.degree+"-"+b+"-00":0===Number(b)&&0===Number(e.roundSeconds(h))&&(c.saDMS=a.degree+"-00-00");return c},getBearingDetailsOfRequiredFormat:function(b,a){var c={};switch(a){case 0:c=
e.getBearingObjForFormat0(b);break;case 1:c=e.getBearingObjForFormat1(b);break;case 2:c=e.getBearingObjForFormat2(b);break;case 3:c=e.getBearingObjForFormat3(b);break;case 4:c=e.getBearingObjForFormat4(b);break;case 5:c=e.getBearingObjForFormat5(b);break;case 6:c=e.getBearingObjForFormat6(b);break;case 7:c=e.getBearingObjForFormat7(b);break;case 8:c=e.getBearingObjForFormat8(b)}return e.convertBearingToOutputFormats(c)},getBearingFormatArr:function(){var b=[];b.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0))(?:\-(0|[0-5]?\d)\-(0|[0-5]\d))?\-([1-4])$/,
type:"degreeMinuteSeconds"});b.push({regex:/^([nNsS])((?:\-)?(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0))(?:\-(0|[0-5]?\d)\-(0|[0-5]\d))?([eEwW])$/,type:"degreeMinuteSeconds"});b.push({regex:/^([nNsS])((?:\-)?(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?([eEwW])$/,type:"degreeMinuteSeconds"});b.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?$/,type:"degreeMinuteSeconds"});b.push({regex:/^((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))$/,
type:"decimalDegree"});b.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0))(?:\-(0|[0-5]?\d)\-((?:[0-5]\d)))?$/,type:"degreeMinuteSeconds"});b.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?(\-[1-4])$/,type:"degreeMinuteSeconds"});b.push({regex:/^([nNsS])((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))([eEwW])$/,type:"decimalDegree"});b.push({regex:/^((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[1-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))(\-[1-4])$/,
type:"decimalDegree"});return b},getNorthAzimuthAngle:function(b,a){a=a.toUpperCase();b=Number(b);switch(a){case "-1":case "NE":return(b+360)%360;case "-2":case "SE":return(540-b)%360;case "-3":case "SW":return(540+b)%360;case "-4":case "NW":return(360-b)%360}},convertBearingToNorthAzimuth:function(b,a,c){switch(a){case 0:a=e.getBearingObjForFormat0(b);a=e.getNorthAzimuthAngle(a.decimalDegrees,"-"+b[4]);a=e.DDtoDMS({angle:a});b[1]=a.degree;b[2]=a.minutes;b[3]=a.seconds;break;case 1:a=e.getBearingObjForFormat1(b);
a=e.getNorthAzimuthAngle(a.decimalDegrees,b[1]+b[5]);a=e.DDtoDMS({angle:a});b[2]=a.degree;b[3]=a.minutes;b[4]=a.seconds;break;case 2:a=e.getBearingObjForFormat2(b);a=e.getNorthAzimuthAngle(a.decimalDegrees,b[1]+b[5]);a=e.DDtoDMS({angle:a});b[2]=a.degree;b[3]=a.minutes;b[4]=a.seconds;break;case 3:"northAzimuth"===c.directionOrAngleType||"quadrantBearing"===c.directionOrAngleType?(a=e.getBearingObjForFormat3(b),a=e.getNorthAzimuthAngle(a.decimalDegrees,"-1"),a=e.DDtoDMS({angle:a}),b[1]=a.degree,b[2]=
a.minutes,b[3]=a.seconds):"southAzimuth"===c.directionOrAngleType&&(a=e.getBearingObjForFormat3(b),a=e.getNorthAzimuthAngle(a.decimalDegrees,"-3"),a=e.DDtoDMS({angle:a}),b[1]=a.degree,b[2]=a.minutes,b[3]=a.seconds);break;case 4:"northAzimuth"===c.directionOrAngleType||"quadrantBearing"===c.directionOrAngleType?b[1]=e.getNorthAzimuthAngle(b[1],"-1"):"southAzimuth"===c.directionOrAngleType&&(b[1]=e.getNorthAzimuthAngle(b[1],"-3"));break;case 5:"northAzimuth"===c.directionOrAngleType?(a=e.getBearingObjForFormat5(b),
a=e.getNorthAzimuthAngle(a.decimalDegrees,"-1"),a=e.DDtoDMS({angle:a}),b[1]=a.degree,b[2]=a.minutes,b[3]=a.seconds):"southAzimuth"===c.directionOrAngleType?(a=e.getBearingObjForFormat5(b),a=e.getNorthAzimuthAngle(a.decimalDegrees,"-3"),a=e.DDtoDMS({angle:a}),b[1]=a.degree,b[2]=a.minutes,b[3]=a.seconds):"quadrantBearing"===c.directionOrAngleType&&(b=null);break;case 6:a=e.getBearingObjForFormat6(b);a=e.getNorthAzimuthAngle(a.decimalDegrees,b[4]);a=e.DDtoDMS({angle:a});b[1]=a.degree;b[2]=a.minutes;
b[3]=a.seconds;break;case 7:b[2]=e.getNorthAzimuthAngle(b[2],b[1]+b[3]);break;case 8:b[1]=e.getNorthAzimuthAngle(b[1],b[2])}return b},categorizeBearingFormat:function(b,a){var c,h,f;b=b.toString();c=e.getBearingFormatArr();for(f=0;f<c.length;f++)if(c[f].type===a.directionOrAngleUnits&&(h=c[f].regex.exec(b.trim()))&&0<h.length){h=e.convertBearingToNorthAzimuth(h,f,a);break}if(!h)for(f=0;f<c.length;f++)if(c[f].type!==a.directionOrAngleUnits&&(h=c[f].regex.exec(b.trim()))&&0<h.length){h=e.convertBearingToNorthAzimuth(h,
f,a);break}return h?e.getBearingDetailsOfRequiredFormat(h,f):null},metersToUSSurveyFeet:function(b){b=Number(b);return 3.28083333333*b},usSurveyFeetToMeters:function(b){b=Number(b);return.304800609601*b},feetToUSSurveyFeet:function(b){b=Number(b);return e.metersToUSSurveyFeet(.3048*b)},feetToMeters:function(b){b=Number(b);return.3048*b},usSurveyFeetToFeet:function(b){b=Number(b);return 1.000001999999281*b},metersToFeet:function(b){b=Number(b);return 3.280839895*b},getLengthObjForFormat0:function(b,
a){var c;c={};"uSSurveyFeet"===a?(c.uSSurveyFeet=Number(b[0]),c.uSSurveyFeetRound=Math.round(1E4*c.uSSurveyFeet)/1E4,c.meters=e.usSurveyFeetToMeters(b[0]),c.metersRound=Math.round(1E4*c.meters)/1E4,c.feet=e.usSurveyFeetToFeet(c.uSSurveyFeet),c.feetRound=Math.round(1E4*c.feet)/1E4):"meters"===a&&(c.uSSurveyFeet=e.metersToUSSurveyFeet(b[0]),c.uSSurveyFeetRound=Math.round(1E4*c.uSSurveyFeet)/1E4,c.meters=Number(b[0]),c.metersRound=Math.round(1E4*c.meters)/1E4,c.feet=e.metersToFeet(c.meters),c.feetRound=
Math.round(1E4*c.feet)/1E4);return c},getLengthObjForFormat1:function(b){var a;a={};a.uSSurveyFeet=Number(b[2]);a.uSSurveyFeetRound=Math.round(1E4*a.uSSurveyFeet)/1E4;a.meters=e.usSurveyFeetToMeters(b[2]);a.metersRound=Math.round(1E4*a.meters)/1E4;a.feet=e.usSurveyFeetToFeet(a.uSSurveyFeet);a.feetRound=Math.round(1E4*a.feet)/1E4;return a},getLengthObjForFormat2:function(b){var a;a={};a.uSSurveyFeet=e.metersToUSSurveyFeet(b[2]);a.uSSurveyFeetRound=Math.round(1E4*a.uSSurveyFeet)/1E4;a.meters=Number(b[2]);
a.metersRound=Math.round(1E4*a.meters)/1E4;a.feet=e.metersToFeet(a.meters);a.feetRound=Math.round(1E4*a.feet)/1E4;return a},getLengthObjForFormat3:function(b){var a;a={};a.uSSurveyFeet=e.feetToUSSurveyFeet(b[2]);a.uSSurveyFeetRound=Math.round(1E4*a.uSSurveyFeet)/1E4;a.meters=e.feetToMeters(b[2]);a.metersRound=Math.round(1E4*a.meters)/1E4;a.feet=Number(b[2]);a.feetRound=Math.round(1E4*a.feet)/1E4;return a},categorizeLengthFormat:function(b,a){var c,h,f;c=[];b=b.toString();c.push(/^((\-?)((0?|([1-9]\d*))(\.\d+)?))$/);
c.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(ft|FT|fT|Ft))$/);c.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(m|M))$/);for(f=0;f<c.length&&!((h=c[f].exec(b.trim()))&&0<h.length);f++);h?(c=e.getLengthOfRequiredFormat(h,f,a))&&isNaN(c.meters)&&(c=null):c=null;return c},categorizeLengthFormatForFeet:function(b){var a,c,h;a=[];b=b.toString();a.push(/^((\-?)((0?|([1-9]\d*))(\.\d+)?))$/);for(h=0;h<a.length&&!((c=a[h].exec(b.trim()))&&0<c.length);h++);return c?e.getLengthObjForFormat3(c):null},getLengthOfRequiredFormat:function(b,
a,c){var h={};switch(a){case 0:h=e.getLengthObjForFormat0(b,c);break;case 1:h=e.getLengthObjForFormat1(b);break;case 2:h=e.getLengthObjForFormat2(b)}return h}};return e})},"widgets/ParcelDrafter/NewTraverse":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./NewTraverse.html dojo/_base/lang dojo/_base/array dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dnd/Source dojo/on dijit/form/ValidationTextBox ./SymbolSelector ./MiscloseDetails ./ParcelTools ./PlanInfo ./geometryUtils ./utils esri/graphic esri/symbols/jsonUtils esri/layers/GraphicsLayer esri/graphicsUtils dojo/dom-attr dojo/query esri/SpatialReference dojo/keys dijit/focus dijit/TooltipDialog dijit/popup dojo/Deferred esri/geometry/Extent dojo/dom-geometry".split(" "),
function(e,b,a,c,h,f,n,k,r,t,q,g,w,z,F,D,E,p,l,y,L,I,M,A,J,G,x,v,C,B,N,O,K){return e([b,a,c],{baseClass:"jimu-widget-ParcelDrafter",templateString:h,parcelLinesGraphicsLayer:null,parcelPointsGraphicsLayer:null,parcelPolygonGraphicsLayer:null,lineLayerSpatialReference:null,polygonLayerSpatialReference:null,_itemList:[],_nodes:[],_dndContainer:null,startPoint:null,_startPointForNextLine:null,_planSettings:null,_arrayOfAllBoundaryLines:[],_rotationAngle:0,_scaleValue:1,polygonDeleteArr:[],polylineDeleteArr:[],
_popupDialog:null,_popupCoords:null,numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],lengthFieldPlaces:2,radiusFieldPlaces:2,miscloseDistanceFieldPlaces:2,postCreate:function(){this.numberFieldTypes=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];this.polygonDeleteArr=[];this.polylineDeleteArr=[];this._arrayOfAllBoundaryLines=[];this._nodes=[];this._itemList=[];k.add(this.domNode,"esriCTNewTraverseGrid");
this._addGraphicsLayer();this._createTraverseGrid();this._setValidatorForInitialRow();this._handleEventsOnInitialRow();this._symbolSelector=this._createLineSelector(this.lineSymbolNode,null);this.own(g(this.screenDigitizationNode,"click",f.hitch(this,this._onDigitizationButtonClicked)));this.own(g(this.zoomToNode,"click",f.hitch(this,this._onZoomButtonClicked)));this.own(g(this.expandCollapseNode,"click",f.hitch(this,this._onExpandCollapseClicked)));this.own(g(this.addButton,"click",f.hitch(this,
function(){this._addNewItem(!1)})));this._createMiscloseDetails();this._createParcelTools();this._createPlanInfo();this._createTooltip();this.config.polylineLayer&&this.config.polylineLayer.popupInfo&&this.config.polylineLayer.popupInfo.fieldInfos&&n.forEach(this.config.polylineLayer.popupInfo.fieldInfos,f.hitch(this,function(d){d.fieldName===this.config.polylineLayer.bearing.name&&d.format&&(l.bearingFieldPlaces=d.format.places);d.fieldName===this.config.polylineLayer.distance.name&&d.format&&(this.lengthFieldPlaces=
d.format.places);d.fieldName===this.config.polylineLayer.radius.name&&d.format&&(this.radiusFieldPlaces=d.format.places)}));this.config.polygonLayer&&this.config.polygonLayer.popupInfo&&this.config.polygonLayer.popupInfo.fieldInfos&&n.forEach(this.config.polygonLayer.popupInfo.fieldInfos,f.hitch(this,function(d){d.fieldName===this.config.polygonLayer.miscloseDistance.name&&d.format&&(this.miscloseDistanceFieldPlaces=d.format.places)}))},_addGraphicsLayer:function(){this.parcelPolygonGraphicsLayer=
new I;this.parcelLinesGraphicsLayer=new I;this.parcelPointsGraphicsLayer=new I;this.map.addLayer(this.parcelPolygonGraphicsLayer);this.map.addLayer(this.parcelLinesGraphicsLayer);this.map.addLayer(this.parcelPointsGraphicsLayer)},_setValidatorForInitialRow:function(){this.bearingNode.validator=f.hitch(this,function(d){return this._bearingValidator(d,["*","*tb"])});this.bearingNode.invalidMessage=this.nls.newTraverse.invalidBearingMessage;this.lengthNode.validator=f.hitch(this,function(d){if("*"===
d&&this._itemList&&0<this._itemList.length)return!0;if(""===this.radiusNode.get("value")&&0>parseFloat(d))return this.lengthNode.invalidMessage=this.nls.newTraverse.negativeLengthMessage,!1;this.lengthNode.invalidMessage=this.nls.newTraverse.invalidLengthMessage;return this._lengthValidator(d)});this.lengthNode.invalidMessage=this.nls.newTraverse.invalidLengthMessage;this.radiusNode.validator=f.hitch(this,function(d){var a;if("*"===d&&this._itemList&&0<this._itemList.length)return!0;a=this._radiusValidator(d);
if(""!==d)if((d=this.lengthNode.isValid())&&a){if(!this._validateLengthRadiusProportion(a,d))return null;a&&(d=this.lengthNode.value,this.lengthNode.reset(),this.lengthNode.set("value",d))}else a=null;return a});this.radiusNode.invalidMessage=this.nls.newTraverse.invalidRadiusMessage},_bearingValidator:function(d,a){return-1!==a.indexOf(d)&&this._itemList&&0<this._itemList.length?!0:this._validateBearing(d,a)},_lengthValidator:function(d,a){return""===d||"0"===d||0===d?!1:this._validateLength(d,a)},
_radiusValidator:function(d,a){return""===d?!0:this._validateLength(d,a)},_handleEventsOnInitialRow:function(){this.own(g(this.bearingNode,"keypress",f.hitch(this,this._bearingValueEntered)));this.own(g(this.lengthNode,"keypress",f.hitch(this,this._lengthValueEntered)));this.own(g(this.radiusNode,"keypress",f.hitch(this,this._radiusValueEntered)))},_copyPrevValue:function(d){switch(d){case "Bearing":d=this.bearingNode.get("value");"*"===d&&0<this._itemList.length&&(d=this._itemList[this._itemList.length-
1].BearingConversions?this._getBearingAccordingToPlanSettings(this._itemList[this._itemList.length-1].BearingConversions):this._itemList[this._itemList.length-1].Bearing,this.bearingNode.set("value",d));break;case "Length":d=this.lengthNode.get("value");"*"===d&&0<this._itemList.length&&(d="radiusAndArcLength"===this._planSettings.circularCurveParameters&&this._itemList[this._itemList.length-1].ArcLengthConversions?this._itemList[this._itemList.length-1].ArcLengthConversions[this._planSettings.distanceAndLengthUnits]:
this._itemList[this._itemList.length-1].LengthConversions?this._itemList[this._itemList.length-1].LengthConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].Length,this.lengthNode.set("value",d));break;case "Radius":d=this.radiusNode.get("value"),"*"===d&&0<this._itemList.length&&(d=this._itemList[this._itemList.length-1].RadiusConversions?this._itemList[this._itemList.length-1].RadiusConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-
1].Radius,this.radiusNode.set("value",d))}},_bearingValueEntered:function(d){d=d.charCode||d.keyCode;d===x.ENTER||d===x.TAB?(this.bearingNode.get("value"),this._copyPrevValue("Bearing"),d===x.ENTER&&this.bearingNode.isValid()?v.focus(this.lengthNode):this.bearingNode.validate(!1)):setTimeout(f.hitch(this,function(){this.bearingNode.validate(!1)}),100)},_lengthValueEntered:function(d){d=d.charCode||d.keyCode;d===x.ENTER||d===x.TAB?(this.lengthNode.get("value"),this._copyPrevValue("Length"),d===x.ENTER&&
this.lengthNode.isValid()?v.focus(this.radiusNode):this.lengthNode.validate(!1)):setTimeout(f.hitch(this,function(){this.lengthNode.validate(!1)}),100)},_radiusValueEntered:function(d){d=d.charCode||d.keyCode;d===x.ENTER||d===x.TAB?(d=this.radiusNode.get("value"),this._copyPrevValue("Radius"),""===d||this.radiusNode.isValid()?this.bearingNode.isValid()?this.lengthNode.isValid()?(this._addNewItem(),v.focus(this.bearingNode)):(this.lengthNode.validate(!1),v.focus(this.lengthNode)):(this.bearingNode.validate(!1),
v.focus(this.bearingNode)):this.radiusNode.validate(!1)):setTimeout(f.hitch(this,function(){this.radiusNode.validate(!1)}),100)},_validateBearing:function(d){return(d=l.categorizeBearingFormat(d,this._planSettings))?d:null},_validateLength:function(d,a){var b;switch(a){case "feets":b=l.categorizeLengthFormatForFeet(d);break;case "meters":b=l.categorizeLengthFormat(d,"meters");break;case "uSSurveyFeet":b=l.categorizeLengthFormat(d,"uSSurveyFeet");break;default:b=l.categorizeLengthFormat(d,this._planSettings.distanceAndLengthUnits)}return b?
b:null},_validateLengthRadiusProportion:function(d,a){var b,m;return d&&a&&(m=d[this._planSettings.distanceAndLengthUnits],b=a[this._planSettings.distanceAndLengthUnits],0!==m&&(m=2*parseFloat(Math.abs(m)),"radiusAndArcLength"===this._planSettings.circularCurveParameters&&(m*=Math.PI),m<parseFloat(Math.abs(b))))?null:!0},_getValidatedValues:function(d,a,b){var m={},u;d?(m=d,a&&("Bearing"!==a&&m.BearingConversions&&(m.Bearing=this._getBearingAccordingToPlanSettings(m.BearingConversions)),"Length"!==
a&&m.LengthConversions&&(m.Length=m.LengthConversions[this._planSettings.distanceAndLengthUnits]),"Radius"!==a&&m.RadiusConversions&&(m.Radius=m.RadiusConversions[this._planSettings.distanceAndLengthUnits]),"Bearing"===a&&"*tb"===m.Bearing.toString().toLowerCase()&&0<this._itemList.length&&0!==b&&(m.isTB=!0))):(this._copyPrevValue("Bearing"),this._copyPrevValue("Length"),this._copyPrevValue("Radius"),m.LineSymbol=this._symbolSelector.selectedSymbol,m.Bearing=this.bearingNode.get("value"),m.Length=
this.lengthNode.get("value"),m.Radius=this.radiusNode.get("value"),"*tb"===m.Bearing.toString().toLowerCase()&&0<this._itemList.length?m.isTB=!0:m.isTB=!1);if(""!==f.trim(m.Bearing.toString())&&""!==f.trim(m.Length.toString())&&((a=this._validateBearing(m.Bearing))||m.isTB)){m.BearingConversions=a;if(""===f.trim(m.Length.toString())&&""===f.trim(m.Radius.toString()))return null;if(""!==f.trim(m.Length.toString()))if((a=this._validateLength(m.Length))&&0!==a.meters){if(""!==f.trim(m.Radius.toString()))if(u=
this._validateLength(m.Radius)){if(!this._validateLengthRadiusProportion(u,a))return null;m.RadiusConversions=u}else return null;else{if(0>parseInt(a.meters,10))return null;m.RadiusConversions=null}m.LengthConversions=a}else return null;m.RadiusConversions&&(m=this._createValuesForArc(m));m.isTB&&(d=d&&!isNaN(b)?this._itemList[b-1]:this._itemList[this._itemList.length-1],m=this._setTangentBearing(m,d))}else return null;return m},_setTangentBearing:function(d,a){var b,m;m=f.clone(this._planSettings);
m.directionOrAngleType="northAzimuth";m.directionOrAngleUnits="decimalDegree";b=a.BearingConversions.naDD;a.RadiusConversions&&0!==a.RadiusConversions.meters&&(b=p.chordBearingToTangentBearing(b,a.RadiusConversions.meters,a.ChordLengthConversions.meters));d.RadiusConversions&&0!==d.RadiusConversions.meters?(b=p.tangentBearingToChordBearing(b,d.RadiusConversions.meters,d.ChordLengthConversions.meters),d.Bearing=b,d.BearingConversions=l.categorizeBearingFormat(d.Bearing,m)):a.RadiusConversions&&0!==
a.RadiusConversions.meters?(d.Bearing=b,d.BearingConversions=l.categorizeBearingFormat(d.Bearing,m)):(d.Bearing=a.Bearing,d.BearingConversions=f.clone(a.BearingConversions));return d},_updateTBFromIndex:function(d){var a;for(a=!1;d<this._itemList.length;d++)if(this._itemList[d]&&this._itemList[d].isTB)this._itemList[d]=this._setTangentBearing(this._itemList[d],this._itemList[d-1]),a=!0;else break;return a},_onZoomButtonClicked:function(){this._setExtentToLayer(this.parcelLinesGraphicsLayer,!0)},_onExpandCollapseClicked:function(){k.toggle(this.traverseGrid,
"esriCTHidden");k.contains(this.expandCollapseNode,"esriCTExpand")?(A.set(this.expandCollapseNode,"title",this.nls.planSettings.collapseGridTooltipText),k.replace(this.expandCollapseNode,"esriCTCollapse","esriCTExpand")):(A.set(this.expandCollapseNode,"title",this.nls.planSettings.expandGridTooltipText),k.replace(this.expandCollapseNode,"esriCTExpand","esriCTCollapse"))},setRotation:function(d){d=p.getRotationAngleBetweenPoints(this.startPoint,d);0<this._itemList.length&&(d-=this._itemList[0].BearingConversions.naDDRound);
360===d&&(d=0);this._parcelToolInstance.setRotation(d)},setScaling:function(d){d=p.getScaleDistanceBetweenPoints(this.startPoint,d);this.distance?(d/=this.distance,.1>d&&(d=.1),this._parcelToolInstance.setScale(d)):this.distance=d},_addNewItem:function(d){var a,b;(a=this._getValidatedValues())?(d&&this._rotationAngle&&(b=a.BearingConversions.naDD-this._rotationAngle,b=this.getAngleFromDDTOQB(360<=b?b%360:b),a.Bearing=b,a.BearingConversions=this._validateBearing(b)),b=f.trim(a.Radius.toString()),this._itemList.push(a),
this._createRow(a,this._itemList.length-1),this._resetEntryRow(d),this.appliedCompassRule?this.setParcelClosure():(""===b||"0"===b||0===b?this._drawStraightLine(a,!0):this._drawArc(a,!0),this._showHideTraverseTools())):this.bearingNode.isValid()?""!==this.lengthNode.get("value")&&this.lengthNode.isValid()?""===this.radiusNode.get("value")||this.radiusNode.isValid()||(v.focus(this.radiusNode),this.radiusNode.validate(!1)):(v.focus(this.lengthNode),this.lengthNode.validate(!1)):(v.focus(this.bearingNode),
this.bearingNode.validate(!1))},_createValuesForArc:function(d){var a;d.RadiusConversions?(a=d.RadiusConversions.meters,"radiusAndArcLength"===this._planSettings.circularCurveParameters?(d.ArcLength=d.LengthConversions.meters,d.ArcLengthConversions=f.clone(d.LengthConversions),d.ChordLength=p.getChordLengthFromArcLength(d.ArcLength,a),d.ChordLengthConversions=this._validateLength(d.ChordLength,"meters")):(d.ChordLength=d.LengthConversions.meters,d.ChordLengthConversions=f.clone(d.LengthConversions),
d.ArcLength=p.getArcLengthFromChordLength(d.ChordLength,a),d.ArcLengthConversions=this._validateLength(d.ArcLength,"meters"))):("radiusAndArcLength"===this._planSettings.circularCurveParameters&&d.ArcLengthConversions&&(d.Length=d.ArcLength,d.LengthConversions=f.clone(d.ArcLengthConversions)),d.ChordLength=0,d.ChordLengthConversions=null,d.ArcLength=0,d.ArcLengthConversions=null);return d},_onDigitizationButtonClicked:function(){k.toggle(this.screenDigitizationNode,"esriCTEnableButton");k.contains(this.screenDigitizationNode,
"esriCTEnableButton")?this.emit("activateDigitizationTool"):this.emit("deActivateDigitizationTool")},_createMiscloseDetails:function(){this._misCloseDetailsInstance=new F({nls:this.nls,config:this.config,appConfig:this.appConfig,numberFieldTypes:this.numberFieldTypes,validateNumericField:this.validateNumericField},r.create("div",{},this.misCloseDetailsNode));this._misCloseDetailsInstance.setMiscloseDetails(null)},_createParcelTools:function(){this._parcelToolInstance=new D({nls:this.nls,config:this.config},
r.create("div",{},this.parcelToolsNode));this.own(this._parcelToolInstance.on("rotateGeometries",f.hitch(this,function(d){d!==this._rotationAngle&&(this._rotationAngle=d,this._itemList&&0<this._itemList.length&&this.setStartPoint(this.startPoint))})));this.own(this._parcelToolInstance.on("scaleGeometries",f.hitch(this,function(d){d!==this._scaleValue&&(this._scaleValue=d,this._itemList&&0<this._itemList.length&&this.setStartPoint(this.startPoint))})));this.own(this._parcelToolInstance.on("toggleRotating",
f.hitch(this,function(d){this.emit("toggleRotating",d)})));this.own(this._parcelToolInstance.on("toggleScaling",f.hitch(this,function(d){this.emit("toggleScaling",d)})))},_createPlanInfo:function(){this._planInfoInstance=new E({map:this.map,nls:this.nls,config:this.config,loading:this.loading,numberFieldTypes:this.numberFieldTypes,validateNumericField:this.validateNumericField,geometryService:this.geometryService,parcelPolygonGraphicsLayer:this.parcelPolygonGraphicsLayer,parcelLinesGraphicsLayer:this.parcelLinesGraphicsLayer,
polylineLayerUnit:p.getUnitValueForSR(this.lineLayerSpatialReference),polygonLayerUnit:p.getUnitValueForSR(this.polygonLayerSpatialReference)},r.create("div",{},this.planInfoNode));this.own(this._planInfoInstance.on("cancelTraversedParcel",f.hitch(this,function(){this.emit("cancelTraverse")})));this.own(this._planInfoInstance.on("showMessage",f.hitch(this,function(d){this._showMessage(d)})));this.own(this._planInfoInstance.on("saveTraversedParcel",f.hitch(this,function(){var d;this.closePopup();if(this._itemList&&
0<this._itemList.length){var a;a=this._misCloseDetailsInstance.traverseStatedArea.get("value").trim();d=this._planInfoInstance.validateParcelDetails(a);d.status?(""===this._misCloseDetailsInstance.traverseStatedArea.get("value")&&(a=null),d={},d.itemList=this._itemList,d.statedArea=a,d.rotation=this._rotationAngle,d.scale=this._scaleValue,d.appliedCompassRule=this.appliedCompassRule,d.miscloseDetails=this._misCloseDetailsInstance.getMiscloseDetails(),d.polygonDeleteArr=this.polygonDeleteArr,d.polylineDeleteArr=
this.polylineDeleteArr,d.planSettings=this._planSettings,this._planInfoInstance.saveData(d)):this._showMessage(d.message)}else this._showMessage(this.nls.newTraverse.enterValidParcelInfoMessage)})));this.own(this._planInfoInstance.on("displayMainPageAfterSave",f.hitch(this,function(){this.emit("displayMainPageAfterSave")})))},_createTraverseGrid:function(){var d;this._nodes=[];r.empty(this.traverseGrid);this._dndContainer=new q(this.traverseGrid,{skipForm:!0,singular:!0});this._dndContainer.copyState=
function(){return!1};for(d=0;d<this._itemList.length;d++)this._createRow(this._itemList[d],d);this.own(this._dndContainer.on("DndDrop",f.hitch(this,this._onDndDrop)));this._dndContainer.insertNodes(!1,this._nodes)},_createFieldInputs:function(d,a,b,m){var u=new w({value:a,"class":b?b:""});u.placeAt(d);"esriCTBearingRow"===b?(u.validator=f.hitch(this,function(d){"*tb"!==d&&"*"===d.charAt(0)&&(d=d.slice(1));return this._bearingValidator(d,["*tb"])}),u.invalidMessage=this.nls.newTraverse.invalidBearingMessage):
"esriCTLengthRow"===b?(u.validator=f.hitch(this,this._lengthValidator),u.invalidMessage=this.nls.newTraverse.invalidLengthMessage):"esriCTRadiusRow"===b&&(u.validator=f.hitch(this,this._radiusValidator),u.invalidMessage=this.nls.newTraverse.invalidRadiusMessage);this.own(g(u,"blur",f.hitch(this,function(){var a=parseInt(A.get(d,"rowIndex"),10);this._updateParcelValues(u,a,m)})));this.own(g(u,"keypress",f.hitch(this,function(a){(a.charCode||a.keyCode)===x.ENTER&&(a=parseInt(A.get(d,"rowIndex"),10),
this._updateParcelValues(u,a,m));setTimeout(f.hitch(this,function(){u.validate(!1)}),100)})))},_createRow:function(d,a){var b,m,c;b=r.create("div",{"class":"dojoDndItem esriCTRow",rowIndex:a});m=r.create("div",{rowIndex:a},b);this._createLineSelector(m,d.LineSymbol,a);m=this._getBearingAccordingToPlanSettings(d.BearingConversions);d.isTB&&(m="*"+m);this._createFieldInputs(b,m,"esriCTBearingRow");d.RadiusConversions?(m=this._getRoundedValue(d.RadiusConversions,"Radius"),c="radiusAndArcLength"===this._planSettings.circularCurveParameters?
this._getRoundedValue(d.ArcLengthConversions,"Length"):this._getRoundedValue(d.ChordLengthConversions,"Length")):(m="",c=this._getRoundedValue(d.LengthConversions,"Length"));this._createFieldInputs(b,c,"esriCTLengthRow");this._createFieldInputs(b,m,"esriCTRadiusRow");this._createDeleteButton(b,a);this._nodes.push(b);this._dndContainer.clearItems();this._dndContainer.insertNodes(!1,this._nodes)},_createLineSelector:function(d,a,b){var m;m=new z({hideOnSelect:!0,symbolData:this.config.lineTypes},d);
k.add(m.domNode,"esriCTSymbolContainer");a?(m.selectSymbol(a),A.set(m.domNode,"rowIndex",b),m.onSelect=f.hitch(this,function(d){var a;a=parseInt(A.get(m.domNode,"rowIndex"),10);this._itemList[a].LineSymbol=d;this.setStartPoint(this.startPoint)})):m.setDefault();return m},_createDeleteButton:function(d,a){var b;b=r.create("div",{"class":"esriCTDeleteRow"},d);b=r.create("div",{"class":"esriCTDeleteIcon",rowIndex:a,title:this.nls.traverseSettings.deleteButtonTitle},b);this.own(g(b,"click",f.hitch(this,
function(a){a=parseInt(A.get(a.currentTarget,"rowIndex"),10);this._deleteRow(d,a)})))},_deleteRow:function(a,b){var d;if(this._itemList.length){this._dndContainer.delItem(a.id);r.destroy(a);this._nodes.splice(b,1);this._itemList.splice(b,1);this._dndContainer.sync();this._updateRowIndexes();if(this._itemList[b]&&this._itemList[b].isTB){if(1===this._itemList.length||0===b)this._itemList[0].isTB=!1,b++;1<this._itemList.length&&(d=this._updateTBFromIndex(b))}this.appliedCompassRule?this.setParcelClosure(!0):
this.setStartPoint(this.startPoint);d&&this._reGenerateTraverseGrid();this._showHideTraverseTools()}},_updateRowIndexes:function(){var a;a=J(".esriCTRow",this.traverseGrid);n.forEach(a,f.hitch(this,function(a,d){var b;A.set(a,"rowIndex",d);(b=J(".esriCTDeleteIcon",a)[0])&&A.set(b,"rowIndex",d);(b=J(".esriCTSymbolContainer",a)[0])&&A.set(b,"rowIndex",d)}))},_onDndDrop:function(){var a,b=[],u;this._dndContainer.sync();a=this._dndContainer.getAllNodes();a.forEach(f.hitch(this,function(a){a=parseInt(A.get(a,
"rowIndex"),10);b.push(this._itemList[a])}));this._nodes=a;this._itemList=[];this._itemList=b;this._updateRowIndexes();for(a=0;a<this._itemList.length;a++)0===a&&this._itemList[a].isTB&&(this._itemList[a].isTB=!1,u=!0),this._itemList[a]&&this._itemList[a].isTB&&(this._itemList[a]=this._setTangentBearing(this._itemList[a],this._itemList[a-1]),u=!0);this.setStartPoint(this.startPoint);u&&this._reGenerateTraverseGrid()},_updateParcelValues:function(a,b,u){var d,c,l,g=!1,H;if(d=this._itemList[b])if(l=
(l=a.get("value"))?f.trim(l.toString()):"",k.contains(a.domNode,"esriCTBearingRow")&&String(this._getBearingAccordingToPlanSettings(d.BearingConversions))!==l?(c="Bearing",d.Bearing=l,g=!0,-1===l.indexOf("*")&&(d.isTB=!1)):k.contains(a.domNode,"esriCTLengthRow")&&String(this._getRoundedValue(d.LengthConversions,"Length"))!==l?(c="Length",d.Length=l,g=!0):k.contains(a.domNode,"esriCTRadiusRow")&&String(d.Radius)!==l&&(d.RadiusConversions?String(this._getRoundedValue(d.RadiusConversions,"Radius"))!==
l&&(c="Radius",d.Radius=l,g=!0):(c="Radius",d.Radius=l,g=!0)),g)if(l=this._getValidatedValues(d,c,b)){if("Bearing"===c?(c=this._getBearingAccordingToPlanSettings(l.BearingConversions),d.Bearing=this._getBearingAccordingToPlanSettings(l.BearingConversions,!0),d.isTB&&(c="*"+c),a.set("value",c),H=this._updateTBFromIndex(b+1)):"Length"===c?(c=this._getRoundedValue(d.LengthConversions,"Length"),d.Length=d.LengthConversions[this._planSettings.distanceAndLengthUnits],d.RadiusConversions&&(d=this._createValuesForArc(d)),
a.set("value",c),H=this._updateTBFromIndex(b)):"Radius"===c&&(d.RadiusConversions?(d.Radius=d.RadiusConversions[this._planSettings.distanceAndLengthUnits],c=this._getRoundedValue(d.RadiusConversions,"Radius")):c=d.Radius="",d=this._createValuesForArc(d),a.set("value",c),H=this._updateTBFromIndex(b)),this.appliedCompassRule?this.setParcelClosure(!0):this.setStartPoint(this.startPoint),H||u)this._reGenerateTraverseGrid(),u&&this._popupCoords&&this._openPopup(this._popupCoords)}else this._updateValues(d,
c,a)},_updateValues:function(a,b,c){var d;"Bearing"===b?(a.Bearing=this._getBearingAccordingToPlanSettings(a.BearingConversions,!0),d=this._getBearingAccordingToPlanSettings(a.BearingConversions)):"Length"===b?(a.Length=a.LengthConversions[this._planSettings.distanceAndLengthUnits],d=this._getRoundedValue(a.LengthConversions,"Length")):"Radius"===b&&(a.RadiusConversions?(a.Radius=a.RadiusConversions[this._planSettings.distanceAndLengthUnits],d=this._getRoundedValue(a.RadiusConversions,"Radius")):
d=a.Radius="");c.set("value",d)},_showHideTraverseTools:function(){this._itemList&&0<this._itemList.length?(k.remove(this.expandCollapseNode,"esriCTHidden"),k.remove(this.zoomToNode,"esriCTHidden")):(k.add(this.expandCollapseNode,"esriCTHidden"),k.add(this.zoomToNode,"esriCTHidden"))},_getBearingAccordingToPlanSettings:function(a,b){if("northAzimuth"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return b?a.naDD:a.naDDRound;if("northAzimuth"===
this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return a.naDMS;if("southAzimuth"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return b?a.saDD:a.saDDRound;if("southAzimuth"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return a.saDMS;if("quadrantBearing"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return b?
a.qb3DD:a.qb3DDRound;if("quadrantBearing"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return a.qb3DMS},_getRoundedValue:function(a,b){var d,c;c=a[this._planSettings.distanceAndLengthUnits];switch(b){case "Length":d=this.lengthFieldPlaces;break;case "Radius":d=this.radiusFieldPlaces;break;case "MiscloseDistance":d=this.miscloseDistanceFieldPlaces}return l.honourPopupRounding(d,c)},_resetEntryRow:function(a){this.bearingNode.set("value",
"");this.lengthNode.set("value","");this.radiusNode.set("value","");this.bearingNode.reset();this.lengthNode.reset();this.radiusNode.reset();0<this._itemList.length&&(a=this._itemList[this._itemList.length-1].isTB?"*tb":a?this._getBearingAccordingToPlanSettings(this._itemList[this._itemList.length-1].BearingConversions):this._itemList[this._itemList.length-1].Bearing,this.bearingNode.set("value",a),this.bearingNode.textbox.setSelectionRange(0,a.length))},_reGenerateTraverseGrid:function(){this._dndContainer&&
(this._dndContainer.destroy(),this._dndContainer=null);r.empty(this.traverseGrid);this._createTraverseGrid()},_reDrawParcel:function(){this.parcelLinesGraphicsLayer.clear();this.parcelPointsGraphicsLayer.clear();this._arrayOfAllBoundaryLines=[];this._drawPoint(this.startPoint);n.forEach(this._itemList,f.hitch(this,function(a){""===a.Radius||"0"===a.Radius||0===a.Radius?this._drawStraightLine(a,!1):this._drawArc(a,!1)}));this._setExtentToLayer(this.parcelLinesGraphicsLayer);this.setParcelClosure()},
setStartPoint:function(a){var d=new G(4326);p.getProjectedGeometry(a,d,this.geometryService).then(f.hitch(this,function(d){this.startPoint=d;this._startPointForNextLine=f.clone(d);this._orgStartPointForNextLine=f.clone(d);this.appliedCompassRule=!1;0<this._itemList.length?this._reDrawParcel():(this.parcelPointsGraphicsLayer.clear(),this.parcelLinesGraphicsLayer.clear(),this._arrayOfAllBoundaryLines=[],this._drawPoint(a))}))},_addProjectedGraphic:function(a,b,c,m){var d,u={};u.rowIndex=a.graphics.length;
b.attributes=u;4326!==this.map.spatialReference.wkid?p.getProjectedGeometry(b.geometry,this.map.spatialReference,this.geometryService).then(f.hitch(this,function(l){l&&(d=new y(l),d.setAttributes(u),d.setSymbol(b.symbol),a.add(d),c&&(this._setExtentToLayer(a),m&&this.setParcelClosure()))})):(a.add(b),c&&(this._setExtentToLayer(a),m&&this.setParcelClosure()))},_drawPoint:function(a){a=new y(a,L.fromJson(this.config.pointSymbol));this._addProjectedGraphic(this.parcelPointsGraphicsLayer,a,!1,!1)},_drawLineAndEndPoint:function(a,
b,c,m){var d;d=!0;a?(b=p.getLineBetweenPoints(b))?(c=new y(b,L.fromJson(c.LineSymbol.symbol)),this._addProjectedGraphic(this.parcelLinesGraphicsLayer,c,m,!0),this._startPointForNextLine=f.clone(a),this.appliedCompassRule&&this.parcelLinesGraphicsLayer.graphics.length===this._itemList.length&&(d=!1),d&&this._drawPoint(a)):this._showMessage(this.nls.newTraverse.unableToDrawLineMessage):this._showMessage(this.nls.newTraverse.invalidEndPointMessage)},setInfoForCalculatingMisclose:function(a,b,c){a.startPoint=
f.clone(this._orgStartPointForNextLine);a.endpoint=f.clone(b);c=p.getLineBetweenPoints(c);if(a.LineSymbol.type===this.config.BoundaryLineType)for(var d=0;d<c.paths.length;d++)this._arrayOfAllBoundaryLines.push(c.paths[d]);this._orgStartPointForNextLine=f.clone(b);return a},getArcInfo:function(a,b,c,m){var d,u,l;d=p.getDestinationPoint(a,b,Math.abs(m));u=Math.abs(m)/2;l=p.getDestinationPoint(a,b,u);a={distance:m,radius:c,initBearing:b,chordMidPoint:l,centerAndChordDistance:Math.sqrt(Math.abs(c*c-u*
u)),chordEndPoint:d,chordStartPoint:a};b=p.getArcParam(a);b.startAngle=b.startAngle>b.endAngle?b.startAngle-360:b.startAngle;b=p.getPointsForArc(b.startAngle,b.endAngle,b.centerPoint,c);0===b.length&&(b.push(a.chordStartPoint),b.push(a.chordEndPoint));0>c&&b.reverse();return{endPoint:d,arcGeometryPointsArray:b}},_drawStraightLine:function(a,b){var d,c,l;d=a.BearingConversions.naDD;c=a.LengthConversions.meters;if(a.adjustedValues&&this.adjustPoints){d=a.adjustedValues.adjustedBearing;if("S"===a.BearingConversions.qb3DDRound.charAt(0)||
0>a.adjustedValues.lat)d=a.adjustedValues.adjustedBearingNADD;c=a.adjustedValues.adjustedLength;this.appliedCompassRule=!0}this._rotationAngle&&(d=Number(d)+this._rotationAngle);this._scaleValue&&(c*=this._scaleValue);l=p.getDestinationPoint(this._orgStartPointForNextLine,a.BearingConversions.naDD,a.LengthConversions.meters);d=p.getDestinationPoint(this._startPointForNextLine,d,c);a=this.setInfoForCalculatingMisclose(a,l,[this._orgStartPointForNextLine,l]);this._drawLineAndEndPoint(d,[this._startPointForNextLine,
d],a,b)},_drawArc:function(a,b){var d,c,l,g;l=a.BearingConversions.naDD;d=a.RadiusConversions.meters;c=a.ChordLengthConversions.meters;if(a.adjustedValues&&this.adjustPoints){l=a.adjustedValues.adjustedBearing;if("S"===a.BearingConversions.qb3DDRound.charAt(0)||0>a.adjustedValues.lat)l=a.adjustedValues.adjustedBearingNADD;c=a.adjustedValues.adjustedLength;0>a.ChordLengthConversions.meters&&(c*=-1);this.appliedCompassRule=!0}this._rotationAngle&&(l=Number(l)+this._rotationAngle);this._scaleValue&&
(c*=this._scaleValue,d*=this._scaleValue);g=this.getArcInfo(this._orgStartPointForNextLine,a.BearingConversions.naDD,a.RadiusConversions.meters,a.ChordLengthConversions.meters);a=this.setInfoForCalculatingMisclose(a,g.endPoint,g.arcGeometryPointsArray);d=this.getArcInfo(this._startPointForNextLine,l,d,c);this._drawLineAndEndPoint(d.endPoint,d.arcGeometryPointsArray,a,b)},_setExtentToLayer:function(a,b){var d;0<a.graphics.length&&(d=M.graphicsExtent(a.graphics),!b&&this.map.extent.contains(d)||this.map.setExtent(d.expand(1.5)))},
_showMessage:function(a){this.emit("showMessage",a)},updateAccordingToPlanSettings:function(a){this._planSettings=a;this.bearingNode.set("placeHolder",this._getAbbreviatedUnits(a.directionOrAngleUnits));this.lengthNode.set("placeHolder",this._getAbbreviatedUnits(a.distanceAndLengthUnits));this.radiusNode.set("placeHolder",this._getAbbreviatedUnits(a.distanceAndLengthUnits));this._reGenerateTraverseGrid();this._misCloseDetailsInstance&&(a=this._misCloseDetailsInstance.getMiscloseDetails())&&(a=this._getMiscloseDetailsAccordingToPlanSettings(a),
this._misCloseDetailsInstance.updateAccordingToPlanSettings(a))},deActivateDigitizationTool:function(){k.remove(this.screenDigitizationNode,"esriCTEnableButton")},pointAddedFromDigitization:function(a){var b,d,c,g;g=new G(4326);p.getProjectedGeometry(a,g,this.geometryService).then(f.hitch(this,function(a){b=p.getAngleBetweenPoints(this._startPointForNextLine,a);360===b&&(b=0);d=p.getDistanceBetweenPoints(this._startPointForNextLine,a);c=this.getAngleFromDDTOQB(b);this.bearingNode.set("value",c);"uSSurveyFeet"===
this._planSettings.distanceAndLengthUnits&&(d=l.metersToUSSurveyFeet(d));0<this._scaleValue&&(d/=this._scaleValue);this.lengthNode.set("value",d);this.radiusNode.set("value","");this._addNewItem(!0)}))},getParcelCloseDetails:function(){var a,b,c,l,g;b={isClosed:!1,compassStartPoint:null,compassEndPoint:null};c=!0;a=0;n.forEach(this._itemList,f.hitch(this,function(b,d){b.LineSymbol.type===this.config.BoundaryLineType?(0===a?l=b.startPoint:g=b.endpoint,a++):0<d&&0!==a&&(c=!1)}));1<a&&c&&(b.isClosed=
!0,b.compassStartPoint=l,b.compassEndPoint=g);return b},setParcelClosure:function(a){var b;b=this.getParcelCloseDetails();if(b.isClosed)b=this.getCalculatedMiscloseDetails(b.compassStartPoint,b.compassEndPoint),this._misCloseDetailsInstance.setMiscloseDetails(b),b.adjustPoints?((this.adjustPoints=this._applyCompassRule(b))&&!this.appliedCompassRule||a)&&this.setStartPoint(this.startPoint):(this.adjustPoints=!1,(this.appliedCompassRule||a)&&this.setStartPoint(this.startPoint));else if(this._misCloseDetailsInstance.setMiscloseDetails(null),
this.adjustPoints=!1,this.appliedCompassRule||a)this.appliedCompassRule=!1,this.setStartPoint(this.startPoint)},_getMiscloseDetailsAccordingToPlanSettings:function(a){var b,d;b={};a.BearingConversions&&(b.miscloseBearing=this._getBearingAccordingToPlanSettings(a.BearingConversions));d=this._getRoundedValue(a.LengthConversions,"MiscloseDistance");b.miscloseDistance=d+" "+this._getAbbreviatedUnits(this._planSettings.distanceAndLengthUnits);a.AreaConversions?(a=a.AreaConversions[this._planSettings.areaUnits],
isNaN(parseFloat(a))||(a=parseFloat(a).toFixed(3))):a=0;a=a+" "+this._getAbbreviatedUnits(this._planSettings.areaUnits);b.calculatedArea=a;return b},getCalculatedMiscloseDetails:function(a,b){var d,c,g={};d=d=c=0;var e=!1,y;if(b&&a){d=p.getAngleBetweenPoints(b,a);c=p.getDistanceBetweenPoints(b,a);0===c&&(d=0);d=this.getAngleFromDDTOQB(d);if(d=l.categorizeBearingFormat(d,this._planSettings))g.BearingConversions=d;g.AreaConversions=this._getCalculatedArea();y=this._getMiscloseRatioInfo(c);d=y.miscloseRatio;
g.miscloseValue=y.miscloseValue;c=l.categorizeLengthFormat(c,"meters");g.LengthConversions=c;c=c[this.config.miscloseSnapDistanceUnit+"Round"];1E5<=d&&(e=!0);g.miscloseRatio=d;g.accuracy=e;g=f.mixin(g,this._getMiscloseDetailsAccordingToPlanSettings(g));if(0<c&&c<=this.config.miscloseSnapDistance||isFinite(d)&&d>=this.config.miscloseRatioSnap)g.adjustPoints=!0,g.compassCompleteLength=y.compassCompleteLength}return g},_getCalculatedArea:function(){var a,b;this._arrayOfAllBoundaryLines&&0<this._arrayOfAllBoundaryLines.length&&
(b=p.getPolygonFromPolyLines(this._arrayOfAllBoundaryLines,!0))&&(a=new y(b),this.parcelPolygonGraphicsLayer.clear(),this.parcelPolygonGraphicsLayer.add(a),a=p.getAreaOfGeometry(b));return a},_applyCompassRule:function(a){var b,d,c,l,g,e;g=l=0;e={};for(c=0;c<this._itemList.length;c++)d=this._itemList[c],d.LineSymbol.type===this.config.BoundaryLineType&&(""===d.Radius||"0"===d.Radius||0===d.Radius?b=d.LengthConversions.meters:d.ChordLengthConversions&&(b=d.ChordLengthConversions.meters),b=Math.abs(b),
d.lat=b*Math.cos(Math.PI/180*d.BearingConversions.naDD),d.dep=b*Math.sin(Math.PI/180*d.BearingConversions.naDD),l+=d.lat,g+=d.dep);e.sumOfLat=l;e.sumOfDep=g;e.sumOfAllLinesLength=a.compassCompleteLength;for(c=0;c<this._itemList.length;c++)d=this._itemList[c],""===d.Radius||"0"===d.Radius||0===d.Radius?b=d.LengthConversions.meters:d.ChordLengthConversions&&(b=d.ChordLengthConversions.meters),b=Math.abs(b),d.LineSymbol.type===this.config.BoundaryLineType&&(d.adjustedValues=this._adjustBearingAndDistance(d.lat,
d.dep,b,e));for(c=b=a=0;c<this._itemList.length;c++)d=this._itemList[c],d.LineSymbol.type===this.config.BoundaryLineType&&(a+=parseFloat(d.adjustedValues.lat.toFixed(2)),b+=parseFloat(d.adjustedValues.dep.toFixed(2)),a=parseFloat(a.toFixed(2)),b=parseFloat(b.toFixed(2)));return 0===parseInt(a,10)&&0===parseInt(b,10)?!0:!1},_adjustBearingAndDistance:function(a,b,c,g){var d,m;d={};a=parseFloat(a.toFixed(6));b=parseFloat(b.toFixed(6));c=parseFloat(c.toFixed(6));m=-g.sumOfLat/g.sumOfAllLinesLength*c;
c*=-g.sumOfDep/g.sumOfAllLinesLength;m=parseFloat(m.toFixed(6));c=parseFloat(c.toFixed(6));b+=c;a=parseFloat((a+m).toFixed(6));b=parseFloat(b.toFixed(6));m=Math.sqrt(Math.pow(a,2)+Math.pow(b,2));c=Math.atan(b/a);c=parseFloat(c.toFixed(6));d.lat=a;d.dep=b;d.adjustedLength=m;d.adjustedBearing=180/Math.PI*c;a=l.categorizeBearingFormat(d.adjustedBearing,{directionOrAngleType:"southAzimuth",directionOrAngleUnits:"decimalDegree"});d.adjustedBearingNADD=a.naDD;return d},_getMiscloseRatioInfo:function(a){var b,
d=b=0,c;c=0;this._arrayOfAllBoundaryLines&&0<this._arrayOfAllBoundaryLines.length&&(b=p.getPolyLineFromPaths(this._arrayOfAllBoundaryLines),b=p.getLengthOfGeometry(b),0<b&&(d=1/(a/b),10>d?d=0:1E5>d&&(c=parseInt(d,10),d="1:"+parseInt(d,10))));return{miscloseRatio:d,miscloseValue:c,compassCompleteLength:b}},getAngleFromDDTOQB:function(a){var b,d;d=f.clone(this._planSettings);d.directionOrAngleType="northAzimuth";d.directionOrAngleUnits="decimalDegree";(a=l.categorizeBearingFormat(a,d))&&(b="degreeMinuteSeconds"===
this._planSettings.directionOrAngleUnits?a.qb3DMS:a.qb3DD);return b},initEditing:function(a,b,c){var d,g,e,y,w;this._planInfoInstance.setParcelInformation(this.polygonDeleteArr);d=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.rotation.name];(e=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.scale.name])||(e=1);g=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.statedArea.name];this._parcelToolInstance.setRotation(d);this._parcelToolInstance.setScale(e);null!==
g&&void 0!==g&&this._misCloseDetailsInstance.traverseStatedArea.set("value",g);e=[];y=p.getUnitValueForSR(c);w=f.clone(this._planSettings);w.directionOrAngleType="northAzimuth";w.directionOrAngleUnits="decimalDegree";for(c=0;c<b.features.length;c++){d={};d.Bearing=b.features[c].attributes[this.config.polylineLayer.bearing.name];d.BearingConversions=l.categorizeBearingFormat(d.Bearing,w);d.Bearing=this._getBearingAccordingToPlanSettings(d.BearingConversions,!0);d.Length=b.features[c].attributes[this.config.polylineLayer.distance.name];
null!==d.Length&&""!==d.Length&&(d.LengthConversions=this._validateLength(d.Length,y),d.Length=d.LengthConversions[this._planSettings.distanceAndLengthUnits]);if(g=this.getLineSymbolForType(b.features[c].attributes[this.config.polylineLayer.lineType.name]))d.LineSymbol=g;d.Radius=b.features[c].attributes[this.config.polylineLayer.radius.name];null!==d.Radius&&""!==d.Radius?(d.RadiusConversions=this._validateLength(d.Radius,y),d.Radius=d.RadiusConversions[this._planSettings.distanceAndLengthUnits],
d.ArcLength=b.features[c].attributes[this.config.polylineLayer.arcLength.name],null!==d.ArcLength&&""!==d.ArcLength&&(d.ArcLengthConversions=this._validateLength(d.ArcLength,y),d.ArcLength=d.ArcLengthConversions[this._planSettings.distanceAndLengthUnits]),d.ChordLength=b.features[c].attributes[this.config.polylineLayer.chordLength.name],null!==d.ChordLength&&""!==d.ChordLength&&(d.ChordLengthConversions=this._validateLength(d.ChordLength,y),d.ChordLength=d.ChordLengthConversions[this._planSettings.distanceAndLengthUnits]),
"radiusAndArcLength"===this._planSettings.circularCurveParameters?(d.Length=d.ArcLength,d.LengthConversions=f.clone(d.ArcLengthConversions)):(d.Length=d.ChordLength,d.LengthConversions=f.clone(d.ChordLengthConversions))):(d.Radius="",d.RadiusConversions=null);e.push(d)}this._itemList=e;this._reGenerateTraverseGrid();this._showHideTraverseTools();this.setStartPoint(a);this.setBoundaryLineSymbol()},setBoundaryLineSymbol:function(){this._symbolSelector&&n.some(this.config.lineTypes,f.hitch(this,function(a){if(this.config.BoundaryLineType===
a.type)return this._symbolSelector.selectSymbol(a),!1}))},getLineSymbolForType:function(a){var b;n.some(this.config.lineTypes,f.hitch(this,function(d){if(d.type===a)return b=f.clone(d),!0}));return b},deactivateParcelTools:function(){this._parcelToolInstance.disableRotating();this._parcelToolInstance.disableScaling()},clearAll:function(){this.parcelLinesGraphicsLayer.clear();this.parcelPointsGraphicsLayer.clear();this.parcelPolygonGraphicsLayer.clear();this._resetEntryRow();this._dndContainer.clearItems();
r.empty(this.traverseGrid);this._itemList=[];this._nodes=[];this._showHideTraverseTools();this._orgStartPointForNextLine=this._startPointForNextLine=this.startPoint=null;this._rotationAngle=0;this._scaleValue=1;this._symbolSelector.setDefault();k.remove(this.screenDigitizationNode,"esriCTEnableButton");this._parcelToolInstance.resetTools();this.deactivateParcelTools();this._misCloseDetailsInstance.setMiscloseDetails(null);this._arrayOfAllBoundaryLines=[];this.polygonDeleteArr=[];this.polylineDeleteArr=
[];this.domNode.scrollTop=0;this._planInfoInstance.resetValues();this._misCloseDetailsInstance.traverseStatedArea.set("value",null);this.closePopup()},_showParcelPopup:function(a){var b,d,c=[];b=new N;d=this._pointToExtent(a.mapPoint,8);c=n.filter(this.parcelLinesGraphicsLayer.graphics,function(a){return d.intersects(a.geometry)});c[0]?(this._createPopupContent(a,c[0]),b.resolve(!0)):(this.closePopup(),b.resolve(!1));return b},_getAbbreviatedUnits:function(a){return window.jimuNls.units[a+"Abbr"]},
_pointToExtent:function(a,b){var d;d=this.map.extent.getWidth()/this.map.width;d*=b;return new O(a.x-d,a.y-d,a.x+d,a.y+d,this.map.spatialReference)},_createPopupContent:function(a,b){var d,c,g,l;if(l=this._itemList[b.attributes.rowIndex])d=r.create("div",{"class":"esriCTParcelInfoPopup "+this.baseClass},null),c=r.create("div",{"class":"esriCTLabelRows"},d),this._createFieldLabels(c,this.nls.traverseSettings.bearingLabel),this._createFieldLabels(c,this.nls.traverseSettings.lengthLabel),this._createFieldLabels(c,
this.nls.traverseSettings.radiusLabel),c=r.create("div",{"class":"esriCTRowContainer esriCTRow",rowIndex:b.attributes.rowIndex},d),this._createFieldInputs(c,this._getBearingAccordingToPlanSettings(l.BearingConversions),"esriCTBearingRow",!0),(g=l.RadiusConversions)?(g=this._getRoundedValue(l.RadiusConversions,"Radius"),l="radiusAndArcLength"===this._planSettings.circularCurveParameters?this._getRoundedValue(l.ArcLengthConversions,"Length"):this._getRoundedValue(l.ChordLengthConversions,"Length")):
(g="",l=this._getRoundedValue(l.LengthConversions,"Length")),this._createFieldInputs(c,l,"esriCTLengthRow",!0),this._createFieldInputs(c,g,"esriCTRadiusRow",!0),K.position(this.traverseEntryNode)&&K.position(this.traverseEntryNode).w&&(c=K.position(this.traverseEntryNode).w-42,t.set(this._popupDialog.domNode,"width",c+"px")),this._popupDialog.setContent(d),this._popupCoords={pageX:a.pageX,pageY:a.pageY},this._openPopup(a)},_openPopup:function(a){t.set(this._popupDialog.domNode,"opacity",.9);B.open({popup:this._popupDialog,
x:a.pageX,y:a.pageY})},closePopup:function(){this._popupDialog&&B.close(this._popupDialog)},_createFieldLabels:function(a,b){r.create("div",{innerHTML:b,title:b,"class":"esriCTParcelInfoLabels"},a)},_createTooltip:function(){this._popupDialog=new C({"class":"esriCTEditParcelDialog"});this._popupDialog.startup()},validateNumericField:function(a,b){var d,c=/^[-+]?[0-9]+\.[0-9]+$/,l=/^[-+]?[0-9]+$/;a=f.trim(a);switch(b){case "esriFieldTypeSmallInteger":d=parseInt(a,10);d=a.match(l)&&-32768<=d&&32767>=
d&&0!==a.length?!0:!1;break;case "esriFieldTypeInteger":d=parseInt(a,10);d=a.match(l)&&-2147483648<=d&&2147483647>=d&&0!==a.length?!0:!1;break;case "esriFieldTypeSingle":d=parseFloat(a);d=(a.match(l)||a.match(c))&&d>=-3.4*Math.pow(10,38)&&d<=1.2*Math.pow(10,38)&&0!==a.length?!0:!1;break;case "esriFieldTypeDouble":d=parseFloat(a),d=(a.match(l)||a.match(c))&&d>=-2.2*Math.pow(10,308)&&d<=1.8*Math.pow(10,38)&&0!==a.length?!0:!1}return d}})})},"widgets/ParcelDrafter/SymbolSelector":function(){define("dojo/_base/declare jimu/BaseWidget dojo/_base/lang dojo/on dojo/dom-construct dojo/_base/array jimu/symbolUtils esri/symbols/jsonUtils dijit/popup dijit/TooltipDialog dojo/_base/html".split(" "),
function(e,b,a,c,h,f,n,k,r,t,q){return e([b],{_tooltipDialog:null,selectedSymbol:null,symbolData:[],constructor:function(b){a.mixin(this,b)},postCreate:function(){this.symbolData||(this.symbolData=[]);this._createSelectedSymbolNode();this._hideTooltipDialog();this.symbolData&&0<this.symbolData.length&&(this._createTooltipDialog(),this.selectSymbol(this.symbolData[0]));this.own(c(document.body,"click",a.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})))},
setDefault:function(){this.selectSymbol(this.symbolData[0])},_createSelectedSymbolNode:function(){var a=h.create("div",{},this.domNode);this.selectedSymbolNode=h.create("div",{"class":"esriCTSelectedSymbol"},a)},_createTooltipDialog:function(){var b=this._createSymbolListMenu();this._tooltipDialog=new t({content:b,"class":"esriCTSymbolPopup"});this.own(c(this.domNode,"click",a.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));
this.own(c(document.body,"click",a.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})))},_createSymbolListMenu:function(){var b,c;b=h.create("div",{"class":"esriCTSymbolListContainer"},null);c=h.create("div",{"class":"esriCTSymbolListContent"},b);f.forEach(this.symbolData,a.hitch(this,function(a){var b,g;b=h.create("div",{"class":"esriCTSymbolOption",title:a.label},c);this._attachRowClick(b,a);g=h.create("div",{"class":"esriCTSymbolIcon"},b);h.create("div",
{"class":"esriCTSymbolName",innerHTML:a.label},b);b=h.create("div",{},g);this._createSymbol(a,b)}));return b},_attachRowClick:function(b,e){this.own(c(b,"click",a.hitch(this,function(){this.selectSymbol(e);this.hideOnSelect&&this._hideTooltipDialog()})))},_createSymbol:function(a,b){var c;a&&(c=k.fromJson(a.symbol),(c=n.createSymbolNode(c))||(c=h.create("div")),h.place(c,b))},selectSymbol:function(a){h.empty(this.selectedSymbolNode);this.selectedSymbol={label:a.label||a.type,type:a.type,symbol:a.symbol};
this._createSymbol(this.selectedSymbol,this.selectedSymbolNode);this.onSelect(a)},destroy:function(){r.close(this._tooltipDialog);this._tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b;b=this._tooltipDialog.domNode;return a===b||q.isDescendant(a,b)},onSelect:function(a){return a},_showTooltipDialog:function(){r.open({parent:this.getParent(),popup:this._tooltipDialog,around:this.domNode,"class":"esriCTSymbolPopup"});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){r.close(this._tooltipDialog);
this._isTooltipDialogOpened=!1}})})},"widgets/ParcelDrafter/MiscloseDetails":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./MiscloseDetails.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/dom-attr".split(" "),function(e,b,a,c,h,f,n,k){return e([b,a,f],{baseClass:"jimu-widget-ParcelDrafter-MisclosedDetails",templateString:c,details:null,constructor:function(a){h.mixin(this,a)},postCreate:function(){this.inherited(arguments);n.add(this.domNode,
"esriCTFullWidth");this.config.polygonLayer.statedArea&&this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(n.remove(this.traverseStatedAreaNode,"esriCTHidden"),this.traverseStatedArea.trim=!0,this.config.polygonLayer.statedArea.nullable||(this.traverseStatedArea.required=!0),0<=this.numberFieldTypes.indexOf(this.config.polygonLayer.statedArea.type)&&(this.traverseStatedArea.validator=h.hitch(this,function(a){return!this.config.polygonLayer.statedArea.nullable&&(null===a||""===a)||""!==a&&
!this.validateNumericField(a,this.config.polygonLayer.statedArea.type)?!1:!0})));this._setBackgroundColorForDartTheme()},_setBackgroundColorForDartTheme:function(){"DartTheme"===this.appConfig.theme.name&&n.add(this.traverseDetailsContainer,"esriCTMiscloseHeaderDiv")},getMiscloseDetails:function(){return this.details},updateAccordingToPlanSettings:function(a){k.set(this.miscloseBearingNode,"innerHTML",a.miscloseBearing);k.set(this.miscloseDistanceNode,"innerHTML",a.miscloseDistance);k.set(this.calculatedAreaNode,
"innerHTML",a.calculatedArea)},setMiscloseDetails:function(a){(this.details=a)?(k.set(this.miscloseBearingNode,"innerHTML",a.miscloseBearing),k.set(this.miscloseDistanceNode,"innerHTML",a.miscloseDistance),0!==a.miscloseRatio?(n.remove(this.traverseMiscloseRatioNode,"esriCTHidden"),k.set(this.miscloseRatioNode,"innerHTML",a.miscloseRatio)):n.add(this.traverseMiscloseRatioNode,"esriCTHidden"),a.accuracy?(n.add(this.traverseMiscloseRatioNode,"esriCTHidden"),n.remove(this.traverseAccuracyNode,"esriCTHidden")):
n.add(this.traverseAccuracyNode,"esriCTHidden"),a.calculatedArea?(k.set(this.calculatedAreaNode,"innerHTML",a.calculatedArea),n.remove(this.traverseCalculatedAreaNode,"esriCTHidden")):n.add(this.traverseCalculatedAreaNode,"esriCTHidden"),n.add(this.noMiscloseCalculated,"esriCTHidden"),n.remove(this.miscloseDetailsContainer,"esriCTHidden")):(n.add(this.miscloseDetailsContainer,"esriCTHidden"),n.remove(this.noMiscloseCalculated,"esriCTHidden"))}})})},"widgets/ParcelDrafter/ParcelTools":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./ParcelTools.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/on dojo/keys dijit/form/NumberTextBox".split(" "),
function(e,b,a,c,h,f,n,k,r){return e([b,a,f],{baseClass:"jimu-widget-ParcelDrafter-ParcelTools",templateString:c,rotationAngle:0,scaledValue:1,constructor:function(a){h.mixin(this,a)},postCreate:function(){this.inherited(arguments);n.add(this.domNode,"esriCTFullWidth");this.rotationTxt.constraints={min:-360,max:360,places:3};this.scaleTxt.constraints={min:.1,places:3};this.rotationTxt.set("value",this.rotationAngle);this.scaleTxt.set("value",this.scaledValue);this.own(k(this.rotationTxt,"blur",h.hitch(this,
function(){this.setRotation(this.rotationTxt.displayedValue)})));this.own(k(this.scaleTxt,"blur",h.hitch(this,function(){this.setScale(this.scaleTxt.displayedValue)})));this.own(k(this.rotateButton,"click",h.hitch(this,function(){this._toggleRotating()})));this.own(k(this.scaleButton,"click",h.hitch(this,function(){this._toggleScaling()})));this.own(k(this.rotationTxt,"keypress",h.hitch(this,function(a){(a.charCode||a.keyCode)===r.ENTER&&this.setRotation(this.rotationTxt.displayedValue)})));this.own(k(this.scaleTxt,
"keypress",h.hitch(this,function(a){(a.charCode||a.keyCode)===r.ENTER&&this.setScale(this.scaleTxt.displayedValue)})))},setScale:function(a){var b=this.scaledValue;isNaN(Number(a))||(this.scaleTxt.set("value",Number(a)),this.scaleTxt.set("value",Number(this.scaleTxt.displayedValue)));this.scaleTxt.isValid()?this.scaleGeometries():(this.scaleTxt.set("value",Number(b)),this.scaleTxt.set("value",Number(this.scaleTxt.displayedValue)))},scaleGeometries:function(){var a;a=Number(this.scaleTxt.get("value"));
isNaN(a)||(this.scaledValue=a,this.emit("scaleGeometries",a))},setRotation:function(a){var b=this.rotationAngle;isNaN(Number(a))||(this.rotationTxt.set("value",Number(a)),this.rotationTxt.set("value",Number(this.rotationTxt.displayedValue)));this.rotationTxt.isValid()?this.rotateGeometries():(this.rotationTxt.set("value",Number(b)),this.rotationTxt.set("value",Number(this.rotationTxt.displayedValue)))},rotateGeometries:function(){var a;a=Number(this.rotationTxt.get("value"));isNaN(a)||(this.rotationAngle=
a,this.emit("rotateGeometries",a))},resetTools:function(){this.rotationAngle=0;this.scaledValue=1;this.rotationTxt.set("value",Number(0));this.scaleTxt.set("value",Number(1))},_toggleRotating:function(){n.contains(this.rotateButton.parentElement,"esriCTDisableButton")?(n.remove(this.rotateButton.parentElement,"esriCTDisableButton"),this.disableScaling(),this.emit("toggleRotating",!0)):(this.disableRotating(),this.emit("toggleRotating",!1))},_toggleScaling:function(){n.contains(this.scaleButton.parentElement,
"esriCTDisableButton")?(n.remove(this.scaleButton.parentElement,"esriCTDisableButton"),this.disableRotating(),this.emit("toggleScaling",!0)):(this.disableScaling(),this.emit("toggleScaling",!1))},disableRotating:function(){n.add(this.rotateButton.parentElement,"esriCTDisableButton")},disableScaling:function(){n.add(this.scaleButton.parentElement,"esriCTDisableButton")}})})},"widgets/ParcelDrafter/PlanInfo":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./PlanInfo.html dojo/_base/lang dojo/_base/array dojo/Evented dojo/dom-class dijit/form/ValidationTextBox dojo/store/Memory dijit/form/ComboBox dojo/on esri/geometry/Polyline esri/graphic esri/tasks/query esri/tasks/QueryTask jimu/dijit/Message ./geometryUtils".split(" "),
function(e,b,a,c,h,f,n,k,r,t,q,g,w,z,F,D,E,p){return e([b,a,n],{baseClass:"jimu-widget-ParcelDrafter-PlanInfo",templateString:c,_itemList:null,_polygonLayer:null,parcelNameTextBox:null,planNameTextBox:null,documentTypeControl:null,planSettings:null,_savedPolygonObjectId:null,constructor:function(a){h.mixin(this,a)},postCreate:function(){this.inherited(arguments);k.add(this.domNode,"esriCTFullWidth");this.config.polygonLayer.documentType.hasOwnProperty("name")&&(k.remove(this.documentTypeRow,"esriCTHidden"),
this._createDocumentTypeControl());this.config.polygonLayer.parcelName.hasOwnProperty("name")&&(k.remove(this.parcelNameRow,"esriCTHidden"),this.parcelNameTextBox=this._createFieldInputs(this.config.polygonLayer.parcelName,this.parcelName,this.nls.planInfo.parcelNamePlaceholderText,!this.config.polygonLayer.parcelName.nullable));this.config.polygonLayer.planName.hasOwnProperty("name")&&(k.remove(this.planNameRow,"esriCTHidden"),this.planNameTextBox=this._createFieldInputs(this.config.polygonLayer.planName,
this.planName,this.nls.planInfo.planNamePlaceholderText,!this.config.polygonLayer.planName.nullable));this.own(g(this.planInfoCancelButton,"click",h.hitch(this,function(){this.emit("cancelTraversedParcel")})));this.own(g(this.planInfoSaveButton,"click",h.hitch(this,function(){this.emit("saveTraversedParcel")})))},resetValues:function(){this.parcelNameTextBox&&this.parcelNameTextBox.set("value","");this.planNameTextBox&&this.planNameTextBox.set("value","");this.documentTypeControl&&(this.config.polygonLayer.documentType.domain?
this.documentTypeControl.set("item",null):this.documentTypeControl.set("value",""))},_showMessage:function(a){this.emit("showMessage",a)},_createDocumentTypeControl:function(){this.config.polygonLayer.documentType.domain?(this.documentTypeControl=this._createFieldSelect(this.documentType,this.nls.planInfo.parcelDocumentTypeText,!this.config.polygonLayer.documentType.nullable),this.own(g(this.documentTypeControl,"change",h.hitch(this,function(a){""===a||null===a||void 0===a||this.documentTypeControl.store.data.some(function(b){return b.name===
a})||(this.documentTypeControl.set("item",null),this._showMessage(this.nls.planInfo.enterValidDocumentTypeMessage))})))):this.documentTypeControl=this._createFieldInputs(this.config.polygonLayer.documentType,this.documentType,this.nls.planInfo.parcelDocumentTypeText,!this.config.polygonLayer.documentType.nullable)},_createFieldInputs:function(a,b,c,g){c=g?c+" "+this.nls.planInfo.requiredText:c+" "+this.nls.planInfo.optionalText;c=new r({placeHolder:c,"class":"esriCTFullWidth",required:g});0<=this.numberFieldTypes.indexOf(a.type)&&
(c.validator=h.hitch(this,function(b){return""===b||this.validateNumericField(b,a.type)?!0:!1}));c.placeAt(b);return c},_createFieldSelect:function(a,b,c){var l;l=this._createDocTypeDataArr();l=new t({data:l});b=c?b+" "+this.nls.planInfo.requiredText:b+" "+this.nls.planInfo.optionalText;return this.selectBox=new q({placeHolder:b,"class":"esriCTFullWidth",required:c,store:l},a)},_createDocTypeDataArr:function(){var a=[];this.config.polygonLayer.documentType.domain.codedValues&&f.forEach(this.config.polygonLayer.documentType.domain.codedValues,
h.hitch(this,function(b){a.push({name:b.name,id:b.code})}));return a},saveData:function(a){if(a.miscloseDetails&&(0===a.miscloseDetails.LengthConversions.meters||a.appliedCompassRule))this._saveParcel(a);else{var b;b=new E({message:this.nls.planInfo.saveNonClosedParcelConfirmationMessage,type:"question",buttons:[{label:this.nls.common.yes,onClick:h.hitch(this,function(){b.close();this._saveParcel(a)})},{label:this.nls.common.no}]})}},_saveParcel:function(a){this._itemList=a.itemList;this.planSettings=
a.planSettings;a.miscloseDetails&&(0===a.miscloseDetails.LengthConversions.meters||a.appliedCompassRule)?0===a.polygonDeleteArr.length?this._createPolygonData(a):this._deletePolygonBeforeSaving(a):0<a.polygonDeleteArr.length?this._deletePolygonBeforeSaving(a):this._createPolylineData(null)},_createParcelPolygon:function(){var a,b,c,g,e;c=[];g=this.parcelLinesGraphicsLayer.graphics;for(a=0;a<g.length;a++)if(this._itemList[a].LineSymbol.type===this.config.BoundaryLineType)for(b=0;b<g[a].geometry.paths.length;b++)c.push(g[a].geometry.paths[b]);
0<c.length&&(e=p.getPolygonFromPolyLines(c,!1,!0,g[0].geometry.spatialReference))&&(this.parcelPolygonGraphicsLayer.clear(),a=new z(e),this.parcelPolygonGraphicsLayer.add(a),e=this.parcelPolygonGraphicsLayer.graphics[0].geometry);return e},_createPolygonData:function(a){var b,c,g,l,e;a.miscloseDetails&&(0===a.miscloseDetails.LengthConversions.meters||a.appliedCompassRule)?(this.loading.show(),b=[],c={},e=this.polygonLayerUnit,l=null,this.documentTypeControl&&(this.config.polygonLayer.documentType.domain?
this.documentTypeControl.hasOwnProperty("item")&&this.documentTypeControl.item&&this.documentTypeControl.item.hasOwnProperty("id")&&(l=this.documentTypeControl.item.id):""!==this.documentTypeControl.get("value")&&(l=this.documentTypeControl.get("value"))),(g=this._createParcelPolygon())?(c[this.config.polygonLayer.rotation.name]=a.rotation,c[this.config.polygonLayer.scale.name]=a.scale,c[this.config.polygonLayer.miscloseRatio.name]=a.miscloseDetails.miscloseValue,c[this.config.polygonLayer.miscloseDistance.name]=
this._getValueAccToFeatureLayerUnit(e,a.miscloseDetails,"LengthConversions"),this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(c[this.config.polygonLayer.statedArea.name]=a.statedArea),this.parcelNameTextBox&&(c[this.config.polygonLayer.parcelName.name]=this.parcelNameTextBox.get("value")),this.planNameTextBox&&(c[this.config.polygonLayer.planName.name]=this.planNameTextBox.get("value")),this.documentTypeControl&&(c[this.config.polygonLayer.documentType.name]=l),a=new z(g,null,c),b.push(a),
this._saveParcelPolygon(b)):this._showMessage(this.nls.planInfo.unableToCreatePolygonParcel)):this._createPolylineData(null)},setParcelInformation:function(a){this.parcelNameTextBox&&this.parcelNameTextBox.set("value",a[0].attributes[this.config.polygonLayer.parcelName.name]);this.planNameTextBox&&this.planNameTextBox.set("value",a[0].attributes[this.config.polygonLayer.planName.name]);this.documentTypeControl&&(a=a[0].attributes[this.config.polygonLayer.documentType.name],null!==a&&""!==a&&void 0!==
a&&(this.config.polygonLayer.documentType.domain?this.documentTypeControl.set("item",this.documentTypeControl.store.get(a)):this.documentTypeControl.set("value",a)))},_rollbackSavedPolygon:function(){var a,b;b={attributes:{}};(a=this.map.getLayer(this.config.polygonLayer.id))&&null!==this._savedPolygonObjectId&&(b.attributes[a.objectIdField]=this._savedPolygonObjectId,a.applyEdits(null,null,[b]))},_rollbackSavedPolyLines:function(a){var b,c,g;c=[];b=this.map.getLayer(this.config.polylineLayer.id);
f.forEach(a,h.hitch(this,function(a){g={attributes:{}};g.attributes[b.objectIdField]=a.objectId;c.push(g)}));b&&0<c.length&&b.applyEdits(null,null,c)},_deletePolygonBeforeSaving:function(a){(this._polygonLayer=this.map.getLayer(this.config.polygonLayer.id))?this._polygonLayer.applyEdits(null,null,a.polygonDeleteArr,h.hitch(this,function(){this._deleteLinesBeforeSaving(a)}),h.hitch(this,function(){this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)})):this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)},
_deleteLinesBeforeSaving:function(a){var b;(b=this.map.getLayer(this.config.polylineLayer.id))?b.applyEdits(null,null,a.polylineDeleteArr,h.hitch(this,function(){this._createPolygonData(a)}),h.hitch(this,function(){this._showMessage(this.nls.planInfo.unableToUpdateParcelLines)})):this._showMessage(this.nls.planInfo.unableToUpdateParcelLines)},_saveParcelPolygon:function(a){(this._polygonLayer=this.map.getLayer(this.config.polygonLayer.id))?(this._savedPolygonObjectId=null,this._polygonLayer.applyEdits(a,
null,null,h.hitch(this,function(a){a&&0<a.length&&a[0].success?(this._savedPolygonObjectId=a[0].objectId,this._polygonLayer.refresh(),a=new F,a.objectIds=[this._savedPolygonObjectId],a.returnGeometry=!1,a.outFields=[this.config.polygonLayer.relatedGUID.name],(new D(this._polygonLayer.url)).execute(a,h.hitch(this,function(a){this.loading.hide();this._createPolylineData(a.features[0].attributes[this.config.polygonLayer.relatedGUID.name])}),h.hitch(this,function(){this.loading.hide();this._showMessage(this.nls.planInfo.unableToSaveParcelLines)}))):
(this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSavePolygonParcel))}),h.hitch(this,function(){this.loading.hide();this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)}))):(this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSavePolygonParcel))},_getValueAccToFeatureLayerUnit:function(a,b,c){if(b.hasOwnProperty(c)&&b[c])switch(a){case "meters":case "degrees":return b[c].meters;case "feet":return b[c].feet;case "uSSurveyFeet":return b[c].uSSurveyFeet;default:return null}else return null},
_createPolylineData:function(a){var b,c,g,e,l,f;this.loading.show();l=this.parcelLinesGraphicsLayer.graphics;g=this.polylineLayerUnit;f=this._itemList;e=[];for(var p=0;p<l.length;p++)b={},c=f[p],b[this.config.polylineLayer.bearing.name]=c.BearingConversions.naDD,b[this.config.polylineLayer.distance.name]=this._getValueAccToFeatureLayerUnit(g,c,"LengthConversions"),b[this.config.polylineLayer.lineType.name]=c.LineSymbol.type,b[this.config.polylineLayer.radius.name]=this._getValueAccToFeatureLayerUnit(g,
c,"RadiusConversions"),null!==b[this.config.polylineLayer.radius.name]&&""!==b[this.config.polylineLayer.radius.name]&&void 0!==b[this.config.polylineLayer.radius.name]?(b[this.config.polylineLayer.arcLength.name]=this._getValueAccToFeatureLayerUnit(g,c,"ArcLengthConversions"),c=this._getValueAccToFeatureLayerUnit(g,c,"ChordLengthConversions"),b[this.config.polylineLayer.chordLength.name]=c,b[this.config.polylineLayer.distance.name]=c):(b[this.config.polylineLayer.arcLength.name]=null,b[this.config.polylineLayer.chordLength.name]=
null),b[this.config.polylineLayer.relatedGUID.name]=a,b[this.config.polylineLayer.sequenceId.name]=p,c=l[p].geometry.toJson(),c=new w(c),b=new z(c,null,b,null),e.push(b);this._saveParcelLines(e)},_saveParcelLines:function(a){var b;(b=this.map.getLayer(this.config.polylineLayer.id))?b.applyEdits(a,null,null,h.hitch(this,function(b){var c=[],g=[];f.forEach(b,function(a){a.success?g.push(a):c.push(a)});0<c.length?(this._rollbackSavedPolygon(),0<g.length&&c.length!==a.length&&this._rollbackSavedPolyLines(g),
this._showMessage(this.nls.planInfo.unableToSaveParcelLines)):(this._showMessage(this.nls.planInfo.parcelSavedSuccessMessage),this._savedPolygonObjectId=null,this.emit("displayMainPageAfterSave"));this.loading.hide()}),h.hitch(this,function(){this._rollbackSavedPolygon();this.loading.hide();this._showMessage(this.nls.planInfo.unableToSaveParcelLines)})):(this._rollbackSavedPolygon(),this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSaveParcelLines))},validateParcelDetails:function(a){var b=
{};if(this.parcelNameTextBox&&!this.parcelNameTextBox.isValid())return b.status=!1,b.message=this.nls.planInfo.enterValidParcelNameMessage,b;if(this.planNameTextBox&&!this.planNameTextBox.isValid())return b.status=!1,b.message=this.nls.planInfo.enterValidPlanNameMessage,b;if(this.documentTypeControl&&!this.documentTypeControl.isValid())return b.status=!1,b.message=this.nls.planInfo.enterValidDocumentTypeMessage,b;if(this.config.polygonLayer.statedArea&&this.config.polygonLayer.statedArea.hasOwnProperty("name")&&
(!this.config.polygonLayer.statedArea.nullable&&(null===a||""===a)||null!==a&&""!==a&&-1<this.numberFieldTypes.indexOf(this.config.polygonLayer.statedArea.type)&&!this.validateNumericField(a,this.config.polygonLayer.statedArea.type)))return b.status=!1,b.message=this.nls.planInfo.enterValidStatedAreaNameMessage,b;b.status=!0;return b}})})},"widgets/ParcelDrafter/geometryUtils":function(){define("esri/geometry/Point esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils dojo/Deferred dojo/_base/array dojo/_base/lang esri/geometry/geometryEngine esri/SpatialReference esri/geometry/scaleUtils".split(" "),
function(e,b,a,c,h,f,n,k,r,t){var q={getProjectedGeometry:function(a,b,e){var g,f;g=new h;c.canProject(a,b)?(f=c.project(a,b),g.resolve(f)):e.project([a],b,function(a){f=a[0];g.resolve(f)});return g.promise},getDestinationPoint:function(a,b,c){var g=a.x*Math.PI/180,f=b*Math.PI/180;b=Math.sin(f);var f=Math.cos(f),h=.9966471893352243*Math.tan(a.y*Math.PI/180);a=1/Math.sqrt(1+h*h);var p=h*a,l=Math.atan2(h,f),h=a*b,w=1-h*h,k=2.7233160610984375E11*w/4.040829998465916E13,z=1+k/16384*(4096+k*(-768+k*(320-
175*k))),n=k/1024*(256+k*(-128+k*(74-47*k))),q,t,G,x=c/(6356752.314245*z),v,C=0;do k=Math.cos(2*l+x),q=Math.sin(x),t=Math.cos(x),G=n*q*(k+n/4*(t*(-1+2*k*k)-n/6*k*(-3+4*q*q)*(-3+4*k*k))),v=x,x=c/(6356752.314245*z)+G;while(1E-12<Math.abs(x-v)&&200>++C);if(200<=C)return console.log("Formula failed to converge"),null;c=p*q-a*t*f;c=Math.atan2(p*t+a*q*f,.9966471893352243*Math.sqrt(h*h+c*c));w=2.0955066654848088E-4*w*(4+.003352810664775694*(4-3*w));g=(g+(Math.atan2(q*b,a*t-p*q*f)-.003352810664775694*(1-
w)*h*(x+w*q*(k+w*t*(-1+2*k*k))))+3*Math.PI)%(2*Math.PI)-Math.PI;c=180*c/Math.PI;g=180*g/Math.PI;return new e(g,c,new r(4326))},getInverseCalculations:function(a,b){var c=b.x*Math.PI/180-a.x*Math.PI/180,g=.9966471893352243*Math.tan(a.y*Math.PI/180),e=1/Math.sqrt(1+g*g),g=g*e,f=.9966471893352243*Math.tan(b.y*Math.PI/180),p=1/Math.sqrt(1+f*f),f=f*p,l,h,k,w,n,q,r,t,x,v=c,C,B=0;do{l=Math.sin(v);h=Math.cos(v);k=p*l*p*l+(e*f-g*p*h)*(e*f-g*p*h);k=Math.sqrt(k);if(0==k)return 0;w=g*f+e*p*h;n=Math.atan2(k,w);
q=e*p*l/k;r=1-q*q;t=w-2*g*f/r;isNaN(t)&&(t=0);x=2.0955066654848088E-4*r*(4+.003352810664775694*(4-3*r));C=v;v=c+.003352810664775694*(1-x)*q*(n+x*k*(t+x*w*(-1+2*t*t)))}while(1E-12<Math.abs(v-C)&&200>++B);if(200<=B)return null;v=2.7233160610984375E11*r/4.040829998465916E13;B=v/1024*(256+v*(-128+v*(74-47*v)));c=Math.atan2(p*l,e*f-g*p*h);e=Math.atan2(e*l,-g*p+e*f*h);c=(c+2*Math.PI)%(2*Math.PI);e=(e+2*Math.PI)%(2*Math.PI);g=Number((6356752.314245*(1+v/16384*(4096+v*(-768+v*(320-175*v))))*(n-B*k*(t+B/4*
(w*(-1+2*t*t)-B/6*t*(-3+4*k*k)*(-3+4*t*t))))).toFixed(3));c=180*c/Math.PI;e=180*e/Math.PI;return{distance:g,initialBearing:c,finalBearing:e}},getLineBetweenPoints:function(a){var c,g=[];f.forEach(a,n.hitch(this,function(a){g.push([a.x,a.y])}));0<g.length&&(c=new b({paths:[g],spatialReference:{wkid:4326}}));return c},getAngleBetweenPoints:function(a,b){var c=q.getInverseCalculations(a,b);return null===c?0:c.initialBearing},getDistanceBetweenPoints:function(a,b){var c=q.getInverseCalculations(a,b);
return null===c?0:c.distance},getLengthOfGeometry:function(a){return(a=k.simplify(a))?k.geodesicLength(a,9001):0},getAreaOfGeometry:function(a){var b;a=k.simplify(a);b={};a?(b.acres=k.geodesicArea(a,109402),b.squareMeters=k.geodesicArea(a,109404),b.squareFeet=k.geodesicArea(a,109405),b.squareUSSurveyFeet=k.geodesicArea(a,109406)):(b.acres=0,b.squareMeters=0,b.squareFeet=0,b.squareUSSurveyFeet=0);return b},getPolyLineFromPaths:function(a){var c,g;c=new b(new r({wkid:4326}));for(g=0;g<a.length;g++)c.addPath(a[g]);
return c},getPolygonFromPolyLines:function(b,c,e,f){var g,h,p;g=[];f=f?new a(new r(f)):new a(new r({wkid:4326}));for(h=0;h<b.length;h++)for(p=0;p<b[h].length;p++)g.push(b[h][p]);c?g.push(n.clone(g[0])):e&&(g[g.length-1][0]=g[0][0],g[g.length-1][1]=g[0][1]);f.isClockwise(g)||g.reverse();f.addRing(g);return f},getPointsForArc:function(a,b,c,e){var g,f=[],h,l;g=b-a;b=parseInt(g,10);0>=b&&(b=1);h=Math.abs(g)/Math.abs(b);if(0<h)for(g=0;g<Math.abs(b)+1;g++)l=a+h*g,(l=q.getDestinationPoint(c,l,Math.abs(e)))&&
f.push(l);return f},getArcParam:function(a){var b;b={};0>a.distance?0>a.radius?(b.bearing=a.initBearing+90,b.centerPoint=q.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint),b.endAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint)):(b.bearing=a.initBearing-90,b.centerPoint=q.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint),
b.endAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint)):0<a.radius?(b.bearing=a.initBearing+90,b.centerPoint=q.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint),b.endAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint)):(b.bearing=a.initBearing-90,b.centerPoint=q.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint),
b.endAngle=q.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint));return b},removeNegativeExponents:function(a){return 1<a.toString().toLowerCase().split("e-").length?0:a},getChordLengthFromArcLength:function(a,b){var c,e;a=Math.abs(a);e=Math.PI*Math.abs(b);c=Math.abs(b)*Math.sin(Math.abs(a)/Math.abs(b)/2);return a<=e?2*c:-2*c},getArcLengthFromChordLength:function(a,b){var c;c=Math.abs(a);b=Math.abs(b);c=2*Math.asin(c/(2*b))*b;0>a&&(c=2*Math.PI*b-c);return c},chordBearingToTangentBearing:function(a,
b,c){var e;e=180/Math.PI*Math.acos(Math.abs(c)/2/Math.abs(b));b/=Math.abs(b);a=a+90*b-c/Math.abs(c)*b*e;return q.removeNegativeExponents(0>a?a+360:360<=a?a%360:a)},tangentBearingToChordBearing:function(a,b,c){var e;e=180/Math.PI*Math.acos(Math.abs(c)/2/Math.abs(b));b/=Math.abs(b);a=a+90*b-c/Math.abs(c)*b*e;return q.removeNegativeExponents(0>a?a+360:360<=a?a%360:a)},getUnitValueForSR:function(a){switch(t.getUnitValueForSR(a)){case 1:return"meters";case 111194.87428468118:return"meters";case .3048:return"feet";
case .3048006096:case .3048006096012192:return"uSSurveyFeet"}},getRotationAngleBetweenPoints:function(a,b){var e,f,g,h;a=c.project(a,new r(102100));b=c.project(b,new r(102100));e=b.x-a.x;f=b.y-a.y;g=180*Math.atan2(Math.abs(e),Math.abs(f))/Math.PI;h=180*Math.atan2(Math.abs(f),Math.abs(e))/Math.PI;e=q.removeNegativeExponents(e);f=q.removeNegativeExponents(f);g=q.removeNegativeExponents(g);h=q.removeNegativeExponents(h);if(0===f){if(0===e)return 0;if(0<e)return 90;if(0>e)return 270}else if(0<f){if(0===
e)return 0;if(0<e)return g;if(0>e)return 270+h}else if(0>f){if(0===e)return 180;if(0<e)return 90+h;if(0>e)return 180+g}},getScaleDistanceBetweenPoints:function(a,b){a=c.project(a,new r(102100));b=c.project(b,new r(102100));var e=k.distance(a,b,9001);return q.removeNegativeExponents(e)}};return q})},"widgets/ParcelDrafter/MapTooltipHandler":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/Evented dojo/dom-style dojo/dom-construct dojo/on".split(" "),function(e,b,a,c,h,f,
n){return e([b,c],{baseClass:"jimu-widget-ParcelDrafter-MapTooltipHandler",map:null,handleClickFor:null,_mapTooltip:null,_mapMoveHandler:null,_mapClickHandler:null,_mouseDragHandler:null,constructor:function(b){a.mixin(this,b)},startup:function(){this.handleClickFor||(this.handleClickFor=this.map);this._createTooltip()},connectEventHandler:function(b){b&&this.updateTooltip(b);this._disableWebMapPopup();this._mapClickHandler=this.own(n(this.handleClickFor,"click",a.hitch(this,function(a){this._clicked(a)})))[0];
"ontouchstart"in document.documentElement?h.set(this._mapTooltip,"display","none"):(this._mapMoveHandler=this.own(this.map.on("mouse-move",a.hitch(this,this._onMapMouseMove)))[0],this.own(this.map.on("mouse-out",a.hitch(this,function(){h.set(this._mapTooltip,"display","none")}))))},disconnectEventHandler:function(){this._enableWebMapPopup();this._mapClickHandler&&this._mapClickHandler.remove();this._mapMoveHandler&&(this._mapMoveHandler.remove(),this._mapTooltip.style.display="none");this.disconnectMouseDragHandler()},
connectMouseDragHandler:function(b){b&&this.updateTooltip(b);this._disableWebMapPopup();this._mapClickHandler&&this._mapClickHandler.remove();this.map.disableMapNavigation();this._mouseDragHandler=this.own(this.map.on("mouse-drag",a.hitch(this,function(a){this._onDragging(a)})))[0]},disconnectMouseDragHandler:function(){this._mouseDragHandler&&(this._mouseDragHandler.remove(),this._mapTooltip.style.display="none");this.map.enableMapNavigation()},_createTooltip:function(){this._mapTooltip=f.create("div",
{"class":"tooltip",innerHTML:this.toolTipText},this.map.container);h.set(this._mapTooltip,"position","fixed");h.set(this._mapTooltip,"display","none")},_enableWebMapPopup:function(){this.map&&(this.map.infoWindow.hide(),this.map.setInfoWindowOnClick(!0))},_disableWebMapPopup:function(){this.map&&(this.map.infoWindow.hide(),this.map.setInfoWindowOnClick(!1))},_onMapMouseMove:function(a){var b,c;a.clientX||a.pageY?(b=a.clientX,c=a.clientY):(b=a.clientX+document.body.scrollLeft-document.body.clientLeft,
c=a.clientY+document.body.scrollTop-document.body.clientTop);h.set(this._mapTooltip,"display","none");h.set(this._mapTooltip,{left:b+15+"px",top:c+"px"});h.set(this._mapTooltip,"display","");this._onMoving(a)},_clicked:function(a){this.emit("clicked",a)},_onDragging:function(a){this.emit("dragging",a)},_onMoving:function(a){this.emit("moving",a)},updateTooltip:function(a){this.toolTipText=a;this._mapTooltip.innerHTML=this.toolTipText}})})},"widgets/ParcelDrafter/layerUtils":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dojo/_base/array","dojo/_base/lang"],function(e,b,a,c){return e([b],{map:null,getPopupInfo:!0,getRenderer:!0,postCreate:function(){},getLayerDetailsFromMap:function(b,e,n){var f={},h;this.map&&this.map.webMapResponse&&this.map.webMapResponse.itemInfo&&this.map.webMapResponse.itemInfo.itemData&&this.map.webMapResponse.itemInfo.itemData.operationalLayers&&a.forEach(this.map.webMapResponse.itemInfo.itemData.operationalLayers,c.hitch(this,function(k){k.layerObject&&("ArcGISMapServiceLayer"===
k.layerType||"ArcGISTiledMapServiceLayer"===k.layerType?(h=n&&n.substring(0,n.lastIndexOf("_")),h&&k.id!==h||(f.isMapServer=!0,b.substring(0,b.length-1)===k.url&&(a.forEach(k.resourceInfo.layers,c.hitch(this,function(a){a.id===parseInt(e,10)&&(f.title=a.name)})),a.forEach(k.layers,c.hitch(this,function(a){a.id===parseInt(e,10)&&(a.name&&(f.title=a.name),this.getPopupInfo&&(f.popupInfo=a.popupInfo),a.layerDefinition&&(a.layerDefinition.definitionExpression&&(f.definitionExpression=a.layerDefinition.definitionExpression),
this.getRenderer&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(f.renderer=a.layerDefinition.drawingInfo.renderer)))}))))):n&&k.id!==n||k.url.replace(/.*?:\/\//g,"").toLowerCase()!==(b+e).replace(/.*?:\/\//g,"").toLowerCase()||k.id!==n||(f.isMapServer=!1,f.title=k.title,this.getPopupInfo&&(f.popupInfo=k.popupInfo),k.layerDefinition&&(k.layerDefinition.definitionExpression&&(f.definitionExpression=k.layerDefinition.definitionExpression),this.getRenderer&&k.layerDefinition.drawingInfo&&
k.layerDefinition.drawingInfo.renderer&&(f.renderer=k.layerDefinition.drawingInfo.renderer))))}));return f}})})},"widgets/ParcelDrafter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/ParcelDrafter/PlanSettings.html":'\x3cdiv\x3e\r\n    \x3c!-- Direction or Angle Type Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.directionOrAngleTypeLabel}"\x3e\r\n            ${nls.planSettings.directionOrAngleTypeLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"directionOrAngleType" style\x3d"width: 100%" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Direction or Angle Units Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.directionOrAngleUnitsLabel}"\x3e\r\n            ${nls.planSettings.directionOrAngleUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"directionOrAngleUnits" style\x3d"width: 100%" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Distance and Length Units Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.distanceAndLengthUnitsLabel}"\x3e\r\n            ${nls.planSettings.distanceAndLengthUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"distanceAndLengthUnits" style\x3d"width: 100%" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Area Units Selector--\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.areaUnitsLabel}"\x3e\r\n            ${nls.planSettings.areaUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"areaUnits" style\x3d"width: 100%" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Circular Curve Parameters Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.circularCurveParameters}"\x3e\r\n            ${nls.planSettings.circularCurveParameters}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"circularCurveParameters" style\x3d"width: 100%" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/NewTraverse.html":'\x3cdiv\x3e\r\n    \x3c!-- Traverse grid container--\x3e\r\n    \x3cdiv class\x3d"esriCTNewTraverseContainer"\x3e\r\n        \x3c!-- Traverse grid title--\x3e\r\n        \x3cdiv class\x3d"esriCTNewTraverseLabelDiv"\x3e\r\n            \x3cdiv class\x3d"esriCTGridEmptyLabel"\x3e\r\n                \x26nbsp\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis esriCTGridBearingLabel" title\x3d"${nls.traverseSettings.bearingLabel}"\x3e\r\n                ${nls.traverseSettings.bearingLabel}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis" title\x3d"${nls.traverseSettings.lengthLabel}"\x3e\r\n                ${nls.traverseSettings.lengthLabel}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis" title\x3d"${nls.traverseSettings.radiusLabel}"\x3e\r\n                ${nls.traverseSettings.radiusLabel}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid items--\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"traverseGrid" class\x3d"esriCTTraverseGrid"\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid initial entry row--\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"traverseEntryNode" class\x3d"esriCTEntrtyNodeContent esriCTRow"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"lineSymbolNode" class\x3d"esriCTSymbolContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"bearingNode" class\x3d"esriCTBearingRow" data-dojo-type\x3d"dijit/form/ValidationTextBox"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"lengthNode" data-dojo-type\x3d"dijit/form/ValidationTextBox"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"radiusNode" data-dojo-type\x3d"dijit/form/ValidationTextBox"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTAddRow"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"addButton" class\x3d"esriCTAddIcon"\r\n                title\x3d"${nls.traverseSettings.addButtonTitle}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid tools container--\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseTool"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseToolContainer"\x3e\r\n                \x3c!-- Screen digitization tool--\x3e\r\n                \x3cdiv class\x3d"esriCTTraverseToolIcons ecriCTLocationIcon esriCTCursorPointer" title\x3d"${nls.planSettings.onScreenDigitizationTooltipText}"\r\n                    data-dojo-attach-point\x3d"screenDigitizationNode"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Zoom tool--\x3e\r\n                \x3cdiv class\x3d"esriCTHidden esriCTTraverseToolIcons ecriCTZoomToIcon esriCTCursorPointer" title\x3d"${nls.planSettings.zoomToLocationTooltipText}"\r\n                    data-dojo-attach-point\x3d"zoomToNode"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Expand/Collapse grid tool--\x3e\r\n                \x3cdiv class\x3d"esriCTHidden  esriCTTraverseToolIcons esriCTCollapse esriCTCursorPointer" title\x3d"${nls.planSettings.collapseGridTooltipText}"\r\n                    data-dojo-attach-point\x3d"expandCollapseNode"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Misclose details container--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"misCloseDetailsNode"\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Parcel tools (rotation/scale) container--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"parcelToolsNode"\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Parcel info (polygon layer fields) \x26 save/cancle button container--\x3e\r\n    \x3cdiv class\x3d"esriCTPlanInfoNode" data-dojo-attach-point\x3d"planInfoNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/MiscloseDetails.html":'\x3cdiv class\x3d"esriCTTraverseDetailContainer esriCTFullWidth" data-dojo-attach-point\x3d"traverseDetailsContainer"\x3e\r\n    \x3c!-- Message div shown when misclose is not calculated --\x3e\r\n    \x3cdiv class\x3d"esriCTTraverseResultContainer esriCTEllipsis"\r\n    data-dojo-attach-point\x3d"noMiscloseCalculated"\x3e\r\n        ${nls.traverseSettings.noMiscloseCalculated}\r\n    \x3c/div\x3e\r\n    \x3c!-- Misclose details container --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTHidden" data-dojo-attach-point\x3d"miscloseDetailsContainer"\x3e\r\n        \x3c!-- Misclose Bearing Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseMiscloseBearingNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseMiscloseBearing}"\x3e\r\n                ${nls.traverseSettings.traverseMiscloseBearing}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv  esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseBearingNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Misclose Distance Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseDistanceNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseDistance}"\x3e\r\n                ${nls.traverseSettings.traverseDistance}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseDistanceNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Misclose Ratio Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseMiscloseRatioNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseMiscloseRatio}"\x3e\r\n                ${nls.traverseSettings.traverseMiscloseRatio}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseRatioNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Accuracy Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseAccuracyNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseAccuracy}"\x3e\r\n                ${nls.traverseSettings.traverseAccuracy}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"accuracyNode"\x3e\r\n                ${nls.traverseSettings.accuracyHigh}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Stated Area Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer esriCTHidden" data-dojo-attach-point\x3d"traverseStatedAreaNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseStatedArea}"\x3e\r\n                ${nls.traverseSettings.traverseStatedArea}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"traverseStatedArea" style\x3d"font-weight:normal; width: 100px; height: 25px;" data-dojo-type\x3d"dijit/form/ValidationTextBox"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Calculated Area Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseCalculatedAreaNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseCalculatedArea}"\x3e\r\n                ${nls.traverseSettings.traverseCalculatedArea}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"calculatedAreaNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/ParcelTools.html":'\x3cdiv class\x3d"esriCTFullWidth"\x3e\r\n    \x3c!-- Rotation tool container--\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n        \x3cdiv class\x3d"esriCTRotationButton esriCTButtonIcon esriCTParcelToolButtonIcon esriCTCursorPointer" title\x3d" ${nls.parcelTools.rotationToolLabel}"\r\n            data-dojo-attach-point\x3d"rotateButton"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolButtonLabel esriCTEllipsis" title\x3d" ${nls.parcelTools.rotationToolLabel}"\x3e\r\n            ${nls.parcelTools.rotationToolLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolInputNode" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true" required\x3d"true" data-dojo-attach-point\x3d"rotationTxt"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Scale tool container--\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n        \x3cdiv class\x3d"esriCTScaleButton esriCTButtonIcon esriCTParcelToolButtonIcon esriCTCursorPointer" title\x3d"${nls.parcelTools.scaleToolLabel}"\r\n            data-dojo-attach-point\x3d"scaleButton"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolButtonLabel esriCTEllipsis" title\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n            ${nls.parcelTools.scaleToolLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolInputNode" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true" required\x3d"true" data-dojo-attach-point\x3d"scaleTxt"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/PlanInfo.html":'\x3cdiv class\x3d"esriCTFullWidth"\x3e\r\n    \x3c!-- Parcel name input container --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"parcelNameRow"\x3e\r\n        \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"parcelName"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- DocumentType input container --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"documentTypeRow"\x3e\r\n        \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"documentType"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Plan name input container --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"planNameRow"\x3e\r\n        \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"planName"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Save/Cancle button container --\x3e\r\n    \x3cdiv class\x3d"esriCTPlanInfoNode"\x3e\r\n        \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn jimu-trailing-margin1" title\x3d"${nls.common.save}" data-dojo-attach-point\x3d"planInfoSaveButton"\x3e\r\n            ${nls.common.save}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn" title\x3d"${nls.common.cancel}" data-dojo-attach-point\x3d"planInfoCancelButton"\x3e\r\n            ${nls.common.cancel}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/Widget.html":'\x3cdiv class\x3d"esriCTFullHeight" data-dojo-attach-point\x3d"mainNode"\x3e\r\n    \x3cdiv class\x3d"esriCTFullHeight esriCTFullWidth" data-dojo-attach-point\x3d"widgetMainNode"\x3e\r\n        \x3c!--Main Page Node--\x3e\r\n        \x3cdiv class\x3d"esirCTMainPage" data-dojo-attach-point\x3d"mainPageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n                \x3cdiv class\x3d"esriCTButtonLabel esriCTEllipsis" title\x3d"${nls.newTraverseButtonLabel}"\x3e\r\n                    ${nls.newTraverseButtonLabel}\x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTNewTraverseButton esriCTButtonIcon esriCTCursorPointer" title\x3d"${nls.newTraverseButtonLabel}" data-dojo-attach-point\x3d"newTraverseButton"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n                \x3cdiv class\x3d"esriCTButtonLabel esriCTEllipsis" title\x3d"${nls.editTraverseButtonLabel}"\x3e\r\n                    ${nls.editTraverseButtonLabel}\x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTEditTraverseButton esriCTButtonIcon esriCTCursorPointer" title\x3d"${nls.editTraverseButtonLabel}" data-dojo-attach-point\x3d"editTraverseButton"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow esriCTAlignCenter" data-dojo-attach-point\x3d"newTraverseSelectMessageNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--Traverse Page Node--\x3e\r\n        \x3cdiv class\x3d"esriCTFullHeight esriCTHidden" data-dojo-attach-point\x3d"traversePageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTNewTraverseHeader"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButton esriCTCursorPointer" title\x3d"${nls.common.back}" data-dojo-attach-point\x3d"traversePanelBackButton"\x3e\r\n                    \x3cdiv class\x3d"esriCTItemLeftArrow"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.newTraverseTitle}"  data-dojo-attach-point\x3d"traverseTitleNode"\x3e\r\n                    ${nls.newTraverseTitle}\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTPlanSettingsIcon esriCTCursorPointer" title\x3d"${nls.planSettings.planSettingsTitle}" data-dojo-attach-point\x3d"planSettingsButton"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseNode" data-dojo-attach-point\x3d"traverseNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--Plan Settings Node--\x3e\r\n        \x3cdiv class\x3d"esriCTHidden esriCTFullHeight" data-dojo-attach-point\x3d"planSettingsPageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingHeader"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButton esriCTCursorPointer" title\x3d"${nls.common.back}" data-dojo-attach-point\x3d"planSettingsPanelBackButton"\x3e\r\n                    \x3cdiv class\x3d"esriCTItemLeftArrow"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.planSettings.planSettingsTitle}"\x3e\r\n                    ${nls.planSettings.planSettingsTitle}\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanSettingsNode" data-dojo-attach-point\x3d"planSettingsNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWidgetErrorNode esriCTHidden" data-dojo-attach-point\x3d"widgetErrorNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/css/style.css":".esriCTMainContainer{min-width: 222px; height: 100%; -webkit-overflow-scrolling: touch; overflow: hidden;}.esriCTOverridePanelStyle{padding: 15px 0 0 0 !important;}.jimu-widget-ParcelDrafter .esriCTWidgetErrorNode{padding: 0px 20px;}.jimu-widget-ParcelDrafter .esriCTFullHeight{height: 100%;}.jimu-widget-ParcelDrafter .esriCTFullWidth{width: 100%;}.jimu-widget-ParcelDrafter .esriCTEllipsis{overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-ParcelDrafter .esriCTCursorPointer{cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTCursorDefault{cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTAlignCenter{text-align: center;}.jimu-widget-ParcelDrafter .esriCTMainPageRow{width: calc(100% - 40px); margin: 20px 20px 20px 20px; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTButtonLabel{float: left; width: calc(100% - 45px); line-height: 35px; padding: 5px 5px 5px 0;}.jimu-widget-ParcelDrafter .esriCTEditTraverseButton{background: url(\"../images/edit-traverse.png\") no-repeat;}.jimu-widget-ParcelDrafter .esriCTNewTraverseButton{background: url(\"../images/new-traverse.png\") no-repeat;}.jimu-widget-ParcelDrafter .esriCTNewTraverseActive{background: url(\"../images/new-traverse-selected.png\") no-repeat; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTEditTraverseActive{background: url(\"../images/edit-traverse-selected.png\") no-repeat; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTButtonIcon{height: 45px; width: 45px; float: right; background-size: 45px;}.jimu-widget-ParcelDrafter .esriCTParcelToolButtonIcon{height: 45px; width: 45px; float: left; background-size: 45px 45px; background-color: #8e8e8e;}.esriRtl .jimu-widget-ParcelDrafter .esriCTButtonIcon{float: left;}.jimu-widget-ParcelDrafter .esriCTTraverseTool{float: left; padding: 5px 5px 0 0; width: calc(100% - 20px);}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseTool{float: right; padding: 5px 0 0 5px;}.jimu-widget-ParcelDrafter .esriCTTraverseToolContainer{float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseToolContainer {float: left;}.jimu-widget-ParcelDrafter .esriCTTraverseToolIcons{height: 24px; width: 24px; background-size: 24px; float: left; background-repeat: no-repeat; margin: 5px 0px 5px 20px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseToolIcons{float: right; margin: 5px 20px 5px 0px;}.jimu-widget-ParcelDrafter .ecriCTLocationIcon{background-image: url('../images/digitization.png');}.jimu-widget-ParcelDrafter .esriCTEnableButton{background-image: url('../images/digitization-selected.png'); background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .ecriCTZoomToIcon{background-image: url('../images/zoom.png');}.jimu-widget-ParcelDrafter .esriCTCollapse{background-image: url('../images/collapse.png');}.jimu-widget-ParcelDrafter .esriCTExpand{background-image: url('../images/expand.png');}.jimu-widget-ParcelDrafter .esriCTNewTraverseHeader{float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 10px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsIcon{background-image: url('../images/settings.png'); height: 20px; width: 20px; background-size: 20px; float: right; background-repeat: no-repeat;}.jimu-widget-ParcelDrafter .esriCTTraverseDetailContainer{float: left; border-top: 1px solid #464646; border-bottom: 1px solid #464646; margin-top: 20px; background-color: #E4E4ED;}.jimu-widget-ParcelDrafter .esriCTMiscloseHeaderDiv{background-color: rgba(0,0,0,0.5);}.jimu-widget-ParcelDrafter .esriCTTraverseResultContainer{width: 100%; height: 25px; line-height: 25px; padding: 0 10px; float: left; text-align: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseResultContainer{text-align: right;}.jimu-widget-ParcelDrafter .esriCTGridEmptyLabel{width: 50px; float: left; text-align: left;}.jimu-widget-ParcelDrafter .esriCTGridLabels{width: 70px; float: left; text-align: left; padding-left: 4px;}.jimu-widget-ParcelDrafter .esriCTGridBearingLabel{width: calc(100% - 210px);}.esriRtl .jimu-widget-ParcelDrafter .esriCTGridEmptyLabel{float: right; text-align: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTGridLabels{float: right; text-align: right; padding-right: 4px; padding-left: 0px;}.jimu-widget-ParcelDrafter .dijitTextBox .dijitInputInner{height: 21px;}.jimu-widget-ParcelDrafter .dijitTextBoxFocused .dijitInputContainer{background: transparent;}.jimu-widget-ParcelDrafter .esriCTTraverseResultsDiv{max-width: 49%; float: left; padding-right: 5px;}.jimu-widget-ParcelDrafter .esriCTTraversedValueDiv{font-weight: bold;}.jimu-widget-ParcelDrafter .esriCTNewTraverseGrid{height: calc(100% - 40px); overflow: auto;}.jimu-widget-ParcelDrafter .esriCTNewTraverseContainer{padding: 10px; width: 100%; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTNewTraverseLabelDiv{display: inline-block; width: 100%;}.jimu-widget-ParcelDrafter .esriCTTraverseGrid{width: 100%; display: table; border-collapse: collapse;}.jimu-widget-ParcelDrafter .esriCTHidden{display: none;}::-ms-clear{display: none;}.jimu-widget-ParcelDrafter .esriCTRotationButton{background-image: url('../images/scale-rotation-active.png');}.jimu-widget-ParcelDrafter .esriCTScaleButton{background-image: url('../images/scale-active.png');}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTParcelToolButtonIcon{background-color: inherit;}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTRotationButton{background-image: url('../images/scale-rotation.png');}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTScaleButton{background-image: url('../images/scale.png');}.jimu-widget-ParcelDrafter .esriCTParcelToolButtonLabel{float: left; max-width: calc(100% - 145px); line-height: 35px; padding: 5px 20px;}.jimu-widget-ParcelDrafter .esriCTParcelToolInputNode{width: 100px; height: 25px; margin-top: 10px; float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolButtonIcon{float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolInputNode{float: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolButtonLabel{float: right;}.jimu-widget-ParcelDrafter .esriCTPlanInfoNode{margin: 10px 20px; display: inline-block; width: calc(100% - 40px);}.jimu-widget-ParcelDrafter .esriCTPlanInfoButton{width: 80px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsNode{width: 100%; height: calc(100% - 30px); display: inline-block; overflow-y: auto;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsContainer{margin: 20px; display: inline-block; width: calc(100% - 40px);}.jimu-widget-ParcelDrafter .esriCTPlanSettingRow{padding-bottom: 20px;}.jimu-widget-ParcelDrafter .esriCTDropdownLabel{padding-bottom: 5px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingHeader{float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 10px;}.jimu-widget-ParcelDrafter .esriCTBackButton{width: 25%;}.jimu-widget-ParcelDrafter .esriCTTitleDiv{line-height: 10px; font-weight: bold; text-align: center; width: calc(100% - 50px); padding: 5px; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTItemLeftArrow{background-image: url('../images/left-arrow.png'); float: left; margin: 0px 5px 0px 0px; width: 15px; height: 20px; background-repeat: no-repeat; background-position: center center;}.jimu-widget-ParcelDrafter .dijitSelect .dijitButtonContents{border-style: none none none none; background-color: #fafafc;}.jimu-widget-ParcelDrafter .dijitSelect .dijitButtonContentsDartTheme {background-color: inherit;}.jimu-widget-ParcelDrafter .dijitSelect .dijitArrowButton{background-color: #fafafc; background-image: none; border-color: #fafafc;}.jimu-widget-ParcelDrafter .dijitSelect .dijitArrowButtonDartTheme {background-color: rgba(0, 0, 0, 0.5) !important;}.jimu-widget-ParcelDrafter .dijitMenuItem{color: #7989a0;}.jimu-widget-ParcelDrafter .dijitSelect .dijitInputField{margin-right: 8px;}input[type\x3dtext]::-ms-clear{display: none;}.jimu-widget-ParcelDrafter .esriCTRow {clear: both; display: table-row; width: 100%;}.jimu-widget-ParcelDrafter .esriCTNewTraverseGrid{float: left; width: 100%; position: relative; text-align: center; margin: 10px 0px;}.jimu-widget-ParcelDrafter .dijitTextBox .dijitPlaceHolder{font-size: 12px;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBox{margin: 0; width: 70px; display: table-cell;}.jimu-widget-ParcelDrafter .dijitTextBoxError {border-color: #d9dde0 !important; box-shadow: inset 0 0 0 2px #d46464;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBoxHover{border-color: #d9dde0;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBoxFocused{border-color: #d9dde0 !important; box-shadow: none; outline: none;}.jimu-widget-ParcelDrafter .esriCTBearingRow{width: calc(100% - 210px) !important;}.jimu-widget-ParcelDrafter .dojoDndItemAfter .esriCTSymbolContainer, .jimu-widget-ParcelDrafter .dojoDndItemBefore .esriCTSymbolContainer{background: #E4E4ED !important;}.jimu-widget-ParcelDrafter .dojoDndItem, .jimu-widget-demo .dojoDndItemAnchor, .jimu-widget-demo .dojoDndItemSelected, .dojoDndContainerOver, .dojoDndItemOver{background: none; border: none; padding: 0; cursor: move;}.jimu-widget-ParcelDrafter .esriCTDeleteRow, .jimu-widget-ParcelDrafter .esriCTAddRow{color: #CCC; display: table-cell; vertical-align: middle; font-size: 18px; width: 15px;}.jimu-widget-ParcelDrafter .esriCTDeleteIcon, .jimu-widget-ParcelDrafter .esriCTAddIcon{cursor: pointer; height: 30px; width: 15px; margin-left: 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTDeleteIcon,.esriRtl .jimu-widget-ParcelDrafter .esriCTAddIcon{margin-right: 5px; margin-left: 0;}.jimu-widget-ParcelDrafter .esriCTDeleteIcon{background: url('../images/delete.png') no-repeat center center;}.jimu-widget-ParcelDrafter .esriCTAddIcon{background: url('../images/add.png') no-repeat center center;}.jimu-widget-ParcelDrafter .esriCTEntryNodeContainer{float: left; width: 100%;}.jimu-widget-ParcelDrafter .esriCTEntrtyNodeContent{width: 100%; display: table; border-collapse: collapse;}.esriCTSymbolContainer{border: 1px solid #dedede; width: 50px; height: 30px; padding: 0px 5px; vertical-align: middle; display: table-cell;}.esriCTSymbolPopup .dijitTooltipContainer{padding: 0px;}.esriCTSymbolListContainer{max-height: 150px; overflow: auto; margin: 6px 0px; width: 170px;}.esriCTSymbolListContent{margin: 0px 6px;}.esriCTSelectedSymbol{width: 30px; height: 25px; overflow: hidden; margin-top: 4px; cursor: pointer;}.esriCTSymbolIcon{width: 35px; vertical-align: middle; margin: 2px 3px 0px 3px; overflow: hidden; display: inline-block;}.esriCTSymbolOption{height: 25px; width: 100%; cursor: pointer;}.esriCTSymbolOption:hover{background-color: #edf2f5;}.esriCTSymbolName{display: inline-block; white-space: nowrap; margin-left: 5px; overflow: hidden; text-overflow: ellipsis; width: 95px; color: #7989a0; vertical-align: middle;}.esriRtl .jimu-widget-ParcelDrafter .esriCTButtonLabel{float: right; padding: 5px 0px 5px 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTItemLeftArrow{float: right; margin: 0px 0px 00px 10px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTPlanSettingsIcon{float: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTItemLeftArrow{background-image: url('../images/right-arrow.png');}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseResultsDiv{float: right;}.esriRtl .jimu-widget-ParcelDrafter .dijitSelect .dijitInputField{margin-left: 8px; margin-right: 0;}.jimu-widget-ParcelDrafter .esriCTEditParcelDialog{position: absolute; width: 250px; z-index:100;}.jimu-widget-ParcelDrafter .esriCTParcelInfoPopup{display: table; border-collapse: collapse; width: 100%;}.jimu-widget-ParcelDrafter .esriCTParcelInfoLabels{height: 20px; display: table-cell; text-align: center; text-overflow: ellipsis; overflow: hidden; word-wrap: nowrap; margin-right: 5px;}.jimu-widget-ParcelDrafter .esriCTLabelRows{display: table-row;}.jimu-widget-ParcelDrafter .esriCTParcelInfoPopup .esriCTRowContainer{display: table-row;}",
"*now":function(e){e(['dojo/i18n!*preload*widgets/ParcelDrafter/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget dojo/_base/lang dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/on ./PlanSettings ./NewTraverse ./MapTooltipHandler ./layerUtils esri/tasks/GeometryService jimu/dijit/Message jimu/dijit/LoadingIndicator esri/tasks/query esri/request".split(" "),function(e,b,a,c,h,f,n,k,r,t,q,g,w,z,F,D,E){return e([b],{baseClass:"jimu-widget-ParcelDrafter",_prevOpenPanel:"mainPage",_newTraverseInstance:null,_planSettingsInstance:null,_mapTooltipHandler:null,
_startPoint:null,geometryService:null,_lineLayerSpatialReference:null,_polygonLayerSpatialReference:null,_isUpdateStartPoint:null,postMixInProperties:function(){this.nls.common={};a.mixin(this.nls.common,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);if(this.appConfig.geometryService){this.geometryService=new w(this.appConfig.geometryService);if(!this._isValidConfig())return this._showErrorInWidgetPanel(this.nls.invalidConfigMsg),!1;this._layerUtils=new g({map:this.map,getPopupInfo:!0,
getRenderer:!1});a.mixin(this.config.polylineLayer,this._layerUtils.getLayerDetailsFromMap(this.config.polylineLayer.baseURL,this.config.polylineLayer.layerId,this.config.polylineLayer.id));a.mixin(this.config.polygonLayer,this._layerUtils.getLayerDetailsFromMap(this.config.polygonLayer.baseURL,this.config.polygonLayer.layerId,this.config.polygonLayer.id));this._initLoading();this._getSpatialReferenceOfParcelLayers()}else this._showErrorInWidgetPanel(this.nls.geometryServiceURLNotFoundMSG)},startup:function(){this.inherited(arguments);
c.add(this.domNode.parentElement,"esriCTOverridePanelStyle")},onOpen:function(){this._mapTooltipHandler&&"mainPage"!==this._prevOpenPanel&&(this._isUpdateStartPoint=!0,this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint),this._toggleSnapping(!0))},onClose:function(){this._mapTooltipHandler&&(this._toggleSnapping(!1),this._mapTooltipHandler.disconnectEventHandler(),c.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),c.replace(this.editTraverseButton,
"esriCTEditTraverseButton","esriCTEditTraverseActive"),this.newTraverseSelectMessageNode.innerHTML="",this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deactivateParcelTools(),this._newTraverseInstance.closePopup())},_initWidgetWorkFlow:function(){this._handleClickEvents();this._createMapTooltipHandler();this._createNewTraverse();this._createPlanSettings()},_isValidConfig:function(){var a;a=!0;this.config?(this.config.polygonLayer&&this.map.getLayer(this.config.polygonLayer.id)||
(a=!1),this.config.polylineLayer&&this.map.getLayer(this.config.polylineLayer.id)||(a=!1)):a=!1;return a},_initLoading:function(){this.loading=new F({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()},_getSpatialReferenceOfParcelLayers:function(){var b;this.loading.show();E({url:this.config.polylineLayer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(a.hitch(this,function(c){this._lineLayerSpatialReference=c.extent.spatialReference;b=E({url:this.config.polygonLayer.url,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"});b.then(a.hitch(this,function(a){this.loading.hide();this._polygonLayerSpatialReference=a.extent.spatialReference;this._initWidgetWorkFlow()}))}))},_handleClickEvents:function(){this.own(k(this.planSettingsButton,"click",a.hitch(this,function(){this._showPanel("planSettingsPage")})));this.own(k(this.newTraverseButton,"click",a.hitch(this,function(){this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();
c.contains(this.newTraverseButton,"esriCTNewTraverseActive")?(this._toggleSnapping(!1),c.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),this.newTraverseSelectMessageNode.innerHTML=""):(c.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),c.replace(this.newTraverseButton,"esriCTNewTraverseActive","esriCTNewTraverseButton"),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForStartNewTraverse),this._isUpdateStartPoint=
!0,this._toggleSnapping(!0),this.newTraverseSelectMessageNode.innerHTML=this.nls.mapTooltipForStartNewTraverse)})));this.own(k(this.editTraverseButton,"click",a.hitch(this,function(){this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();c.contains(this.editTraverseButton,"esriCTEditTraverseActive")?(c.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),this.newTraverseSelectMessageNode.innerHTML=""):(c.replace(this.newTraverseButton,
"esriCTNewTraverseButton","esriCTNewTraverseActive"),c.replace(this.editTraverseButton,"esriCTEditTraverseActive","esriCTEditTraverseButton"),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForEditNewTraverse),this.newTraverseSelectMessageNode.innerHTML=this.nls.mapTooltipForEditNewTraverse)})));this.own(k(this.planSettingsPanelBackButton,"click",a.hitch(this,function(){this._planSettingsInstance.onClose();this._showPanel("traversePage")})));this.own(k(this.traversePanelBackButton,
"click",a.hitch(this,this._confirmCancelTraverse)))},_setSnappingLayers:function(){var a=[],b,c;if(this.config.snappingLayers&&this.config.snappingLayers.length)for(c=0;c<this.config.snappingLayers.length;c++)(b=this.map.getLayer(this.config.snappingLayers[c].id))&&a.push({layer:b});this._isUpdateStartPoint||this._newTraverseInstance.parcelPointsGraphicsLayer&&a.push({layer:this._newTraverseInstance.parcelPointsGraphicsLayer});this.map.snappingManager&&this.map.snappingManager.setLayerInfos(a)},_toggleSnapping:function(a){this.map.snappingManager&&
(this.map.snappingManager._deactivateSnapping(),this.map.disableSnapping());a&&!this.map.snappingManager&&(this.map.enableSnapping({tolerance:this.config.snappingTolerance,snapToEdge:!0,snapToPoint:!0,snapToVertex:!0,alwaysSnap:!0}),this._setSnappingLayers(),this.map.snappingManager._setUpSnapping())},_confirmCancelTraverse:function(){var b;this._newTraverseInstance.closePopup();b=new z({message:this.nls.clearingDataConfirmationMessage,type:"question",buttons:[{label:this.nls.common.yes,onClick:a.hitch(this,
function(){b.close();this._resetOnBackToMainPage()})},{label:this.nls.common.no}]})},_resetOnBackToMainPage:function(){this._startPoint=null;c.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive");c.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive");this.newTraverseSelectMessageNode.innerHTML="";this._toggleSnapping(!1);this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();this._showPanel("mainPage")},
_createMapTooltipHandler:function(){this._mapTooltipHandler=new q({toolTipText:this.nls.mapTooltipForStartNewTraverse,map:this.map});this._isUpdateStartPoint=!0;this.own(this._mapTooltipHandler.on("clicked",a.hitch(this,function(b){var c;this.map&&this.map.snappingManager?(c=this.map.snappingManager.getSnappingPoint(b.screenPoint),c.then(a.hitch(this,function(a){this._onMapPointSelected(a?a:b.mapPoint)}))):this._onMapPointSelected(b.mapPoint)})));this.own(this._mapTooltipHandler.on("dragging",a.hitch(this,
function(a){this._startPoint&&(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForRotate?this._newTraverseInstance.setRotation(a.mapPoint):this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForScale&&this._newTraverseInstance.setScaling(a.mapPoint))})));this.own(this._mapTooltipHandler.on("moving",a.hitch(this,function(b){this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForUpdateStartPoint&&this._startPoint&&this._newTraverseInstance._showParcelPopup(b).then(a.hitch(this,function(a){a&&
n.set(this._mapTooltipHandler._mapTooltip,"display","none")}))})));this._mapTooltipHandler.startup()},_onMapPointSelected:function(a){this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForScreenDigitization?this._newTraverseInstance.pointAddedFromDigitization(a):(this._startPoint||(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForEditNewTraverse?(this._startPoint=a,this._getPolygonForEdits(a)):(h.set(this.traverseTitleNode,"innerHTML",this.nls.newTraverseTitle),h.set(this.traverseTitleNode,
"title",this.nls.newTraverseTitle),this._showPanel("traversePage"),this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint))),this._startPoint=a,this._newTraverseInstance.setStartPoint(this._startPoint))},_getPolygonForEdits:function(b){var c,e;this.loading.show();e=(new Date).getTime();c=new D;c.geometry=b;c.outSpatialReference=this.map.spatialReference;c.returnGeometry=!1;c.outFields=["*"];c.where=e+"\x3d"+e;(b=this.map.getLayer(this.config.polygonLayer.id))?b.queryFeatures(c,
a.hitch(this,function(a){this.loading.hide();if(a&&0<a.features.length)for(this._newTraverseInstance.polygonDeleteArr=a.features;0<a.features.length;){this._getLinesForEdits(a.features[0]);break}else this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage)}),a.hitch(this,function(){this.loading.hide();this._startPoint=null;this._showMessage(this.nls.unableToFetchParcelMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage))},
_sortFeatureAccToSequenceID:function(a){var b;b=this.config.polylineLayer.sequenceId.name;a.sort(function(a,c){return a.attributes[b]-c.attributes[b]});return a},_getLinesForEdits:function(b){var c;this.loading.show();c=b.attributes[this.config.polygonLayer.relatedGUID.name];b=new D;b.outSpatialReference=this.map.spatialReference;b.returnGeometry=!0;b.outFields=["*"];b.where=this.config.polylineLayer.relatedGUID.name+"\x3d'"+c+"'";(c=this.map.getLayer(this.config.polylineLayer.id))?c.queryFeatures(b,
a.hitch(this,function(a){this.loading.hide();a&&0<a.features.length?(a.features=this._sortFeatureAccToSequenceID(a.features),this._newTraverseInstance.polylineDeleteArr=a.features,this._startPoint=a.features[0].geometry.getPoint(0,0),h.set(this.traverseTitleNode,"innerHTML",this.nls.editTraverseTitle),h.set(this.traverseTitleNode,"title",this.nls.editTraverseTitle),this._newTraverseInstance.initEditing(this._startPoint,a,this._lineLayerSpatialReference),this._toggleSnapping(!0),this._showPanel("traversePage"),
this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint)):(this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelLinesMessage))}),a.hitch(this,function(){this.loading.hide();this._startPoint=null;this._showMessage(this.nls.unableToFetchParcelLinesMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelLinesMessage))},_createNewTraverse:function(){this._newTraverseInstance=new t({nls:this.nls,config:this.config,map:this.map,
loading:this.loading,geometryService:this.geometryService,appConfig:this.appConfig,lineLayerSpatialReference:this._lineLayerSpatialReference,polygonLayerSpatialReference:this._polygonLayerSpatialReference},this.traverseNode);this.own(this._newTraverseInstance.on("showMessage",a.hitch(this,this._showMessage)));this.own(this._newTraverseInstance.on("activateDigitizationTool",a.hitch(this,function(){this._onActivateDigitization()})));this.own(this._newTraverseInstance.on("deActivateDigitizationTool",
a.hitch(this,function(){this._onDeactivateDigitization()})));this.own(this._newTraverseInstance.on("cancelTraverse",a.hitch(this,function(){this._confirmCancelTraverse()})));this.own(this._newTraverseInstance.on("displayMainPageAfterSave",a.hitch(this,function(){this._resetOnBackToMainPage()})));this.own(this._newTraverseInstance.on("toggleRotating",a.hitch(this,function(a){this._toggleRotating(a)})));this.own(this._newTraverseInstance.on("toggleScaling",a.hitch(this,function(a){this._toggleScaling(a)})))},
_toggleRotating:function(a){a?(this._mapTooltipHandler.connectMouseDragHandler(this.nls.mapTooltipForRotate),this._newTraverseInstance.deActivateDigitizationTool()):(this._isUpdateStartPoint=!0,this._mapTooltipHandler.disconnectEventHandler(),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint));this._toggleSnapping(!a)},_toggleScaling:function(a){a?(this._mapTooltipHandler.connectMouseDragHandler(this.nls.mapTooltipForScale),this._newTraverseInstance.deActivateDigitizationTool()):
(this._newTraverseInstance.distance=null,this._isUpdateStartPoint=!0,this._mapTooltipHandler.disconnectEventHandler(),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint));this._toggleSnapping(!a)},_onActivateDigitization:function(){this._mapTooltipHandler.disconnectEventHandler();this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForScreenDigitization);this._newTraverseInstance.deactivateParcelTools();this._isUpdateStartPoint=!1;this._toggleSnapping(!0)},
_onDeactivateDigitization:function(){this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint);this._isUpdateStartPoint=!0;this._toggleSnapping(!0)},_createPlanSettings:function(){this._planSettingsInstance=new r({nls:this.nls,config:this.config,appConfig:this.appConfig},f.create("div",{},this.planSettingsNode));this.own(this._planSettingsInstance.on("planSettingsChanged",a.hitch(this,function(a){this._newTraverseInstance.updateAccordingToPlanSettings(a)})));this._planSettingsInstance.startup()},
_showPanel:function(a){var b;this._prevOpenPanel&&(b=this._getNodeByName(this._prevOpenPanel),c.add(b,"esriCTHidden"));b=this._getNodeByName(a);c.remove(b,"esriCTHidden");this._prevOpenPanel=a},_showMessage:function(a){(new z({message:a,buttons:[{label:this.nls.common.ok}]})).message=a},_showErrorInWidgetPanel:function(a){h.set(this.widgetErrorNode,"innerHTML",a);c.add(this.widgetMainNode,"esriCTHidden");c.remove(this.widgetErrorNode,"esriCTHidden")},_getNodeByName:function(a){var b;switch(a){case "mainPage":b=
this.mainPageNode;break;case "traversePage":b=this.traversePageNode;break;case "planSettingsPage":b=this.planSettingsPageNode}return b}})});