// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request esri/lang esri/arcgis/utils dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-style dojo/dom-construct dojo/dom-class dojo/promise/all dojo/Deferred jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect dojo/query jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter jimu/dijit/Message jimu/utils dojo/on dijit/popup dijit/form/ValidationTextBox dijit/form/Form dijit/form/Select dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton dijit/form/SimpleTextarea esri/IdentityManager dojo/store/Memory".split(" "),
function(c,l,m,u,x,v,e,g,d,b,r,q,h,a,E,C,z,y,I,A,B,F,G,t,L,O,k,P,J,H){A=c([l,m,u],{widgetsInTemplate:!0,templateString:A,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,_showSettings:!1,_currentTemplateInfo:null,postCreate:function(){this.inherited(arguments);
this.printTask=new x(this.printTaskURL,{async:this.async});this.printparams=new v;this.printparams.map=this.map;this.shelter=new L({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.titleNode.set("value",this.defaultTitle);this.authorNode.set("value",this.defaultAuthor);this.copyrightNode.set("value",this.defaultCopyright);var a=I.setHttpProtocol(this.printTaskURL),b=I.getNewPrintUrl(this.appConfig.portalUrl);this._isNewPrintUrl=a===b||/sharing\/tools\/newPrint$/.test(a);
a=G("input",this.printWidgetMapScale.domNode)[0];b=G("input",this.printWidgetMapExtent.domNode)[0];k.combineRadioCheckBoxWithLabel(a,this.printWidgetMapScaleLabel);k.combineRadioCheckBoxWithLabel(b,this.printWidgetMapExtentLabel);"MAP_ONLY"===this.defaultLayout?h.setStyle(this.titleTr,"display","none"):h.setStyle(this.titleTr,"display","");this._hasLabelLayer()?(h.setStyle(this.labelsFormDijit.domNode,"display",""),h.setStyle(this.labelsTitleNode,"display","")):(h.setStyle(this.labelsFormDijit.domNode,
"display","none"),h.setStyle(this.labelsTitleNode,"display","none"));t.getInstance(this.map,this.map.itemInfo).then(r.hitch(this,function(f){this.layerInfosObj=f;return z([this._getPrintTaskInfo(),this._getLayerTemplatesInfo()]).then(r.hitch(this,function(f){var n=f[0];(f=f[1])&&!f.error?(f=f&&f.results)&&0<f.length&&(q.some(f,r.hitch(this,function(f){return f&&"Output_JSON"===f.paramName?this.templateInfos=f.value:!1})),this.templateInfos&&0<this.templateInfos.length&&(this.templateNames=q.map(this.templateInfos,
function(f){return f.layoutTemplate}))):console.warn("Get Layout Templates Info Error",f&&f.error);!d.isDefined(n)||n&&n.error?this._handleError(n.error):this._handlePrintInfo(n)}))})).always(r.hitch(this,function(){this.shelter.hide()}));this.printTask._getPrintDefinition&&F.after(this.printTask,"_getPrintDefinition",r.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&(F.after(this.printTask,"_createOperationalLayers",r.hitch(this,"_fixInvalidSymbol")),F.after(this.printTask,
"_createOperationalLayers",r.hitch(this,"_excludeInvalidLegend")))},_hasLabelLayer:function(){return q.some(this.map.graphicsLayerIds,function(a){return(a=this.map.getLayer(a))&&"esri.layers.LabelLayer"===a.declaredClass},this)},_getPrintTaskInfo:function(){var a=new y;this._isNewPrintUrl?a.resolve({isGPPrint:!1}):g({url:this.printTaskURL,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(r.hitch(this,function(t){a.resolve({isGPPrint:!0,data:t})}),r.hitch(this,function(t){a.resolve({error:t})}));
return a},_getLayerTemplatesInfo:function(){var a=new y,t=this.printTaskURL.split("/"),f=t.indexOf("GPServer");if(-1<f){var w=null,w=/Utilities\/PrintingTools\/GPServer/.test(this.printTaskURL)?t.slice(0,f+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info Task")+"/execute":t.slice(0,f+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info")+"/execute";g({url:w,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(r.hitch(this,function(f){a.resolve(f)}),
r.hitch(this,function(f){a.resolve({error:f})}))}else a.resolve(null);return a},_fixInvalidSymbol:function(a){q.forEach(a,function(a){"map_graphics"===a.id&&(a=r.getObject("featureCollection.layers",!1,a))&&0<a.length&&q.forEach(a,function(f){f&&f.featureSet&&"esriGeometryPoint"===f.featureSet.geometryType&&q.forEach(f.featureSet.features,function(f){f&&f.symbol&&!f.symbol.style&&(f.symbol.style="esriSMSSquare")})})},this);return a},_excludeInvalidLegend:function(a){function t(f){return q.filter(f.subLayerIds,
r.hitch(this,function(n){return(n=this.layerInfosObj.getLayerInfoById(f.id+"_"+n))&&n.getShowLegendOfWebmap()}))}if(this.printTask.allLayerslegend){for(var f=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),f=q.map(f,function(f){return{id:f.layer.id}}),w=this.printTask.allLayerslegend,n=[],D=0;D<w.length;D++){var d=w[D],k=this.map.getLayer(d.id),g=this.layerInfosObj.getLayerInfoById(d.id),J=k&&k.declaredClass&&"esri.layers.GraphicsLayer"!==k.declaredClass,k=!k.renderer||k.renderer&&!k.renderer.hasVisualVariables(),
g=g&&g.getShowLegendOfWebmap();J&&k&&g&&(d.subLayerIds&&(d.subLayerIds=r.hitch(this,t,d)()),n.push(d))}q.forEach(f,r.hitch(this,function(f){var w=q.some(n,r.hitch(this,function(n){return n.id===f.id})),a=this.layerInfosObj.getLayerInfoById(f.id),a=a&&a.getShowLegendOfWebmap()&&a.isShowInMap();!w&&a&&n.push(f)}));this.printTask.allLayerslegend=n}return a},printDefInspector:function(a){"force"===this.preserve.preserveScale&&(a.mapOptions.scale=this.preserve.forcedScale);return a},_handleError:function(a){console.log("print widget load error: ",
a);new O({message:a.message||a})},onLayoutChange:function(a){var t=this.templateNames&&this.templateNames.indexOf(a);if(-1<t){h.empty(this.customTextElementsTable);a=this._currentTemplateInfo=this.templateInfos[t];if((t=r.getObject("layoutOptions.customTextElements",!1,a))&&0<t.length){var f=[];q.forEach(t,r.hitch(this,function(w){for(var n in w)if(0>f.indexOf(n)){var a=this.customTextElementsTable.insertRow(-1);a.insertCell(-1).appendChild(h.toDom(n+": "));a.insertCell(-1).appendChild((new H({name:n,
trim:!0,required:!1,value:w[n],style:"width:100%"})).domNode);f.push(n)}}))}r.getObject("layoutOptions.hasAuthorText",!1,a)?h.setStyle(this.authorTr,"display",""):h.setStyle(this.authorTr,"display","none");r.getObject("layoutOptions.hasCopyrightText",!1,a)?h.setStyle(this.copyrightTr,"display",""):h.setStyle(this.copyrightTr,"display","none");r.getObject("layoutOptions.hasTitleText",!1,a)?h.setStyle(this.titleTr,"display",""):h.setStyle(this.titleTr,"display","none");r.getObject("layoutOptions.hasLegend",
!1,a)?h.setStyle(this.legendTr,"display",""):h.setStyle(this.legendTr,"display","none")}else"MAP_ONLY"===a?(h.setStyle(this.authorTr,"display","none"),h.setStyle(this.copyrightTr,"display","none"),h.setStyle(this.titleTr,"display","none"),h.setStyle(this.legendTr,"display","none"),this._currentTemplateInfo={layoutOptions:{hasTitleText:!1,hasCopyrightText:!1,hasAuthorText:!1,hasLegend:!1}}):(h.setStyle(this.authorTr,"display",""),h.setStyle(this.copyrightTr,"display",""),h.setStyle(this.titleTr,"display",
""),h.setStyle(this.legendTr,"display",""),this._currentTemplateInfo={layoutOptions:{hasTitleText:!0,hasCopyrightText:!0,hasAuthorText:!0,hasLegend:!0}})},_getMapAttribution:function(){var a=this.map.attribution;return a&&a.domNode?h.getProp(a.domNode,"textContent"):""},showSettings:function(a){a.preventDefault();a.stopPropagation();this._showSettings?(J.close(this.settingsDialog),this._showSettings=!1):(J.open({popup:this.settingsDialog,around:this.advancedButtonDijit}),this._showSettings=!0)},_handlePrintInfo:function(t){if(t.isGPPrint){t=
t.data;a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");a.set(this.formatDijit.domNode.parentNode.parentNode,"display","");a.set(this.advancedButtonDijit,"display","");this.own(P(document.body,"click",r.hitch(this,function(f){if(this._showSettings){f=f.target||f.srcElement;var n=this.settingsDialog.domNode;f===n||h.isDescendant(f,n)||(J.close(this.settingsDialog),this._showSettings=!1)}})));var b=q.filter(t.parameters,function(f){return"Layout_Template"===f.name});if(0===b.length)console.log('print service parameters name for templates must be "Layout_Template"');
else{var f=q.map(b[0].choiceList,function(f){return{label:f,value:f}});f.sort(function(f,n){return f.label>n.label?1:n.label>f.label?-1:0});this.layoutDijit.addOption(f);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",b[0].defaultValue);t=q.filter(t.parameters,function(f){return"Format"===f.name});0===t.length?console.log('print service parameters name for format must be "Format"'):(b=q.map(t[0].choiceList,function(f){return{label:f,value:f}}),b.sort(function(f,
n){return f.label>n.label?1:n.label>f.label?-1:0}),this.formatDijit.addOption(b),this.defaultFormat?this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",t[0].defaultValue))}}else a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.formatDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.advancedButtonDijit,"display","none")},print:function(){if(this.printSettingsFormDijit.isValid()){var t=this.printSettingsFormDijit.get("value");
r.mixin(t,this.layoutMetadataDijit.get("value"));r.mixin(t,this.labelsFormDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");r.mixin(t,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var b=this.mapQualityFormDijit.get("value"),f=this.mapOnlyFormDijit.get("value");r.mixin(f,b);var w=this.customTextElementsDijit.get("value"),b=[],n;for(n in w){var k={};k[n]=w[n];b.push(k)}k=this._currentTemplateInfo;n=r.getObject("layoutOptions.hasAuthorText",!1,k);var w=r.getObject("layoutOptions.hasCopyrightText",
!1,k),k=r.getObject("layoutOptions.hasTitleText",!1,k),d=new e;d.format=t.format;d.layout=t.layout;d.preserveScale="true"===t.preserveScale||"force"===t.preserveScale;d.label=t.title;d.exportOptions=f;d.showLabels=t.showLabels&&t.showLabels[0];d.layoutOptions={authorText:n?t.author:"",copyrightText:w?t.copyright||this._getMapAttribution():"",legendLayers:this._getLegendLayers(),titleText:k?t.title:"",customTextElements:b};this.printparams.template=d;this.printparams.extraParameters={printFlag:!0};
f=this.printTask.execute(this.printparams);(new N({count:this.count.toString(),icon:"PDF"===t.format?this.pdfIcon:this.imageIcon,docName:t.title,title:t.format+", "+t.layout,fileHandle:f,nls:this.nls})).placeAt(this.printResultsNode,"last").startup();a.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},_getLegendLayers:function(){var a=r.getObject("layoutOptions.hasLegend",!1,this._currentTemplateInfo),t=0<this.layoutForm.legend.length&&this.layoutForm.legend[0];
if(this.printTask&&!this.printTask._createOperationalLayers){var f=[];a&&t&&(a=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),f=q.map(a,function(f){return{layerId:f.layer.id}}));return f}return a&&t?null:[]},clearResults:function(){E.empty(this.printResultsNode);a.set(this.clearActionBarNode,"display","none");this.count=1},updateAuthor:function(a){(a=a||"")&&this.authorTB&&this.authorTB.set("value",a)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",this.map.getScale())}});
var N=c([l,m,u],{widgetsInTemplate:!0,templateString:B,url:null,postCreate:function(){this.inherited(arguments);this.progressBar.set("label",this.nls.creatingPrint);this.fileHandle.then(r.hitch(this,"_onPrintComplete"),r.hitch(this,"_onPrintError"))},_onPrintComplete:function(a){a.url?(this.url=a.url,h.setStyle(this.progressBar.domNode,"display","none"),h.setStyle(this.successNode,"display","inline-block"),C.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(a){console.log(a);
h.setStyle(this.progressBar.domNode,"display","none");h.setStyle(this.errNode,"display","block");C.add(this.resultNode,"printResultError");h.setAttr(this.domNode,"title",a.details||a.message||"")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return A})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../urlUtils ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query dojo/has!extend-esri?./PrintParameters dojo/has!extend-esri?./LegendLayer".split(" "),
function(c,l,m,u,x,v,e,g,d,b,r,q,h,a,E,C,z,y,I,A,B,F,G){c=c(h,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,b){this.url=a;this.printGp=new z(this.url);this._handler=l.hitch(this,this._handler);b&&b.async&&(this.async=b.async);this._colorEvaluator=G("$..color")},_vtlExtent:null,_handler:function(a,b,d,k,g){try{var t;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",l.hitch(this,function(a){t=a.value;this._successHandler([t],"onComplete",d,
g)})):(t=a[0].value,this._successHandler([t],"onComplete",d,g))}catch(H){this._errorHandler(H,k,g)}},execute:function(a,d,q){var t=this._handler,r=this._errorHandler,h=a.template||new y;h.hasOwnProperty("showLabels")||(h.showLabels=!0);var e=h.exportOptions,c;e&&(c={outputSize:[e.width,e.height],dpi:e.dpi});var e=h.layoutOptions,v,E=[];if(e){this.legendAll=!1;e.legendLayers?m.forEach(e.legendLayers,function(f){var n={};n.id=f.layerId;f.subLayerIds&&(n.subLayerIds=f.subLayerIds);E.push(n)}):this.legendAll=
!0;var f,w;if("Miles"===e.scalebarUnit||"Kilometers"===e.scalebarUnit)f="esriKilometers",w="esriMiles";else if("Meters"===e.scalebarUnit||"Feet"===e.scalebarUnit)f="esriMeters",w="esriFeet";v={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};v={titleText:e.titleText,authorText:e.authorText,copyrightText:e.copyrightText,customTextElements:e.customTextElements,scaleBarOptions:{metricUnit:f,metricLabel:v[f],nonMetricUnit:w,nonMetricLabel:v[w]},legendOptions:{operationalLayers:E}}}f=this._getPrintDefinition(a.map,
h);a.outSpatialReference&&(f.mapOptions.spatialReference=a.outSpatialReference.toJson());a.template&&g.isDefined(a.template.showAttribution)&&(f.mapOptions.showAttribution=a.template.showAttribution);l.mixin(f,{exportOptions:c,layoutOptions:v});this.allLayerslegend&&l.mixin(f.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});if(f.operationalLayers){c=f.operationalLayers;var n,D=function(f){return g.fixJson(l.mixin(f,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))};
for(v=0;v<c.length;v++)if(c[v].featureCollection&&c[v].featureCollection.layers)for(w=0;w<c[v].featureCollection.layers.length;w++){var K=c[v].featureCollection.layers[w];K.layerDefinition&&K.layerDefinition.drawingInfo&&K.layerDefinition.drawingInfo.renderer&&K.layerDefinition.drawingInfo.renderer.symbol&&(n=K.layerDefinition.drawingInfo.renderer,"esriCLS"===n.symbol.type?n.symbol=D(n.symbol):n.symbol.outline&&"esriCLS"===n.symbol.outline.type&&(n.symbol.outline=D(n.symbol.outline)));if(K.featureSet&&
K.featureSet.features)for(e=0;e<K.featureSet.features.length;e++)n=K.featureSet.features[e],n.symbol&&("esriCLS"===n.symbol.type?n.symbol=D(n.symbol):n.symbol.outline&&"esriCLS"===n.symbol.outline.type&&(n.symbol.outline=D(n.symbol.outline)))}}h={Web_Map_as_JSON:u.toJson(g.fixJson(f)),Format:h.format,Layout_Template:h.layout};a.extraParameters&&(h=l.mixin(h,a.extraParameters));var L=new x(b._dfdCanceller);a=function(f,n){t(f,n,d,q,L)};f=function(f){r(f,q,L)};L._pendingDfd=this.async?this.printGp.submitJob(h,
a,null,f):this.printGp.execute(h,a,f);return L},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",
geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=v("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var t,b=F.createSurface(A.create("div"),1024,1024);t="image/svg+xml"===a.contentType?
b.createObject(F.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:B.pt2px(a.width),height:B.pt2px(a.height),x:0,y:0}):b.createObject(F.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in b&&b._render(!0);var d=b.rawNode.getContext("2d"),g=Math.ceil(t.getBoundingBox().width),e=Math.ceil(t.getBoundingBox().height);t=d.getImageData(t.getBoundingBox().x,t.getBoundingBox().y,g,e);d.canvas.width=g;d.canvas.height=e;d.putImageData(t,0,0);d=d.canvas.toDataURL("image/png");a={type:"esriPMS",
imageData:d.substr(22,d.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:B.px2pt(e),width:a.size?g/e*a.size:B.px2pt(g),xoffset:a.xoffset,yoffset:a.yoffset};b.destroy();return a}},_convertSvgRenderer:function(a){"simple"===a.type&&a.symbol&&(a.symbol.path||"image/svg+xml"===a.symbol.contentType)?a.symbol=this._convertSvgSymbol(a.symbol):"uniqueValue"===a.type?(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),
a.uniqueValueInfos&&m.forEach(a.uniqueValueInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this)):"classBreaks"===a.type&&(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.classBreakInfos&&m.forEach(a.classBreakInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this))},
_createFeatureCollection:function(b,d,g){var k=this._createPolygonLayer(),t=this._createPolylineLayer(),e=this._createPointLayer(),q=this._createMultipointLayer(),h=this._createPointLayer();h.layerDefinition.name="textLayer";delete h.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass)k.layerDefinition.name=t.layerDefinition.name=e.layerDefinition.name=q.layerDefinition.name=l.getObject("arcgisProps.title",!1,b)||b.name||b.id;var r=
b.renderer&&"esri.renderer.SimpleRenderer"===b.renderer.declaredClass;if(!b.renderer||b.renderer._compiledFunc||l.isFunction(b.renderer.attributeField))delete k.layerDefinition.drawingInfo,delete t.layerDefinition.drawingInfo,delete e.layerDefinition.drawingInfo,delete q.layerDefinition.drawingInfo;else{var c=b.renderer.toJson({useLegacyRotationProperties:!0});if("temporal"===c.type){var c={latestObservationRenderer:c.latestObservationRenderer,trackLinesRenderer:c.trackRenderer,observationAger:c.observationAger,
renderer:c.observationRenderer},f={};b._trackIdField&&(f.trackIdField=b._trackIdField);b._startTimeField&&(f.startTimeField=b._startTimeField);b._endTimeField&&(f.endTimeField=b._endTimeField);k.layerDefinition.drawingInfo=c;k.layerDefinition.timeInfo=f;t.layerDefinition.drawingInfo=c;t.layerDefinition.timeInfo=f;e.layerDefinition.drawingInfo=c;e.layerDefinition.timeInfo=f;q.layerDefinition.drawingInfo=c;q.layerDefinition.timeInfo=f}else k.layerDefinition.drawingInfo.renderer=c,t.layerDefinition.drawingInfo.renderer=
c,e.layerDefinition.drawingInfo.renderer=c,q.layerDefinition.drawingInfo.renderer=c}c=b.fields;c||!b.renderer||b.renderer._compiledFunc||l.isFunction(b.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===b.renderer.declaredClass?(c=[{name:b.renderer.attributeField,type:"esriFieldTypeDouble"}],b.renderer.normalizationField&&c.push({name:b.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===b.renderer.declaredClass&&(c=[{name:b.renderer.attributeField,
type:"esriFieldTypeString"}],b.renderer.attributeField2&&c.push({name:b.renderer.attributeField2,type:"esriFieldTypeString"}),b.renderer.attributeField3&&c.push({name:b.renderer.attributeField3,type:"esriFieldTypeString"})));c&&(k.layerDefinition.fields=c,t.layerDefinition.fields=c,e.layerDefinition.fields=c,q.layerDefinition.fields=c);var c=b.graphics.length,w;for(w=0;w<c;w++){var n=b.graphics[w];if(!1!==n.visible&&n.geometry){f=n.toJson();f.symbol&&f.symbol.outline&&f.symbol.outline.color&&f.symbol.outline.color[3]&&
(f.symbol.outline.color[3]=255);if(b.renderer&&!f.symbol&&(l.isFunction(b.renderer.attributeField)||b.renderer._compiledFunc||this._isFeatureCollectionRequired(b.renderer)||"esri.renderer.DotDensityRenderer"===b.renderer.declaredClass||g)){g=g||b.renderer;var D=null;try{D=g.getSymbol(n)}catch(K){}if(!D)continue;f.symbol=D.toJson();this._isFeatureCollectionRequired(g)&&this._applyVisualVariables(f.symbol,{renderer:g,graphic:n,symbol:D,mapResolution:d&&d.getResolutionInMeters(),mapScale:d&&d.getScale()})}f.symbol&&
(f.symbol.path||"image/svg+xml"===f.symbol.contentType?f.symbol=this._convertSvgSymbol(f.symbol):f.symbol.text&&delete f.attributes);switch(n.geometry.type){case "polygon":k.featureSet.features.push(f);break;case "polyline":t.featureSet.features.push(f);break;case "point":f.symbol&&f.symbol.text?h.featureSet.features.push(f):e.featureSet.features.push(f);break;case "multipoint":q.featureSet.features.push(f);break;case "extent":f.geometry=a.fromExtent(n.geometry).toJson(),k.featureSet.features.push(f)}}}d=
[];0<k.featureSet.features.length&&d.push(k);0<t.featureSet.features.length&&d.push(t);0<q.featureSet.features.length&&d.push(q);0<e.featureSet.features.length&&d.push(e);0<h.featureSet.features.length&&d.push(h);if(!d.length)return null;m.forEach(d,function(f){var a=m.every(f.featureSet.features,function(f){return f.symbol});if(r||a)m.forEach(f.featureSet.features,function(f){delete f.attributes}),delete f.layerDefinition.fields;a&&delete f.layerDefinition.drawingInfo});m.forEach(d,function(f){f.layerDefinition.drawingInfo&&
f.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(f.layerDefinition.drawingInfo.renderer)},this);return{id:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0,featureCollection:{layers:d}}},_getPrintDefinition:function(a,b){var d={operationalLayers:this._createOperationalLayers(a,b)},k=this._vtlExtent||a.extent,t=a.spatialReference;this._vtlExtent=null;a.spatialReference._isWrappable()&&(k=k._normalize(!0),t=k.spatialReference);k={mapOptions:{showAttribution:a.showAttribution,
extent:k.toJson(),spatialReference:t.toJson()}};b.preserveScale&&l.mixin(k.mapOptions,{scale:b.outScale||a.getScale()});a.timeExtent&&l.mixin(k.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});t={};l.mixin(t,k,d);return t},_createOperationalLayers:function(a,b){var g,k,c,e,t=[];this.allLayerslegend=this.legendAll?[]:null;this._vtlExtent=null;var h=m.map(a.layerIds,a.getLayer,a);a._mapImageLyr&&h.push(a._mapImageLyr);for(g=0;g<h.length;g++)if(k=h[g],k.loaded&&k.visible)switch(c=
k.declaredClass,e={id:k.id,title:l.getObject("arcgisProps.title",!1,k)||k.id,opacity:k.opacity,minScale:k.minScale||0,maxScale:k.maxScale||0},e=l.mixin(e,this._getUrlAndToken(k)),k.getNode()&&I.get(k.getNode(),"data-reference")&&(e._isRefLayer=!0),c){case "esri.layers.ArcGISDynamicMapServiceLayer":var r=[];c=!!k._params.layers;if(k._params.dynamicLayers)c=u.fromJson(k._params.dynamicLayers),m.forEach(c,function(f){r.push({id:f.id,name:f.name,layerDefinition:f});delete f.id;delete f.name;delete f.maxScale;
delete f.minScale}),0===r.length&&(e.visibleLayers=[-1]);else if(k.supportsDynamicLayers){if(c||k.layerDefinitions||k.layerTimeOptions){var v=k.createDynamicLayerInfosFromLayerInfos(),f=null;c&&(f=k.visibleLayers);var f=d._getVisibleLayers(v,f),w=d._getLayersForScale(b.outScale||a.getScale(),v);m.forEach(v,function(a){if(!a.subLayerIds){var n=a.id;-1<m.indexOf(f,n)&&-1<m.indexOf(w,n)&&(a={source:a.source.toJson()},k.layerDefinitions&&k.layerDefinitions[n]&&(a.definitionExpression=k.layerDefinitions[n]),
k.layerTimeOptions&&k.layerTimeOptions[n]&&(a.layerTimeOptions=k.layerTimeOptions[n].toJson()),r.push({id:n,layerDefinition:a}))}});0===r.length&&(e.visibleLayers=[-1])}}else m.forEach(k.layerInfos,function(f){var a={id:f.id,layerDefinition:{}};k.layerDefinitions&&k.layerDefinitions[f.id]&&(a.layerDefinition.definitionExpression=k.layerDefinitions[f.id]);k.layerTimeOptions&&k.layerTimeOptions[f.id]&&(a.layerDefinition.layerTimeOptions=k.layerTimeOptions[f.id].toJson());(a.layerDefinition.definitionExpression||
a.layerDefinition.layerTimeOptions)&&r.push(a)}),c&&(e.visibleLayers=k.visibleLayers);r.length&&(e.layers=r);t.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:k.id,subLayerIds:k.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":e=l.mixin(e,{url:k.url,bandIds:k.bandIds,compressionQuality:k.compressionQuality,format:k.format,interpolation:k.interpolation});k.mosaicRule&&l.mixin(e,{mosaicRule:k.mosaicRule.toJson()});(k.renderingRule||k.renderer)&&(c=k.getExportImageRenderingRule())&&
l.mixin(e,{renderingRule:c.toJson()});t.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:k.id});break;case "esri.layers.WMSLayer":e=l.mixin(e,{url:k.url,title:k.title,type:"wms",version:k.version,transparentBackground:k.imageTransparency,visibleLayers:k.visibleLayers});t.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:k.id,subLayerIds:k.visibleLayers});break;case "esri.virtualearth.VETiledLayer":c=k.mapStyle;"roadOnDemand"===c?c="Road":"aerialWithLabels"===c&&(c="Hybrid");e=
l.mixin(e,{visibility:k.visible,type:"BingMaps"+c,culture:k.culture,key:k.bingMapsKey});t.push(e);break;case "esri.layers.OpenStreetMapLayer":e=l.mixin(e,{credits:k.copyright,type:"OpenStreetMap",url:q.getAbsoluteUrl(k.tileServers[0])});t.push(e);break;case "esri.layers.WMTSLayer":e=l.mixin(e,{url:k.url,type:"wmts",layer:k._identifier,style:k._style,format:k.format,tileMatrixSet:k._tileMatrixSetId});t.push(e);break;case "esri.layers.MapImageLayer":c=k.getImages();m.forEach(c,function(f,a){f.href&&
(e={id:k.id+"_image"+a,type:"image",title:k.id,minScale:k.minScale||0,maxScale:k.maxScale||0,opacity:k.opacity*f.opacity,extent:f.extent.toJson()},"data:image/png;base64,"===f.href.substr(0,22)?e.imageData=f.href.substr(22):e.url=f.href,t.push(e))});break;case "esri.layers.VectorTileLayer":e.type="image";e.url&&delete e.url;c=this._vtlExtent||a.extent.offset(0,0);var n=b.exportOptions&&b.exportOptions.dpi||96,v={format:"png",pixelRatio:n/96};"MAP_ONLY"!==b.layout||!b.preserveScale||b.outScale&&b.outScale!==
a.getScale()||96!==n||!b.exportOptions||b.exportOptions.width%2===a.width%2&&b.exportOptions.height%2===a.height%2||(v.area={x:0,y:0,width:a.width,height:a.height},b.exportOptions.width%2!==a.width%2&&--v.area.width,b.exportOptions.height%2!==a.height%2&&--v.area.height,this._vtlExtent||(n=a.toMap({x:v.area.width,y:v.area.height}),c.update(c.xmin,n.y,n.x,c.ymax,c.spatialReference),this._vtlExtent=c));e.extent=c._normalize(!0).toJson();c=k.takeScreenshot(v);c.isResolved()?c.then(function(f){"data:image/png;base64,"===
f.dataURL.substr(0,22)&&(e.imageData=f.dataURL.substr(22))}):console.error("PrintTask: VectorTileLayer.takeScreenshot() returned an unresolved Promise");e.imageData&&t.push(e);break;case "esri.layers.WebTiledLayer":c=k.url.replace(/\$\{/g,"{");e=l.mixin(e,{type:"WebTiledLayer",urlTemplate:c,credits:k.copyright});k.subDomains&&0<k.subDomains.length&&(e.subDomains=k.subDomains);k._wmtsInfo&&(e.wmtsInfo=k._wmtsInfo);delete e.url;t.push(e);break;default:if(k.getTileUrl||k.getImageUrl)e=l.mixin(e,{url:k.url}),
t.push(e)}for(g=0;g<a.graphicsLayerIds.length;g++)if(k=a.getLayer(a.graphicsLayerIds[g]),k.loaded&&k.visible)switch(c=k.declaredClass,c){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===c&&!b.showLabels||k.renderer&&"esri.renderer.HeatmapRenderer"===k.renderer.declaredClass)continue;h=null;k.url&&k.renderer&&("esri.renderer.ScaleDependentRenderer"===k.renderer.declaredClass?"scale"===k.renderer.rangeType?
h=k.renderer.getRendererInfoByScale(a.getScale())&&k.renderer.getRendererInfoByScale(a.getScale()).renderer:"zoom"===k.renderer.rangeType&&(h=k.renderer.getRendererInfoByZoom(a.getZoom())&&k.renderer.getRendererInfoByZoom(a.getZoom()).renderer):h=k.renderer);if(h&&("esri.renderer.SimpleRenderer"===h.declaredClass||"esri.renderer.TemporalRenderer"===h.declaredClass||l.isString(h.attributeField)&&k._getField(h.attributeField,!0))&&!h._compiledFunc&&!this._isFeatureCollectionRequired(h)&&"esri.renderer.DotDensityRenderer"!==
h.declaredClass&&"esri.layers.CSVLayer"!==k.declaredClass&&"esri.layers.StreamLayer"!==k.declaredClass)if(e={id:k.id,title:l.getObject("arcgisProps.title",!1,k)||k.id,opacity:k.opacity,minScale:k.minScale||0,maxScale:k.maxScale||0,layerDefinition:{drawingInfo:{renderer:h.toJson({useLegacyRotationProperties:!0})}}},e=l.mixin(e,this._getUrlAndToken(k)),"esri.renderer.TemporalRenderer"===h.declaredClass&&(c=e.layerDefinition.drawingInfo,c.latestObservationRenderer=c.renderer.latestObservationRenderer,
c.trackLinesRenderer=c.renderer.trackRenderer,c.observationAger=c.renderer.observationAger,c.renderer=c.renderer.observationRenderer,k._trackIdField&&(e.layerDefinition.timeInfo={trackIdField:k._trackIdField})),this._convertSvgRenderer(e.layerDefinition.drawingInfo.renderer),1>k.opacity||"esri.renderer.TemporalRenderer"===h.declaredClass||this._updateLayerOpacity(e))if(k._params.source&&(h=k._params.source.toJson(),l.mixin(e.layerDefinition,{source:h})),k.getDefinitionExpression()&&l.mixin(e.layerDefinition,
{definitionExpression:k.getDefinitionExpression()}),2!==k.mode)0<k.getSelectedFeatures().length&&(h=m.map(k.getSelectedFeatures(),function(f){return f.attributes[k.objectIdField]}),0<h.length&&k.getSelectionSymbol()&&l.mixin(e,{selectionObjectIds:h,selectionSymbol:k.getSelectionSymbol().toJson()}));else{h=m.map(k.getSelectedFeatures(),function(f){return f.attributes[k.objectIdField]});if(0===h.length||!k._params.drawMode)break;l.mixin(e.layerDefinition,{objectIds:h});h=null;k.getSelectionSymbol()&&
(h=new E(k.getSelectionSymbol()));l.mixin(e.layerDefinition.drawingInfo,{renderer:h&&h.toJson()})}else e=this._createFeatureCollection(k,a);else e=h&&(h._compiledFunc||this._isFeatureCollectionRequired(h)||"esri.renderer.DotDensityRenderer"===h.declaredClass)?this._createFeatureCollection(k,a,h):this._createFeatureCollection(k,a);if(!e)continue;t.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:k.id});break;case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":if(e=this._createFeatureCollection(k,
a))t.push(e),this.allLayerslegend&&this.allLayerslegend.push({id:k.id})}a.graphics&&0<a.graphics.graphics.length&&(e=this._createFeatureCollection(a.graphics,a))&&t.push(e);a._labels&&b.showLabels&&(e=this._createFeatureCollection(a._labels,a))&&t.push(e);m.forEach(t,function(f,a,n){f._isRefLayer&&(delete f._isRefLayer,n.splice(a,1),n.push(f))});return t},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var b=this._colorEvaluator(a),
b=m.filter(b,function(a){return l.isArray(a)&&4===a.length}),d=!0;if(b.length){var e=b[0][3],c;for(c=1;c<b.length;c++)if(e!==b[c][3]){d=!1;break}if(d)for(a.opacity=e/255,c=0;c<b.length;c++)b[c][3]=255}return d},_isFeatureCollectionRequired:function(a){var b=!1,d=this._getVariable(a,"rotationInfo",!1);d&&(b=(b=d.field)&&l.isFunction(b)||d.valueExpression);return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||a.hasVisualVariables("opacityInfo")||b},_getVariable:function(a,b,d){var e;
a&&(e=(a=a.getVisualVariablesForType(b,d))&&a[0]);return e},_applyVisualVariables:function(a,b){var d=b.renderer,e=b.graphic,c=b.symbol,h=b.mapResolution,g=b.mapScale,q=c.type;if("textsymbol"!==q&&"shieldlabelsymbol"!==q){var t=this._getVariable(d,"sizeInfo",!1),v=this._getVariable(d,"colorInfo",!1),f=this._getVariable(d,"opacityInfo",!1),w=this._getVariable(d,"rotationInfo",!1);c instanceof C&&(t=this._getVariable(d,"sizeInfo","outline")||t);t&&(c=d.getSize(e,{sizeInfo:t,shape:"simplemarkersymbol"===
q?c.style:null,resolution:h,scale:g}),null!=c&&("simplemarkersymbol"===q?a.size=B.px2pt(c):"picturemarkersymbol"===q?(a.width=B.px2pt(c),a.height=B.px2pt(c)):"simplelinesymbol"===q?a.width=B.px2pt(c):a.outline&&(a.outline.width=B.px2pt(c))));v&&(!(v=d.getColor(e,{colorInfo:v}))||"simplemarkersymbol"!==q&&"simplelinesymbol"!==q&&"simplefillsymbol"!==q||(a.color=r.toJsonColor(v)));f&&(q=d.getOpacity(e,{opacityInfo:f}),null!=q&&a.color&&(a.color[3]=Math.round(255*q)));w&&(d=d.getRotationAngle(e,{rotationInfo:w}))&&
(a.angle=-d)}}});v("extend-esri")&&l.setObject("tasks.PrintTask",c,e);return c})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),function(c,
l,m,u,x,v,e,g,d,b,r,q,h,a,E,C,z,y,I,A,B,F,G){c=c(q,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=l.hitch(this,this._jobUpdateHandler);this._getJobStatus=l.hitch(this,this._getJobStatus);this._getResultDataHandler=
l.hitch(this,this._getResultDataHandler);this._getResultImageHandler=l.hitch(this,this._getResultImageHandler);this._executeHandler=l.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,b,d){for(var e in a){var c=a[e];l.isArray(c)?a[e]=x.toJson(m.map(c,function(a){return this._gpEncode({item:a},!0).item},this)):c instanceof Date&&(a[e]=c.getTime())}return this._encode(a,b,d)},_decode:function(a){var b=a.dataType,
d=new A(a);if(-1!==m.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],b))return d;if("GPLinearUnit"===b)d.value=new C(d.value);else if("GPFeatureRecordSetLayer"===b||"GPRecordSet"===b)d.value=new h(d.value);else if("GPDataFile"===b)d.value=new z(d.value);else if("GPDate"===b)a=d.value,l.isString(a)?d.value=new I({date:a}):d.value=new Date(a);else if("GPRasterData"===b||"GPRasterDataLayer"===b)a=a.value.mapImage,d.value=a?new G(a):new y(d.value);else if(-1!==b.indexOf("GPMultiValue:")){var e=b.split(":")[1];
a=d.value;d.value=m.map(a,function(a){return this._decode({paramName:"_name",dataType:e,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+d.dataType),d=null;return d},submitJob:function(a,b,e,c,h){var k=this._getOutSR(),g=h.assembly;a=this._gpEncode(l.mixin({},this._url.query,{f:"json","env:outSR":k?k.wkid||x.toJson(k.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||x.toJson(this.processSpatialReference.toJson()):
null},a),null,g&&g[0]);var q=this._jobUpdateHandler,r=this._errorHandler;return d({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,f){q(a,f,!1,b,e,h.dfd)},error:function(a){r(a,c,h.dfd)}})},_jobUpdateHandler:function(b,d,e,c,h,g){var k=b.jobId;d=new a(b);this._successHandler([d],"onStatusUpdate",h,e&&g);if(!e)switch(clearTimeout(this._updateTimers[k]),this._updateTimers[k]=null,g&&g.progress(d),b.jobStatus){case a.STATUS_SUBMITTED:case a.STATUS_EXECUTING:case a.STATUS_WAITING:case a.STATUS_NEW:var q=
this._getJobStatus;this._updateTimers[k]=setTimeout(function(){q(k,e,c,h,g)},this.updateDelay);break;default:this._successHandler([d],"onJobComplete",c,g)}},_getJobStatus:function(a,b,e,c,h){var g=this._jobUpdateHandler;d({url:this._url.path+"/jobs/"+a,content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,d){g(a,d,b,e,c,h)},error:this._errorHandler})},_getResultDataHandler:function(a,b,d,e,c){try{var h=this._decode(a);this._successHandler([h],"onGetResultDataComplete",
d,c)}catch(H){this._errorHandler(H,e,c)}},getResultData:function(a,e,c,h){var g=this._getResultDataHandler,k=this._errorHandler,q=new u(b._dfdCanceller);q._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+e,content:l.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){g(a,b,c,h,q)},error:function(a){k(a,h,q)}});return q},checkJobStatus:function(a,e,c){var h=this._jobUpdateHandler,g=this._errorHandler,q=new u(b._dfdCanceller);q._pendingDfd=
d({url:this._url.path+"/jobs/"+a,content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,b){h(a,b,!0,null,e,q)},error:function(a){g(a,c,q)}});return q},cancelJob:function(a,e,c){var h=this._errorHandler,g=new u(b._dfdCanceller);g._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/cancel",content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:l.hitch(this,function(a,b){this._successHandler([a],"onJobCancel",e,g)}),error:function(a){h(a,c,g)}});
return g},execute:function(a,b,e,c){var h=this._getOutSR(),g=c.assembly;a=this._gpEncode(l.mixin({},this._url.query,{f:"json","env:outSR":h?h.wkid||x.toJson(h.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||x.toJson(this.processSpatialReference.toJson()):null},a),null,g&&g[0]);var q=this._executeHandler,k=this._errorHandler;return d({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,d){q(a,d,b,e,c.dfd)},error:function(a){k(a,
e,c.dfd)}})},_executeHandler:function(a,b,d,e,c){try{var h=a.results,g,q,k=a.messages;g=0;for(q=h.length;g<q;g++)h[g]=this._decode(h[g]);g=0;for(q=k.length;g<q;g++)k[g]=new E(k[g]);this._successHandler([h,k],"onExecuteComplete",d,c)}catch(M){this._errorHandler(M,e,c)}},_getResultImageHandler:function(a,b,d,e,c){try{var g=this._decode(a);this._successHandler([g],"onGetResultImageComplete",d,c)}catch(H){this._errorHandler(H,e,c)}},getResultImage:function(a,e,c,g,h){var q=this._getResultImageHandler,
k=this._errorHandler;c=this._gpEncode(l.mixin({},this._url.query,{f:"json"},c.toJson()));var r=new u(b._dfdCanceller);r._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+e,content:c,callbackParamName:"callback",load:function(a,b){q(a,b,g,h,r)},error:function(a){k(a,h,r)}});return r},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,d,c){if(null==b){var g=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
g)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+b;this._url.query&&(a+="?"+e.objectToQuery(this._url.query));b=null==b?new F(a,{imageParameters:d}):new B(a,{imageParameters:d},!0);this.onGetResultImageLayerComplete(b);c&&c(b);return b},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});r._createWrappers(c);
v("extend-esri")&&l.setObject("tasks.Geoprocessor",c,g);return c})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(c,l,m,u,x){c=c(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(c){this.messages=[];l.mixin(this,c);c=this.messages;var e,g=c.length;for(e=0;e<g;e++)c[e]=new x(c[e])},jobId:"",jobStatus:""});l.mixin(c,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",
STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});m("extend-esri")&&l.setObject("tasks.JobInfo",c,u);return c})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(c){l.mixin(this,
c)}});l.mixin(c,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});m("extend-esri")&&l.setObject("tasks.GPMessage",c,u);return c})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(c){c&&l.mixin(this,c)},distance:0,units:null,toJson:function(){var c={};this.distance&&(c.distance=this.distance);this.units&&(c.units=this.units);return c}});m("extend-esri")&&l.setObject("tasks.LinearUnit",c,u);return c})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.DataFile",
constructor:function(c){c&&l.mixin(this,c)},url:null,itemID:null,toJson:function(){var c={};this.url&&(c.url=this.url);this.itemID&&(c.itemID=this.itemID);return c}});m("extend-esri")&&l.setObject("tasks.DataFile",c,u);return c})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.RasterData",constructor:function(c){c&&l.mixin(this,c)},url:null,format:null,itemID:null,toJson:function(){var c=
{};this.url&&(c.url=this.url);this.format&&(c.format=this.format);this.itemID&&(c.itemID=this.itemID);return c}});m("extend-esri")&&l.setObject("tasks.RasterData",c,u);return c})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(c,l,m,u,x){c=c(null,{declaredClass:"esri.tasks.Date",constructor:function(c){c&&(c.format&&(this.format=c.format),this.date=m.parse(c.date,{selector:"date",datePattern:this.format}))},date:new Date,
format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:m.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});u("extend-esri")&&l.setObject("tasks.Date",c,x);return c})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(c){l.mixin(this,c)}});m("extend-esri")&&l.setObject("tasks.ParameterValue",c,u);return c})},
"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(c,l,m,u,x,v,e){c=c(e,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(c,d){d&&d.imageParameters&&d.imageParameters.extent&&(this.initialExtent=this.fullExtent=d.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=l.hitch(this,this.getImageUrl);
this.loaded=!0;this.onLoad(this)},getImageUrl:function(c,d,b,e){var g=c.spatialReference.wkid;e(this._url.path+"?"+x.objectToQuery(l.mixin(this._params,{f:"image",bbox:m.toJson(c.toJson()),bboxSR:g,imageSR:g,size:d+","+b})))}});u("extend-esri")&&l.setObject("tasks._GPResultImageLayer",c,v);return c})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,
height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null,showLabels:!0});m("extend-esri")&&l.setObject("tasks.PrintTemplate",c,u);return c})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(c,l,m,u,x,v,e,g,d,b,r,q,h){function a(a,b,n,c,d,e,g,h,q,k){var f,w,r=b.length,
D=0;k?(w=k.l/d,D=k.i):w=b[0]/d;for(;e<g;)e+w>g&&(f={l:(e+w-g)*d,i:D},w=g-e),D%2||(a.beginPath(),a.arc(n,c,d,e,e+w,h),q&&a.stroke()),e+=w,++D,w=b[D%r]/d;return f}function E(a,b,n,c){var f=0,w=0,d,e=0;c?(d=c.l,e=c.i):d=b[0];for(;1>w;)w=h.tAtLength(a,d),1==w&&(f=h.computeLength(a),f={l:d-f,i:e}),a=h.splitBezierAtT(a,w),e%2||n.push(a[0]),a=a[1],++e,d=b[e%b.length];return f}function C(a,b,n,d){var f=[b.last.x,b.last.y].concat(n),w=!(a instanceof Array);n=4===n.length?"quadraticCurveTo":"bezierCurveTo";
var c=[];b=E(f,b.canvasDash,c,d);for(d=0;d<c.length;++d)f=c[d],w?(a.moveTo(f[0],f[1]),a[n].apply(a,f.slice(2))):(a.push("moveTo",[f[0],f[1]]),a.push(n,f.slice(2)));return b}function z(a,b,n,d,c,e,g){var f=0,w=0,q=0,k=h.distance(n,d,c,e),r=0;b=b.canvasDash;var D=n,v=d,E,l=!(a instanceof Array);g?(q=g.l,r=g.i):q+=b[0];for(;.01<Math.abs(1-w);)q>k&&(f={l:q-k,i:r},q=k),w=q/k,g=n+(c-n)*w,E=d+(e-d)*w,r++%2||(l?(a.moveTo(D,v),a.lineTo(g,E)):(a.push("moveTo",[D,v]),a.push("lineTo",[g,E]))),D=g,v=E,q+=b[r%
b.length];return f}var y=c.canvas={},I=null,A=r.multiplyPoint,B=Math.PI,F=2*B,G=B/2;q=l.extend;if(x.global.CanvasRenderingContext2D){x=x.doc.createElement("canvas").getContext("2d");var t="function"==typeof x.setLineDash,L="function"==typeof x.fillText}var O={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};y.Shape=u("dojox.gfx.canvas.Shape",g.Shape,
{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var f=this.canvasTransform;a.translate(f.dx,f.dy);a.rotate(f.angle2);a.scale(f.sx,f.sy);a.rotate(f.angle1)}},_renderShape:function(a){},_renderFill:function(a,b){if("canvasFill"in this){var f=this.fillStyle;
if("canvasFillImage"in this){var w=f.width,d=f.height,c=this.canvasFillImage.width,e=this.canvasFillImage.height,g=Math.min(w==c?1:w/c,d==e?1:d/e),h=(w-g*c)/2,q=(d-g*e)/2;I.width=w;I.height=d;var k=I.getContext("2d");k.clearRect(0,0,w,d);k.drawImage(this.canvasFillImage,0,0,c,e,h,q,g*c,g*e);this.canvasFill=a.createPattern(I,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;b&&("pattern"!==f.type||0===f.x&&0===f.y||a.translate(f.x,f.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},
_renderStroke:function(a,b){var f=this.strokeStyle;f?(a.strokeStyle=f.color.toString(),a.lineWidth=f.width,a.lineCap=f.cap,"number"==typeof f.join?(a.lineJoin="miter",a.miterLimit=f.join):a.lineJoin=f.join,this.canvasDash?t?(a.setLineDash(this.canvasDash),b&&a.stroke()):this._renderDashedStroke(a,b):b&&a.stroke()):b||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,b){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,
setClip:function(a){this.inherited(arguments);var f=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!f)return this;this.canvasClip=a?k(f,a):null;this.parent&&this.parent._makeDirty();return this}});var k=function(a,b){switch(a){case "ellipse":return{canvasEllipse:N({shape:b}),render:function(a){return y.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:l.delegate(b,{r:0}),render:function(a){return y.Rect.prototype._renderShape.call(this,
a)}};case "path":return{canvasPath:P(b),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:b.points,render:function(a){return y.Polyline.prototype._renderShape.call(this,a)}}}return null},P=function(a){var f=new dojox.gfx.canvas.Path;f.canvasPath=[];f._setPath(a.d);return f},J=function(a,b,n){var f=a.prototype[b];a.prototype[b]=n?function(){this.parent&&this.parent._makeDirty();f.apply(this,arguments);n.call(this);return this}:function(){this.parent&&this.parent._makeDirty();
return f.apply(this,arguments)}};J(y.Shape,"setTransform",function(){this.matrix?this.canvasTransform=c.decompose(this.matrix):delete this.canvasTransform});J(y.Shape,"setFill",function(){var a=this.fillStyle,b;if(a){if("object"==typeof a&&"type"in a){var n=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":b="linear"==a.type?n.createLinearGradient(a.x1,a.y1,a.x2,a.y2):n.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);m.forEach(a.colors,function(a){b.addColorStop(a.offset,
c.normalizeColor(a.color).toString())});break;case "pattern":I||(I=document.createElement("canvas")),n=new Image,this.surface.downloadImage(n,a.src),this.canvasFillImage=n}}else b=a.toString();this.canvasFill=b}else delete this.canvasFill});J(y.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var b=this.strokeStyle.style.toLowerCase();b in O&&(b=O[b]);if(b instanceof Array){this.canvasDash=b=b.slice();var n;for(n=0;n<b.length;++n)b[n]*=a.width;if("butt"!=a.cap){for(n=0;n<b.length;n+=2)b[n]-=
a.width,1>b[n]&&(b[n]=1);for(n=1;n<b.length;n+=2)b[n]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!t&&!!this.canvasDash});J(y.Shape,"setShape");y.Group=u("dojox.gfx.canvas.Group",y.Shape,{constructor:function(){g.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var f=0;f<this.children.length;++f)this.children[f]._render(a);a.restore()},destroy:function(){g.Container.clear.call(this,!0);y.Shape.prototype.destroy.apply(this,
arguments)}});y.Rect=u("dojox.gfx.canvas.Rect",[y.Shape,g.Rect],{_renderShape:function(a){var f=this.shape,b=Math.min(f.r,f.height/2,f.width/2),d=f.x,c=d+f.width,e=f.y,f=e+f.height,g=d+b,h=c-b,q=e+b,k=f-b;a.beginPath();a.moveTo(g,e);b?(a.arc(h,q,b,-G,0,!1),a.arc(h,k,b,0,G,!1),a.arc(g,k,b,G,B,!1),a.arc(g,q,b,B,B+G,!1)):(a.lineTo(h,e),a.lineTo(c,k),a.lineTo(g,f),a.lineTo(d,q));a.closePath()},_renderDashedStroke:function(f,b){var n=this.shape,d=Math.min(n.r,n.height/2,n.width/2),c=n.x,e=c+n.width,w=
n.y,g=w+n.height,h=c+d,q=e-d,k=w+d,r=g-d;d?(f.beginPath(),n=z(f,this,h,w,q,w),b&&f.stroke(),n=a(f,this.canvasDash,q,k,d,-G,0,!1,b,n),f.beginPath(),n=z(f,this,e,k,e,r,n),b&&f.stroke(),n=a(f,this.canvasDash,q,r,d,0,G,!1,b,n),f.beginPath(),n=z(f,this,q,g,h,g,n),b&&f.stroke(),n=a(f,this.canvasDash,h,r,d,G,B,!1,b,n),f.beginPath(),n=z(f,this,c,r,c,k,n),b&&f.stroke(),a(f,this.canvasDash,h,k,d,B,B+G,!1,b,n)):(f.beginPath(),n=z(f,this,h,w,q,w),n=z(f,this,q,w,e,r,n),n=z(f,this,e,r,h,g,n),z(f,this,h,g,c,k,n),
b&&f.stroke())}});var H=[];(function(){var a=b.curvePI4;H.push(a.s,a.c1,a.c2,a.e);for(var d=45;360>d;d+=45){var n=r.rotateg(d);H.push(A(n,a.c1),A(n,a.c2),A(n,a.e))}})();var N=function(a){var b,f,d,c=[],e=a.shape,g=r.normalize([r.translate(e.cx,e.cy),r.scale(e.rx,e.ry)]);b=A(g,H[0]);c.push([b.x,b.y]);for(e=1;e<H.length;e+=3)f=A(g,H[e]),d=A(g,H[e+1]),b=A(g,H[e+2]),c.push([f.x,f.y,d.x,d.y,b.x,b.y]);if(a._needsDash){b=[];f=c[0];for(e=1;e<c.length;++e)d=[],E(f.concat(c[e]),a.canvasDash,d),f=[c[e][4],c[e][5]],
b.push(d);a._dashedPoints=b}return c};y.Ellipse=u("dojox.gfx.canvas.Ellipse",[y.Shape,g.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=N(this);return this},setStroke:function(){this.inherited(arguments);t||(this.canvasEllipse=N(this));return this},_renderShape:function(a){var b=this.canvasEllipse,f;a.beginPath();a.moveTo.apply(a,b[0]);for(f=1;f<b.length;++f)a.bezierCurveTo.apply(a,b[f]);a.closePath()},_renderDashedStroke:function(a,b){var f=this._dashedPoints;a.beginPath();
for(var d=0;d<f.length;++d)for(var c=f[d],e=0;e<c.length;++e){var g=c[e];a.moveTo(g[0],g[1]);a.bezierCurveTo(g[2],g[3],g[4],g[5],g[6],g[7])}b&&a.stroke()}});y.Circle=u("dojox.gfx.canvas.Circle",[y.Shape,g.Circle],{_renderShape:function(a){var b=this.shape;a.beginPath();a.arc(b.cx,b.cy,b.r,0,F,1)},_renderDashedStroke:function(a,b){var f=this.shape,d=0,c,e=this.canvasDash.length;for(i=0;d<F;)c=this.canvasDash[i%e]/f.r,i%2||(a.beginPath(),a.arc(f.cx,f.cy,f.r,d,d+c,0),b&&a.stroke()),d+=c,++i}});y.Line=
u("dojox.gfx.canvas.Line",[y.Shape,g.Line],{_renderShape:function(a){var b=this.shape;a.beginPath();a.moveTo(b.x1,b.y1);a.lineTo(b.x2,b.y2)},_renderDashedStroke:function(a,b){var f=this.shape;a.beginPath();z(a,this,f.x1,f.y1,f.x2,f.y2);b&&a.stroke()}});y.Polyline=u("dojox.gfx.canvas.Polyline",[y.Shape,g.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,b=a[0],d,c;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof b)b=a;else for(b=[],c=0;c<a.length;++c)d=
a[c],b.push(d.x,d.y);else b=[];this.canvasPolyline=b;return this},_renderShape:function(a){var b=this.canvasPolyline;if(b.length){a.beginPath();a.moveTo(b[0],b[1]);for(var f=2;f<b.length;f+=2)a.lineTo(b[f],b[f+1])}},_renderDashedStroke:function(a,b){var f=this.canvasPolyline,d=0;a.beginPath();for(var c=0;c<f.length;c+=2)d=z(a,this,f[c],f[c+1],f[c+2],f[c+3],d);b&&a.stroke()}});y.Image=u("dojox.gfx.canvas.Image",[y.Shape,g.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,
this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var b=this.shape;a.drawImage(this.canvasImage,b.x,b.y,b.width,b.height)}});y.Text=u("dojox.gfx.canvas.Text",[y.Shape,g.Text],{_setFont:function(){this.fontStyle?this.canvasFont=c.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,b=0,d;a.text&&(d=this.surface.rawNode.getContext("2d"),d.save(),this._renderTransform(d),this._renderFill(d,!1),this._renderStroke(d,!1),this.canvasFont&&
(d.font=this.canvasFont),b=d.measureText(a.text).width,d.restore());return b},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var b=this.shape;b.text&&(a.textAlign="middle"===b.align?"center":b.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(b.text,b.x,b.y),this.strokeStyle&&(a.beginPath(),a.strokeText(b.text,b.x,b.y),a.closePath()))}});J(y.Text,"setFont");L||
y.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var Q={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};y.Path=u("dojox.gfx.canvas.Path",[y.Shape,d.Path],{constructor:function(){this.lastControl=
{}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);t||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var b=l.clone(this.last);this[Q[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=b;this.inherited(arguments)},_renderShape:function(a){var b=this.canvasPath;
a.beginPath();for(var f=0;f<b.length;f+=2)a[b[f]].apply(a,b[f+1])},_renderDashedStroke:t?function(){}:function(a,b){var f=this._dashedPath;a.beginPath();for(var d=0;d<f.length;d+=2)a[f[d]].apply(a,f[d+1]);b&&a.stroke()},_moveToA:function(a,b,d,c){a.push("moveTo",[d[0],d[1]]);c&&c.push("moveTo",[d[0],d[1]]);for(b=2;b<d.length;b+=2)a.push("lineTo",[d[b],d[b+1]]),c&&(this._dashResidue=z(c,this,d[b-2],d[b-1],d[b],d[b+1],this._dashResidue));this.last.x=d[d.length-2];this.last.y=d[d.length-1];this.lastControl=
{}},_moveToR:function(a,b,d,c){b="x"in this.last?[this.last.x+=d[0],this.last.y+=d[1]]:[this.last.x=d[0],this.last.y=d[1]];a.push("moveTo",b);c&&c.push("moveTo",b);for(b=2;b<d.length;b+=2)a.push("lineTo",[this.last.x+=d[b],this.last.y+=d[b+1]]),c&&(this._dashResidue=z(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,d,c){for(b=0;b<d.length;b+=2)c&&(this._dashResidue=z(c,this,this.last.x,this.last.y,d[b],d[b+1],this._dashResidue)),
a.push("lineTo",[d[b],d[b+1]]);this.last.x=d[d.length-2];this.last.y=d[d.length-1];this.lastControl={}},_lineToR:function(a,b,d,c){for(b=0;b<d.length;b+=2)a.push("lineTo",[this.last.x+=d[b],this.last.y+=d[b+1]]),c&&(this._dashResidue=z(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,d,c){for(b=0;b<d.length;++b)a.push("lineTo",[d[b],this.last.y]),c&&(this._dashResidue=z(c,this,c[c.length-1][0],c[c.length-1][1],d[b],this.last.y,
this._dashResidue));this.last.x=d[d.length-1];this.lastControl={}},_hLineToR:function(a,b,d,c){for(b=0;b<d.length;++b)a.push("lineTo",[this.last.x+=d[b],this.last.y]),c&&(this._dashResidue=z(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,d,c){for(b=0;b<d.length;++b)a.push("lineTo",[this.last.x,d[b]]),c&&(this._dashResidue=z(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,d[b],this._dashResidue));this.last.y=d[d.length-
1];this.lastControl={}},_vLineToR:function(a,b,d,c){for(b=0;b<d.length;++b)a.push("lineTo",[this.last.x,this.last.y+=d[b]]),c&&(this._dashResidue=z(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,d,c){for(b=0;b<d.length;b+=6)a.push("bezierCurveTo",d.slice(b,b+6)),c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue));this.last.x=d[d.length-2];this.last.y=d[d.length-1];this.lastControl.x=d[d.length-4];this.lastControl.y=
d[d.length-3];this.lastControl.type="C"},_curveToR:function(a,b,d,c){for(b=0;b<d.length;b+=6)a.push("bezierCurveTo",[this.last.x+d[b],this.last.y+d[b+1],this.lastControl.x=this.last.x+d[b+2],this.lastControl.y=this.last.y+d[b+3],this.last.x+d[b+4],this.last.y+d[b+5]]),c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue)),this.last.x+=d[b+4],this.last.y+=d[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,d,c){for(b=0;b<d.length;b+=4){var f="C"==this.lastControl.type;a.push("bezierCurveTo",
[f?2*this.last.x-this.lastControl.x:this.last.x,f?2*this.last.y-this.lastControl.y:this.last.y,d[b],d[b+1],d[b+2],d[b+3]]);c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue));this.lastControl.x=d[b];this.lastControl.y=d[b+1];this.lastControl.type="C"}this.last.x=d[d.length-2];this.last.y=d[d.length-1]},_smoothCurveToR:function(a,b,d,c){for(b=0;b<d.length;b+=4){var f="C"==this.lastControl.type;a.push("bezierCurveTo",[f?2*this.last.x-this.lastControl.x:this.last.x,f?2*this.last.y-this.lastControl.y:
this.last.y,this.last.x+d[b],this.last.y+d[b+1],this.last.x+d[b+2],this.last.y+d[b+3]]);c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+d[b];this.lastControl.y=this.last.y+d[b+1];this.lastControl.type="C";this.last.x+=d[b+2];this.last.y+=d[b+3]}},_qCurveToA:function(a,b,d,c){for(b=0;b<d.length;b+=4)a.push("quadraticCurveTo",d.slice(b,b+4));c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue));this.last.x=d[d.length-2];this.last.y=d[d.length-
1];this.lastControl.x=d[d.length-4];this.lastControl.y=d[d.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,b,d,c){for(b=0;b<d.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+d[b],this.lastControl.y=this.last.y+d[b+1],this.last.x+d[b+2],this.last.y+d[b+3]]),c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue)),this.last.x+=d[b+2],this.last.y+=d[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,d,c){for(b=0;b<d.length;b+=2){var f="Q"==this.lastControl.type;
a.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,d[b],d[b+1]]);c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=d[d.length-2];this.last.y=d[d.length-1]},_qSmoothCurveToR:function(a,b,d,c){for(b=0;b<d.length;b+=2){var f="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:this.last.x,
this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+d[b],this.last.y+d[b+1]]);c&&(this._dashResidue=C(c,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=d[b];this.last.y+=d[b+1]}},_arcTo:function(a,d,c,e){d="a"==d;for(var f=0;f<c.length;f+=7){var g=c[f+5],h=c[f+6];d&&(g+=this.last.x,h+=this.last.y);var q=b.arcAsBezier(this.last,c[f],c[f+1],c[f+2],c[f+3]?1:0,c[f+4]?1:0,g,h);m.forEach(q,function(b){a.push("bezierCurveTo",b)});e&&(this._dashResidue=
C(e,this,p,this._dashResidue));this.last.x=g;this.last.y=h}this.lastControl={}},_closePath:function(a,b,d,c){a.push("closePath",[]);c&&(this._dashResidue=z(c,this,this.last.x,this.last.y,c[1][0],c[1][1],this._dashResidue));this.lastControl={}}});m.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){J(y.Path,a)});y.TextPath=u("dojox.gfx.canvas.TextPath",[y.Shape,d.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});
y.Surface=u("dojox.gfx.canvas.Surface",g.Surface,{constructor:function(){g.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){g.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=c.normalizedLength(a);this.height=c.normalizedLength(b);if(!this.rawNode)return this;var d=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,d=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,d=!0);d&&
this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||
"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(l.hitch(this,this._render),0))},downloadImage:function(a,b){var d=l.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=d;a.onerror=d;a.onabort=d;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},
on:function(){}});y.createSurface=function(a,b,d){if(!b&&!d){var f=v.position(a);b=b||f.w;d=d||f.h}"number"==typeof b&&(b+="px");"number"==typeof d&&(d+="px");f=new y.Surface;a=e.byId(a);var g=a.ownerDocument.createElement("canvas");g.width=c.normalizedLength(b);g.height=c.normalizedLength(d);a.appendChild(g);f.rawNode=g;f._parent=a;return f.surface=f};var M=g.Container;u={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();
return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return M.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return M.remove.apply(this,arguments)},clear:function(){this._makeDirty();return M.clear.apply(this,arguments)},getBoundingBox:M.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return M._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return M._moveChildToBack.apply(this,
arguments)}};d={createObject:function(a,b){var d=new a;d.surface=this.surface;d.setShape(b);this.add(d);return d}};q(y.Group,u);q(y.Group,g.Creator);q(y.Group,d);q(y.Surface,u);q(y.Surface,g.Creator);q(y.Surface,d);y.fixTarget=function(a,b){return!0};return y})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(c,l,m,u,x,v,e,g,d,b){function r(a,
b){if(!q)return a.splice(b,1);var d=a.length;if(d){for(;b<d;)a[b]=a[b+1],b++;a.length--}}var q=!!x("chrome"),h=c.shape={};h.Shape=m("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(x("gfxRegistry")){var a=h.register(this);this.getUID=function(){return a}}},destroy:function(){x("gfxRegistry")&&h.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=
null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var d=this._getRealMatrix();return[b.multiplyPoint(d,a.x,a.y),b.multiplyPoint(d,a.x+a.width,a.y),
b.multiplyPoint(d,a.x+a.width,a.y+a.height),b.multiplyPoint(d,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=c.makeParameters(c.defaultLinearGradient,a);break;case "radial":b=c.makeParameters(c.defaultRadialGradient,
a);break;case "pattern":b=c.makeParameters(c.defaultPattern,a)}else b=c.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||l.isArray(a)||a instanceof d)a={color:a};a=this.strokeStyle=c.makeParameters(c.defaultStroke,a);a.color=c.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=
this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&
this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,d=this.parent;d;)d.matrix&&(a=b.multiply(d.matrix,a)),d=d.parent;return a}});h._eventsProcessing={on:function(a,b){return v(this.getEventSource(),a,h.fixCallback(this,c.fixTarget,b))},connect:function(a,b,d){"on"==a.substring(0,2)&&(a=a.substring(2));
return this.on(a,d?l.hitch(b,d):b)},disconnect:function(a){return a.remove()}};h.fixCallback=function(a,b,d,c){c||(c=d,d=null);if(l.isString(c)){d=d||u.global;if(!d[c])throw['dojox.gfx.shape.fixCallback: scope["',c,'"] is null (scope\x3d"',d,'")'].join("");return function(e){return b(e,a)?d[c].apply(d,arguments||[]):void 0}}return d?function(e){return b(e,a)?c.apply(d,arguments||[]):void 0}:function(e){return b(e,a)?c.apply(d,arguments):void 0}};l.extend(h.Shape,h._eventsProcessing);h.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var d=0;d<this.children.length;++d)if(this.children[d]==a){b||(a.parent=null,a.parentMatrix=null);r(this.children,d);break}return this},clear:function(a){for(var b,d=0;d<this.children.length;++d)b=this.children[d],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;e.forEach(this.children,function(d){var c=d.getBoundingBox();c&&((d=d.getTransform())&&(c=b.multiplyRectangle(d,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){r(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){r(this.children,b);this.children.unshift(a);break}return this}};h.Surface=m("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){e.forEach(this._nodes,g.destroy);this._nodes=[];e.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(x("ie"))for(;this._parent.lastChild;)g.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var d=l.hitch(a,b);if(this.isLoaded)d(this);else v.once(this,"load",function(a){d(a)})}});l.extend(h.Surface,h._eventsProcessing);h.Rect=m("dojox.gfx.shape.Rect",h.Shape,{constructor:function(a){this.shape=c.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});h.Ellipse=m("dojox.gfx.shape.Ellipse",h.Shape,{constructor:function(a){this.shape=c.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});h.Circle=m("dojox.gfx.shape.Circle",h.Shape,{constructor:function(a){this.shape=c.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});h.Line=m("dojox.gfx.shape.Line",h.Shape,{constructor:function(a){this.shape=c.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});h.Polyline=m("dojox.gfx.shape.Polyline",h.Shape,{constructor:function(a){this.shape=c.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var d=[],c=0;c<b;c+=2)d.push({x:a[c],y:a[c+1]});this.shape.points=d}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,d=a[0],c=d.x,e=d.y,g=d.x,h=d.y,q=1;q<b;++q)d=
a[q],c>d.x&&(c=d.x),g<d.x&&(g=d.x),e>d.y&&(e=d.y),h<d.y&&(h=d.y);this.bbox={x:c,y:e,width:g-c,height:h-e}}return this.bbox}});h.Image=m("dojox.gfx.shape.Image",h.Shape,{constructor:function(a){this.shape=c.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});h.Text=m(h.Shape,{constructor:function(a){this.fontStyle=null;this.shape=c.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?c.splitFontString(a):c.makeParameters(c.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=c._base._computeTextBoundingBox(this));return a}});h.Creator={createShape:function(a){switch(a.type){case c.defaultPath.type:return this.createPath(a);case c.defaultRect.type:return this.createRect(a);case c.defaultCircle.type:return this.createCircle(a);case c.defaultEllipse.type:return this.createEllipse(a);
case c.defaultLine.type:return this.createLine(a);case c.defaultPolyline.type:return this.createPolyline(a);case c.defaultImage.type:return this.createImage(a);case c.defaultText.type:return this.createText(a);case c.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(c.Group)},createRect:function(a){return this.createObject(c.Rect,a)},createEllipse:function(a){return this.createObject(c.Ellipse,a)},createCircle:function(a){return this.createObject(c.Circle,
a)},createLine:function(a){return this.createObject(c.Line,a)},createPolyline:function(a){return this.createObject(c.Polyline,a)},createImage:function(a){return this.createObject(c.Image,a)},createText:function(a){return this.createObject(c.Text,a)},createPath:function(a){return this.createObject(c.Path,a)},createTextPath:function(a){return this.createObject(c.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return h})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/declare","./matrix","./shape"],function(c,l,m,u,x){x=m("dojox.gfx.path.Path",x.Shape,{constructor:function(v){this.shape=l.clone(c.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=v;this.segmented=!1},setAbsoluteMode:function(c){this._confirmSegmented();this.absolute="string"==typeof c?"absolute"==c:c;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&
"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var c=this.bbox,e=this._getRealMatrix();this.bbox=null;for(var g=0,d=this.segments.length;g<d;++g)this._updateWithSegment(this.segments[g],e);e=this.bbox;this.bbox=c;return this.tbbox=e?[{x:e.l,y:e.t},{x:e.r,y:e.t},{x:e.r,y:e.b},{x:e.l,y:e.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in
this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(c,e,g){g&&(e=u.multiplyPoint(g,c,e),c=e.x,e=e.y);this.bbox&&"l"in this.bbox?(this.bbox.l>c&&(this.bbox.l=c),this.bbox.r<c&&(this.bbox.r=c),this.bbox.t>e&&(this.bbox.t=e),this.bbox.b<e&&(this.bbox.b=e)):this.bbox={l:c,b:e,r:c,t:e}},_updateWithSegment:function(v,e){var g=v.args,d=g.length,b;switch(v.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<d;b+=2)this._updateBBox(g[b],
g[b+1],e);this.last.x=g[d-2];this.last.y=g[d-1];this.absolute=!0;break;case "H":for(b=0;b<d;++b)this._updateBBox(g[b],this.last.y,e);this.last.x=g[d-1];this.absolute=!0;break;case "V":for(b=0;b<d;++b)this._updateBBox(this.last.x,g[b],e);this.last.y=g[d-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=g[0],this.last.y=g[1],e),b=2);for(;b<d;b+=2)this._updateBBox(this.last.x+=g[b],this.last.y+=g[b+1],e);this.absolute=!1;break;case "l":case "t":for(b=0;b<d;b+=2)this._updateBBox(this.last.x+=
g[b],this.last.y+=g[b+1],e);this.absolute=!1;break;case "h":for(b=0;b<d;++b)this._updateBBox(this.last.x+=g[b],this.last.y,e);this.absolute=!1;break;case "v":for(b=0;b<d;++b)this._updateBBox(this.last.x,this.last.y+=g[b],e);this.absolute=!1;break;case "c":for(b=0;b<d;b+=6)this._updateBBox(this.last.x+g[b],this.last.y+g[b+1],e),this._updateBBox(this.last.x+g[b+2],this.last.y+g[b+3],e),this._updateBBox(this.last.x+=g[b+4],this.last.y+=g[b+5],e);this.absolute=!1;break;case "s":case "q":for(b=0;b<d;b+=
4)this._updateBBox(this.last.x+g[b],this.last.y+g[b+1],e),this._updateBBox(this.last.x+=g[b+2],this.last.y+=g[b+3],e);this.absolute=!1;break;case "A":for(b=0;b<d;b+=7)this._updateBBox(g[b+5],g[b+6],e);this.last.x=g[d-2];this.last.y=g[d-1];this.absolute=!0;break;case "a":for(b=0;b<d;b+=7)this._updateBBox(this.last.x+=g[b+5],this.last.y+=g[b+6],e);this.absolute=!1}var r=[v.action];for(b=0;b<d;++b)r.push(c.formatNumber(g[b],!0));if("string"==typeof this.shape.path)this.shape.path+=r.join("");else for(b=
0,d=r.length;b<d;++b)this.shape.path.push(r[b])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(c,e){this.tbbox=null;var g=this._validSegments[c.toLowerCase()];"number"==typeof g&&(g?e.length>=g&&(g={action:c,args:e.slice(0,e.length-e.length%g)},this.segments.push(g),this._updateWithSegment(g)):(g={action:c,args:[]},this.segments.push(g),this._updateWithSegment(g)))},_collectArgs:function(c,e){for(var g=0;g<e.length;++g){var d=e[g];"boolean"==typeof d?c.push(d?1:0):
"number"==typeof d?c.push(d):d instanceof Array?this._collectArgs(c,d):"x"in d&&"y"in d&&c.push(d.x,d.y)}},moveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"M":"m",c);return this},lineTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"L":"l",c);return this},hLineTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?
"H":"h",c);return this},vLineTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"V":"v",c);return this},curveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"C":"c",c);return this},smoothCurveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"S":"s",c);return this},qCurveTo:function(){this._confirmSegmented();var c=
[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"Q":"q",c);return this},qSmoothCurveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"T":"t",c);return this},arcTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"A":"a",c);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var c=
this.shape.path;this.shape.path=[];this._setPath(c);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(m){m=l.isArray(m)?m:m.match(c.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(m){for(var e="",g=[],d=m.length,b=0;b<d;++b){var r=m[b],q=parseFloat(r);isNaN(q)?(e&&this._pushSegment(e,g),g=[],e=r):g.push(q)}this._pushSegment(e,g)}},setShape:function(m){this.inherited(arguments,["string"==typeof m?{path:m}:m]);this.segmented=!1;this.segments=
[];c.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});m=m("dojox.gfx.path.TextPath",x,{constructor:function(m){"text"in this||(this.text=l.clone(c.defaultTextPath));"fontStyle"in this||(this.fontStyle=l.clone(c.defaultFont))},getText:function(){return this.text},setText:function(m){this.text=c.makeParameters(this.text,"string"==typeof m?{text:m}:m);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(m){this.fontStyle="string"==typeof m?
c.splitFontString(m):c.makeParameters(c.defaultFont,m);this._setFont();return this}});return c.path={Path:x,TextPath:m}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(c,l,m){function u(b){var d=Math.cos(b);b=Math.sin(b);var c={x:d+4/3*(1-d),y:b-4/3*d*(1-d)/b};return{s:{x:d,y:-b},c1:{x:c.x,y:-c.y},c2:c,e:{x:d,y:b}}}var x=2*Math.PI,v=Math.PI/4,e=Math.PI/8,g=v+e,d=u(e);return c.arc={unitArcAsBezier:u,curvePI4:d,arcAsBezier:function(b,c,q,h,a,l,C,z){a=!!a;l=!!l;
var r=m._degToRad(h);h=c*c;var E=q*q,A=m.multiplyPoint(m.rotate(-r),{x:(b.x-C)/2,y:(b.y-z)/2}),B=A.x*A.x,F=A.y*A.y;h=Math.sqrt((h*E-h*F-E*B)/(h*F+E*B));isNaN(h)&&(h=0);h={x:h*c*A.y/q,y:-h*q*A.x/c};a==l&&(h={x:-h.x,y:-h.y});h=m.multiplyPoint([m.translate((b.x+C)/2,(b.y+z)/2),m.rotate(r)],h);c=m.normalize([m.translate(h.x,h.y),m.rotate(r),m.scale(c,q)]);h=m.invert(c);b=m.multiplyPoint(h,b);z=m.multiplyPoint(h,C,z);C=Math.atan2(b.y,b.x);h=C-Math.atan2(z.y,z.x);l&&(h=-h);0>h?h+=x:h>x&&(h-=x);q=e;z=d;
q=l?q:-q;b=[];for(a=h;0<a;a-=v)a<g&&(q=a/2,z=u(q),q=l?q:-q,a=0),A=m.normalize([c,m.rotate(C+q)]),l?(h=m.multiplyPoint(A,z.c1),r=m.multiplyPoint(A,z.c2),A=m.multiplyPoint(A,z.e)):(h=m.multiplyPoint(A,z.c2),r=m.multiplyPoint(A,z.c1),A=m.multiplyPoint(A,z.s)),b.push([h.x,h.y,r.x,r.y,A.x,A.y]),C+=2*q;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(c,l,m){function u(d,b){return Math.abs(d-b)<=1E-6*(Math.abs(d)+Math.abs(b))}function x(d,b,c,e){if(!isFinite(d))return c;
if(!isFinite(c))return d;b=Math.abs(b);e=Math.abs(e);return(b*d+e*c)/(b+e)}function v(d){d=m.normalize(d);var b=-d.xx-d.yy,c=d.xx*d.yy-d.xy*d.yx,e=Math.sqrt(b*b-4*c),b=-(b+(0>b?-e:e))/2,c=c/b,e=d.xy/(b-d.xx),g=1,a=d.xy/(c-d.xx),l=1;u(b,c)&&(e=1,a=g=0,l=1);isFinite(e)||(e=1,g=(b-d.xx)/d.xy,isFinite(g)||(e=(b-d.yy)/d.yx,g=1,isFinite(e)||(e=1,g=d.yx/(b-d.yy))));isFinite(a)||(a=1,l=(c-d.xx)/d.xy,isFinite(l)||(a=(c-d.yy)/d.yx,l=1,isFinite(a)||(a=1,l=d.yx/(c-d.yy))));d=Math.sqrt(e*e+g*g);var v=Math.sqrt(a*
a+l*l);isFinite(e/=d)||(e=0);isFinite(g/=d)||(g=0);isFinite(a/=v)||(a=0);isFinite(l/=v)||(l=0);return{value1:b,value2:c,vector1:{x:e,y:g},vector2:{x:a,y:l}}}function e(d,b){var c=0>d.xx*d.yy||0<d.xy*d.yx?-1:1,e=b.angle1=(Math.atan2(d.yx,d.yy)+Math.atan2(-c*d.xy,c*d.xx))/2,c=Math.cos(e),e=Math.sin(e);b.sx=x(d.xx/c,c,-d.xy/e,e);b.sy=x(d.yy/c,c,d.yx/e,e);return b}function g(d,b){var c=0>d.xx*d.yy||0<d.xy*d.yx?-1:1,e=b.angle2=(Math.atan2(c*d.yx,c*d.xx)+Math.atan2(-d.xy,d.yy))/2,c=Math.cos(e),e=Math.sin(e);
b.sx=x(d.xx/c,c,d.yx/e,e);b.sy=x(d.yy/c,c,-d.xy/e,e);return b}return c.decompose=function(d){var b=m.normalize(d);d={dx:b.dx,dy:b.dy,sx:1,sy:1,angle1:0,angle2:0};if(u(b.xy,0)&&u(b.yx,0))return l.mixin(d,{sx:b.xx,sy:b.yy});if(u(b.xx*b.yx,-b.xy*b.yy))return e(b,d);if(u(b.xx*b.xy,-b.yx*b.yy))return g(b,d);var c,q=new m.Matrix2D(b);c=l.mixin(q,{dx:0,dy:0,xy:q.yx,yx:q.xy});q=v([b,c]);c=v([c,b]);q=new m.Matrix2D({xx:q.vector1.x,xy:q.vector2.x,yx:q.vector1.y,yy:q.vector2.y});c=new m.Matrix2D({xx:c.vector1.x,
xy:c.vector1.y,yx:c.vector2.x,yy:c.vector2.y});b=new m.Matrix2D([m.invert(q),b,m.invert(c)]);e(c,d);b.xx*=d.sx;b.yy*=d.sy;g(q,d);b.xx*=d.sx;b.yy*=d.sy;return l.mixin(d,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(c){c=c.bezierutils={};c.tAtLength=function(c,g){var d=0,b=6==c.length,e=0,q=0,h=b?u:v,a=function(l,r){for(var u=0,v=0;v<l.length-2;v+=2)u+=m(l[v],l[v+1],l[v+2],l[v+3]);v=b?m(c[0],c[1],c[4],c[5]):m(c[0],c[1],c[6],c[7]);u-v>r||e+u>g+r?(++q,u=h(l,.5),
a(u[0],r),Math.abs(e-g)<=r||a(u[1],r)):(e+=u,d+=1/(1<<q))};g&&a(c,.5);return d};var l=c.computeLength=function(c){for(var e=6==c.length,d=0,b=0;b<c.length-2;b+=2)d+=m(c[b],c[b+1],c[b+2],c[b+3]);b=e?m(c[0],c[1],c[4],c[5]):m(c[0],c[1],c[6],c[7]);.1<d-b&&(c=e?u(c,.5):x(c,.5),d=l(c[0],e),d+=l(c[1],e));return d},m=c.distance=function(c,g,d,b){return Math.sqrt((d-c)*(d-c)+(b-g)*(b-g))},u=function(c,g){var d=1-g,b=d*d,e=g*g,q=c[0],h=c[1],a=c[2],l=c[3],m=c[4],u=c[5],v=b*q+2*d*g*a+e*m,b=b*h+2*d*g*l+e*u;return[[q,
h,d*q+g*a,d*h+g*l,v,b],[v,b,d*a+g*m,d*l+g*u,m,u]]},x=function(c,g){var d=1-g,b=d*d,e=b*d,q=g*g,h=q*g,a=c[0],l=c[1],m=c[2],u=c[3],v=c[4],x=c[5],A=c[6],B=c[7],F=e*a+3*b*g*m+3*d*q*v+h*A,e=e*l+3*b*g*u+3*d*q*x+h*B;return[[a,l,d*a+g*m,d*l+g*u,b*a+2*d*g*m+q*v,b*l+2*d*g*u+q*x,F,e],[F,e,b*m+2*d*g*v+q*A,b*u+2*d*g*x+q*B,d*v+g*A,d*x+g*B,A,B]]},v=c.splitBezierAtT=function(c,g){return 6==c.length?u(c,g):x(c,g)};return c})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],
function(c,l,m){l.getObject("json",!0,m);m.json._slice=function(c,l,m,e){var g=c.length,d=[];m=m||g;l=0>l?Math.max(0,l+g):Math.min(g,l);for(m=0>m?Math.max(0,m+g):Math.min(g,m);l<m;l+=e)d.push(c[l]);return d};m.json._find=function(c,l){function m(c){l&&(!0!==l||c instanceof Array?c[l]&&e.push(c[l]):e.push(c));for(var b in c){var d=c[b];l?d&&"object"==typeof d&&m(d):e.push(d)}}var e=[];if(l instanceof Array){if(1==l.length)return c[l[0]];for(var g=0;g<l.length;g++)e.push(c[l[g]])}else m(c);return e};
m.json._distinctFilter=function(c,l){for(var m=[],e={},g=0,d=c.length;g<d;++g){var b=c[g];l(b,g,c)&&("object"==typeof b&&b?b.__included||(b.__included=!0,m.push(b)):e[b+typeof b]||(e[b+typeof b]=!0,m.push(b)))}g=0;for(d=m.length;g<d;++g)m[g]&&delete m[g].__included;return m};return m.json.query=function(c,l){function m(b,c,a,d,e,l,m,r){return g[r].match(/[\*\?]/)||"~"==m?"/^"+g[r].substring(1,g[r].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==m?
"$/i":"$/")+".test("+c+")":b}var e=0,g=[];c=c.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(b){e+="["==b?1:"]"==b?-1:0;return"]"==b&&0<e?"`]":'"'==b.charAt(0)||"'"==b.charAt(0)?"`"+(g.push(b)-1):b});var d="";c.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});c=c.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(b){return"."==b.charAt(0)?b:"@"==b?"$obj":(b.match(/:|^(\$|Math|true|false|null)$/)?
"":"$obj.")+b}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(b,c,a){return(c=b.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(a="",b.match(/^\./)&&(d="dojox.json._find("+d,a=",true)"),d=(c[1].match(/\=/)?"dojo.map":c[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter")+"("+d,a+",function($obj){return "+c[2]+"})"):(c=b.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+c[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,
"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:1)+";}\n"})+"return 0;})":(c=b.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(d="dojox.json._slice("+d,","+(c[1]||0)+","+(c[2]||0)+","+(c[3]||1)+")"):b.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(d="dojox.json._find("+d,("."==b.charAt(1)?",'"+a+"'":b.match(/,/)?","+b:"")+")"):b}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,
m).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(b,c,a,d,e,g,l,r){return m(b,d,e,g,l,r,a,c)});c=d+("$"==c.charAt(0)?"":"$")+c.replace(/`([0-9]+|\])/g,function(b,c){return"]"==c?"]":g[c]});for(var b=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+c+"}"),r=0;r<arguments.length-1;r++)arguments[r]=arguments[r+1];return l?b.apply(this,arguments):b}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel"],function(c,l,m,u){c=c(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});m("extend-esri")&&l.setObject("tasks.PrintParameters",c,u);return c})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(c,l,m,u,x,v,e,g){return l("dijit.ProgressBar",[v,e],{progress:"0",value:"",
maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:g,_indeterminateHighContrastImagePath:c.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(c){var b=
"rtl"==c.toLowerCase();m.toggle(this.domNode,"dijitProgressBarRtl",b);m.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&b);this.inherited(arguments)},update:function(c){u.mixin(this,c||{});c=this.internalProgress;var b=this.domNode,d=1;this.indeterminate?b.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(d=Math.min(parseFloat(this.progress)/100,1),this.progress=d*this.maximum):(this.progress=Math.min(this.progress,this.maximum),d=this.maximum?this.progress/
this.maximum:0),b.setAttribute("aria-valuenow",this.progress));b.setAttribute("aria-labelledby",this.labelNode.id);b.setAttribute("aria-valuemin",0);b.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(d);m.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);m.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());c.style.width=100*d+"%";this.onChange()},_setValueAttr:function(c){this._set("value",c);Infinity==
c?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:c})},_setLabelAttr:function(c){this._set("label",c);this.update()},_setIndeterminateAttr:function(c){this._set("indeterminate",c);this.update()},report:function(c){return this.label?this.label:this.indeterminate?"\x26#160;":x.format(c,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\r\n    \x3cdiv class\x3d"formContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\r\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                \x3ctr data-dojo-attach-point\x3d"titleTr"\x3e\r\n                    \x3ctd style\x3d"width:65px;"\x3e\r\n                        ${nls.title}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-attach-point\x3d"titleNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\'" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.layout}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"layoutDijit" data-dojo-attach-event\x3d"Change:onLayoutChange"/\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.format}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonActionBar jimu-align-trailing"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"advancedButtonDijit" style\x3d"display: none"\r\n            data-dojo-attach-event\x3d"onclick:showSettings"\x3e\x3cdiv class\x3d"btn-icon settingsIcon"\x3e\x3c/div\x3e${nls.settings}\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"settingsDialog"\r\n            style\x3d"display: none" class\x3d"gis_PrintDijit"\x3e\r\n            \x3cdiv style\x3d"width:250px;"\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapScaleExtent}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.preserve}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapScale" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapScaleLabel"\x3e${nls.mapScale}\x3c/label\x3e\r\n                                \x3cbr /\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapExtent" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapExtentLabel"\x3e${nls.mapExtent}\x3c/label\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.forceScale}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;" data-dojo-attach-point\x3d"labelsTitleNode"\x3e\r\n                    ${nls.labels}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"labelsFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.showLabels}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'showLabels\',value:true,checked:true" /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapMetadata}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"authorTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.author}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"authorNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\'" data-dojo-attach-point\x3d"authorTB"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"copyrightTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.copyright}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3ctextarea data-dojo-attach-point\x3d"copyrightNode" name\x3d"copyright"\r\n                                    data-dojo-type\x3d"dijit/form/SimpleTextarea"\r\n                                    style\x3d"width:100%;height:60px;resize:none;"\x3e\x3c/textarea\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"customTextElementsDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;" data-dojo-attach-point\x3d"customTextElementsTable"\x3e\r\n\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"legendTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.lncludeLegend}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapOnlyOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.width}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:670,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.height}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:500,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.printQualityOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.dpi}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:96,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"printButtonDijit"\r\n            data-dojo-attach-event\x3d"onclick:print"\x3e\x3cdiv class\x3d"btn-icon printIcon"\x3e\x3c/div\x3e${nls.print}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\r\n    style\x3d"display:none;padding:0;"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"onclick:clearResults"\x3e\r\n            \x3cdiv class\x3d"btn-icon clearIcon"\x3e\x3c/div\x3e${nls.clearList}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\r\n  \x3ctable class\x3d"printResultTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd width\x3d"25px"\x3e\r\n        \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd width\x3d"30px"\x3e\r\n        \x3cimg src\x3d"${icon}"\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"progressBar" data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d\'value:Infinity\'\x3e\x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"successNode" class\x3d"bold" style\x3d"display:none;"\x3e${docName}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"errNode" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"bold"\x3e${nls.printError}\x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-icon jimu-icon-error jimu-float-trailing"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{width: 100%; height: 100%; position: relative;}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red; cursor: help;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .btn-icon {width: 16px; height: 16px; display: inline-block; vertical-align: text-top; margin-right: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png);}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png);}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}",
"*now":function(c){c(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingShelter ./Print esri/request jimu/portalUrlUtils".split(" "),function(c,l,m,u,x,v,e,g,d,b){return c([l],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new e({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(u.hitch(this,function(b){this.shelter.show();this.isAsync(b).then(u.hitch(this,function(c){this.print=new g({map:this.map,appConfig:this.appConfig,printTaskURL:b,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:c});
this.print.placeAt(this.printNode);this.print.startup()}),u.hitch(this,function(b){new v({message:b.message})})).always(u.hitch(this,function(){this.shelter.hide()}))}),u.hitch(this,function(b){new v({message:b});console.error(b);this.shelter.hide()}))},_getPrintTaskURL:function(b){var c=new x;if(this.config&&this.config.serviceURL)return c.resolve(this.config.serviceURL),c;m.getPortalSelfInfo(b).then(u.hitch(this,function(b){(b=b&&b.helperServices&&b.helperServices.printTask&&b.helperServices.printTask.url)?
c.resolve(b):c.reject("error")}),u.hitch(this,function(b){new v({message:this.nls.portalConnectionError});c.reject("error");console.error(b)}));return c},isAsync:function(c){var e=new x,g=b.setHttpProtocol(c),a=b.getNewPrintUrl(this.appConfig.portalUrl);g===a||/sharing\/tools\/newPrint$/.test(g)?e.resolve(!1):d({url:c,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4,load:u.hitch(this,function(a){"esriExecutionTypeAsynchronous"===a.executionType?e.resolve(!0):e.resolve(!1)}),
error:u.hitch(this,function(a){e.reject(a)})});return e},onSignIn:function(b){b=b||{};b.userId&&this.print&&this.print.updateAuthor(b.userId)}})});